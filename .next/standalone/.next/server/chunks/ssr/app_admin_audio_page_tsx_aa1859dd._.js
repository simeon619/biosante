module.exports=[78363,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(15618),e=a.i(4975),f=a.i(25015),g=a.i(8549),h=a.i(24569),i=a.i(81560),j=a.i(70106);let k=(0,j.default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var l=a.i(30206),m=a.i(96221),n=a.i(49625),n=n;let o=(0,j.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var p=a.i(73320),q=a.i(97895);function r(){let[a,j]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)("all"),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),D=(0,c.useRef)(null),[E,F]=(0,c.useState)({product_id:"",author:"",location:"",duration:"0:00",text_content:""}),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1);(0,c.useEffect)(()=>{O()},[]),(0,c.useEffect)(()=>{r.length>0&&P()},[v,r]);let O=async()=>{try{let a=await fetch(`${q.API_URL}/api/admin/products`),b=await a.json();s(b.products||[]),b.products?.length>0&&!E.product_id&&F(a=>({...a,product_id:b.products[0].id}))}catch(a){console.error("Failed to fetch products:",a)}},P=async()=>{try{let a="all"===v?`${q.API_URL}/api/admin/testimonials`:`${q.API_URL}/api/admin/testimonials?product_id=${v}`,b=await fetch(a),c=await b.json();j(c.testimonials||[])}catch(a){console.error("Failed to fetch testimonials:",a)}finally{u(!1)}},Q=async a=>{a.preventDefault(),N(!0);try{let a=new FormData;a.append("product_id",E.product_id),a.append("author",E.author),a.append("location",E.location),a.append("duration",E.duration),a.append("text_content",E.text_content),G&&a.append("audio",G),I&&a.append("author_image",I);let b=z?`${q.API_URL}/api/admin/testimonials/${z.id}`:`${q.API_URL}/api/admin/testimonials`,c=await fetch(b,{method:z?"PATCH":"POST",body:a});if(c.ok)y(!1),R(),P();else{let a=await c.json();alert(a.error||"Erreur lors de la sauvegarde")}}catch(a){console.error("Failed to save testimonial:",a),alert("Erreur de connexion")}finally{N(!1)}},R=()=>{A(null),F({product_id:r[0]?.id||"",author:"",location:"",duration:"0:00",text_content:""}),H(null),J(null),L(null)},S=async a=>{try{await fetch(`${q.API_URL}/api/admin/testimonials/${a}/toggle`,{method:"POST"}),P()}catch(a){console.error("Failed to toggle testimonial:",a)}},T=async a=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce témoignage ?"))try{await fetch(`${q.API_URL}/api/admin/testimonials/${a}`,{method:"DELETE"}),P()}catch(a){console.error("Failed to delete testimonial:",a)}},U=a.reduce((a,b)=>(a[b.product_id]||(a[b.product_id]=[]),a[b.product_id].push(b),a),{});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Témoignages"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Audio, texte et images pour chaque produit"})]}),(0,b.jsxs)("button",{onClick:()=>{R(),y(!0)},className:"flex items-center gap-2 bg-black text-white px-4 py-2 rounded-xl hover:bg-gray-800 transition-colors",children:[(0,b.jsx)(d.Plus,{className:"w-5 h-5"}),"Ajouter"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>w("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${"all"===v?"bg-black text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tous"}),r.map(a=>(0,b.jsx)("button",{onClick:()=>w(a.id),className:`px-4 py-2 rounded-lg font-medium transition-colors ${v===a.id?"bg-black text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:a.name},a.id))]}),t?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-black"})}):0===a.length?(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-12 text-center",children:[(0,b.jsx)(e.Mic,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Aucun témoignage pour le moment"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:'Cliquez sur "Ajouter" pour créer votre premier témoignage'})]}):(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(U).map(([a,c])=>{let d,j=r.find(b=>b.id===a);return(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden",children:[(0,b.jsxs)("div",{className:`px-6 py-4 border-b ${(d=r.find(b=>b.id===a),({red:"bg-rose-50 border-rose-200",green:"bg-emerald-50 border-emerald-200",blue:"bg-blue-50 border-blue-200",yellow:"bg-yellow-50 border-yellow-200",orange:"bg-orange-50 border-orange-200",purple:"bg-purple-50 border-purple-200"})[d?.theme_color||"gray"]||"bg-gray-50 border-gray-200")}`,children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900",children:j?.name||a}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[c.length," témoignage(s)"]})]}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:c.map(c=>{let d;return(0,b.jsxs)("div",{className:"px-6 py-4 flex items-center gap-4",children:[(0,b.jsx)(k,{className:"w-5 h-5 text-gray-300 cursor-grab"}),c.author_image?(0,b.jsx)("img",{src:c.author_image,alt:c.author,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-100"}):(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",children:(0,b.jsx)(n.default,{className:"w-5 h-5 text-gray-400"})}),c.audio_url&&(0,b.jsx)("button",{onClick:()=>{B===c.id?(D.current?.pause(),C(null)):(D.current&&D.current.pause(),D.current=new Audio(c.audio_url),D.current.play(),D.current.onended=()=>C(null),C(c.id))},className:`w-10 h-10 rounded-full flex items-center justify-center transition-colors text-white ${B===c.id?"bg-gray-900":(d=r.find(b=>b.id===a),({red:"bg-rose-500",green:"bg-emerald-500",blue:"bg-blue-500",yellow:"bg-yellow-500",orange:"bg-orange-500",purple:"bg-purple-500"})[d?.theme_color||"gray"]||"bg-gray-500")}`,children:B===c.id?(0,b.jsx)(g.Pause,{className:"w-4 h-4"}):(0,b.jsx)(f.Play,{className:"w-4 h-4 ml-0.5"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:c.author}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:c.location}),c.text_content&&(0,b.jsxs)("p",{className:"text-sm text-gray-600 italic mt-1 truncate",children:['"',c.text_content,'"']})]}),(0,b.jsxs)("div",{className:"flex gap-1",children:[c.audio_url&&(0,b.jsx)("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded",children:(0,b.jsx)(e.Mic,{className:"w-3 h-3 inline"})}),c.text_content&&(0,b.jsx)("span",{className:"text-xs bg-green-100 text-green-600 px-2 py-0.5 rounded",children:(0,b.jsx)(o,{className:"w-3 h-3 inline"})}),c.author_image&&(0,b.jsx)("span",{className:"text-xs bg-purple-100 text-purple-600 px-2 py-0.5 rounded",children:(0,b.jsx)(n.default,{className:"w-3 h-3 inline"})})]}),(0,b.jsx)("span",{className:"text-sm font-mono text-gray-400 bg-gray-100 px-2 py-1 rounded",children:c.duration}),(0,b.jsx)("button",{onClick:()=>S(c.id),className:`p-2 rounded-lg transition-colors ${c.is_active?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,title:c.is_active?"Actif":"Inactif",children:(0,b.jsx)(l.Power,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>{A(c),F({product_id:c.product_id,author:c.author,location:c.location,duration:c.duration,text_content:c.text_content||""}),L(c.author_image||null),y(!0)},className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:(0,b.jsx)(h.Edit,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>T(c.id),className:"p-2 rounded-lg bg-red-50 text-red-500 hover:bg-red-100 transition-colors",children:(0,b.jsx)(i.Trash2,{className:"w-4 h-4"})})]},c.id)})})]},a)})}),x&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6 my-8",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-4",children:z?"Modifier le témoignage":"Nouveau témoignage"}),(0,b.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produit"}),(0,b.jsx)("select",{value:E.product_id,onChange:a=>F({...E,product_id:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",children:r.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auteur"}),(0,b.jsx)("input",{type:"text",value:E.author,onChange:a=>F({...E,author:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"Nom du client",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Localisation"}),(0,b.jsx)("input",{type:"text",value:E.location,onChange:a=>F({...E,location:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"Ville, Quartier",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,b.jsx)(o,{className:"w-4 h-4 inline mr-1"}),"Citation / Témoignage texte"]}),(0,b.jsx)("textarea",{value:E.text_content,onChange:a=>F({...E,text_content:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none resize-none h-24",placeholder:"Ce que le client a dit..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,b.jsx)(n.default,{className:"w-4 h-4 inline mr-1"}),"Photo de l'auteur"]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[K?(0,b.jsx)("img",{src:K,alt:"Preview",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200"}):(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center border-2 border-dashed border-gray-300",children:(0,b.jsx)(n.default,{className:"w-6 h-6 text-gray-400"})}),(0,b.jsxs)("label",{className:"flex-1 cursor-pointer",children:[(0,b.jsxs)("div",{className:"px-4 py-2 border border-gray-200 rounded-lg text-center hover:bg-gray-50 transition-colors",children:[(0,b.jsx)(p.Upload,{className:"w-4 h-4 inline mr-2"}),I?"Changer l'image":"Uploader une photo"]}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){J(b);let a=new FileReader;a.onload=a=>{L(a.target?.result)},a.readAsDataURL(b)}},className:"hidden"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,b.jsx)(e.Mic,{className:"w-4 h-4 inline mr-1"}),"Fichier Audio ",z&&"(optionnel)"]}),(0,b.jsx)("input",{type:"file",accept:"audio/*",onChange:a=>H(a.target.files?.[0]||null),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durée audio"}),(0,b.jsx)("input",{type:"text",value:E.duration,onChange:a=>F({...E,duration:a.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"1:23"})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>y(!1),className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),(0,b.jsxs)("button",{type:"submit",disabled:M,className:"flex-1 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[M&&(0,b.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin"}),z?"Modifier":"Créer"]})]})]})]})})]})}a.s(["default",()=>r],78363)}];

//# sourceMappingURL=app_admin_audio_page_tsx_aa1859dd._.js.map