(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70119,e=>{"use strict";var t=e.i(43476),n=e.i(71645),i=e.i(1928),r=e.i(92161),l=e.i(37727),o=e.i(61574),s=e.i(94351),a=e.i(88844),u=e.i(63488),d=e.i(84614),p=e.i(22016),c=e.i(18566),h=e.i(42258),f=e.i(97815),m=e.i(47163);e.s(["Header",0,()=>{let[e,g]=(0,n.useState)(!1),y=(0,c.usePathname)(),{cartCount:v,setIsCartOpen:E}=(0,h.useCart)(),{user:b}=(0,f.useAuth)(),_=[{label:"Accueil",href:"/",icon:s.Home},{label:"Nos Produits",href:"/produits",icon:a.Package},{label:"Assistance",href:"/assistance",icon:u.Mail}];return(0,t.jsxs)("header",{className:"sticky top-0 z-[1100] bg-white/80 backdrop-blur-md border-b border-black/5",children:[(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)(p.default,{href:"/",className:"flex items-center cursor-pointer group",children:[(0,t.jsx)("div",{className:"bg-black text-white p-2.5 rounded-xl mr-3 group-hover:rotate-12 transition-transform duration-300",children:(0,t.jsx)(o.HeartPulse,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("span",{className:"font-bold text-lg leading-tight tracking-tight text-black",children:["BIO ",(0,t.jsx)("span",{className:"text-black/40",children:"SANTÉ"})]}),(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-[0.2em] text-black/40 font-semibold",children:"Science & Nature"})]})]}),(0,t.jsx)("nav",{className:"hidden md:flex space-x-1",children:_.map(e=>{let n=e.icon,i=y===e.href;return(0,t.jsxs)(p.default,{href:e.href,className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold transition-all duration-300 ${i?"bg-black text-white shadow-lg shadow-black/10":"text-black/50 hover:text-black hover:bg-black/5"}`,children:[(0,t.jsx)(n,{className:`h-4 w-4 ${i?"text-white":"text-black/30"}`}),e.label]},e.href)})}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(p.default,{href:b?"/account":"/login",className:"p-3 text-black rounded-full hover:bg-black/5 transition-colors group","aria-label":"Mon compte",children:(0,t.jsx)(d.User,{className:(0,m.cn)("h-5 w-5 group-hover:scale-110 transition-transform",b&&"text-indigo-600")})}),(0,t.jsxs)("button",{onClick:()=>E(!0),className:"relative p-3 text-black rounded-full hover:bg-black/5 transition-colors group","aria-label":"Panier",children:[(0,t.jsx)(i.ShoppingCart,{className:"h-5 w-5 group-hover:scale-110 transition-transform"}),v>0&&(0,t.jsx)("span",{className:"absolute top-1 right-1 inline-flex items-center justify-center w-5 h-5 text-[10px] font-bold leading-none text-white bg-red-600 rounded-full border-2 border-white",children:v})]}),(0,t.jsx)("button",{className:"md:hidden p-3 text-black rounded-full hover:bg-black/5",onClick:()=>g(!e),children:e?(0,t.jsx)(l.X,{className:"h-6 w-6"}):(0,t.jsx)(r.Menu,{className:"h-6 w-6"})})]})]})}),e&&(0,t.jsx)("div",{className:"md:hidden bg-white border-t border-black/5 animate-in slide-in-from-top duration-300",children:(0,t.jsx)("div",{className:"px-4 pt-4 pb-6 space-y-2",children:_.map(e=>{let n=e.icon,i=y===e.href;return(0,t.jsxs)(p.default,{href:e.href,onClick:()=>g(!1),className:`flex items-center gap-4 w-full px-4 py-4 rounded-xl text-base font-bold transition-all ${i?"bg-black text-white":"text-black/60 hover:bg-black/5 hover:text-black"}`,children:[(0,t.jsx)(n,{className:`h-5 w-5 ${i?"text-white":"text-black/20"}`}),e.label]},e.href)})})})]})}])},56691,e=>{"use strict";var t=e.i(43476),n=e.i(43432),i=e.i(63488),r=e.i(46897),l=e.i(75254);let o=(0,l.default)("facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),s=(0,l.default)("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),a=(0,l.default)("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);var u=e.i(2671),d=e.i(71645);e.s(["Footer",0,()=>{let[e,l]=(0,d.useState)(u.defaultSettings);return(0,d.useEffect)(()=>{(async()=>{l(await (0,u.getPublicSettings)())})()},[]),(0,t.jsx)("footer",{className:"bg-black text-white border-t border-white/10 pb-24 md:pb-0",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12",children:[(0,t.jsxs)("div",{className:"col-span-1 md:col-span-1 space-y-6",children:[(0,t.jsx)("h3",{className:"text-white text-xl font-bold tracking-tight",children:"BIO SANTÉ"}),(0,t.jsx)("p",{className:"text-sm text-white/70 leading-relaxed font-light",children:"Pionniers dans l'élaboration de solutions phytothérapeutiques validées cliniquement."}),(0,t.jsxs)("div",{className:"flex space-x-6",children:[(0,t.jsx)("a",{href:"#",className:"hover:text-white transition-colors opacity-70 hover:opacity-100",children:(0,t.jsx)(o,{size:20,strokeWidth:1.5})}),(0,t.jsx)("a",{href:"#",className:"hover:text-white transition-colors opacity-70 hover:opacity-100",children:(0,t.jsx)(s,{size:20,strokeWidth:1.5})}),(0,t.jsx)("a",{href:"#",className:"hover:text-white transition-colors opacity-70 hover:opacity-100",children:(0,t.jsx)(a,{size:20,strokeWidth:1.5})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-white font-mono text-xs uppercase tracking-widest mb-6 opacity-60",children:"Navigation"}),(0,t.jsxs)("ul",{className:"space-y-4 text-sm font-medium",children:[(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Accueil"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Protocoles"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"La Science"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Journal"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-white font-mono text-xs uppercase tracking-widest mb-6 opacity-60",children:"Légal"}),(0,t.jsxs)("ul",{className:"space-y-4 text-sm font-medium",children:[(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Mentions Légales"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Confidentialité"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{className:"hover:text-white hover:translate-x-1 transition-all",children:"Conditions"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-white font-mono text-xs uppercase tracking-widest mb-6 opacity-60",children:"Assistance"}),(0,t.jsxs)("ul",{className:"space-y-4 text-sm font-light",children:[(0,t.jsxs)("li",{className:"flex items-center group cursor-pointer",children:[(0,t.jsx)(n.Phone,{size:16,className:"mr-3 opacity-60 group-hover:opacity-100 transition-opacity"}),(0,t.jsx)("span",{className:"group-hover:text-white transition-colors",children:(0,u.formatPhoneDisplay)(e.contact_customer_service)})]}),(0,t.jsxs)("li",{className:"flex items-center group cursor-pointer",children:[(0,t.jsx)(i.Mail,{size:16,className:"mr-3 opacity-60 group-hover:opacity-100 transition-opacity"}),(0,t.jsx)("span",{className:"group-hover:text-white transition-colors",children:e.contact_email})]}),(0,t.jsxs)("li",{className:"flex items-start opacity-70",children:[(0,t.jsx)(r.MapPin,{size:16,className:"mr-3 mt-1"}),(0,t.jsx)("span",{children:"Abidjan, Côte d'Ivoire"})]})]})]})]}),(0,t.jsxs)("div",{className:"border-t border-white/10 mt-16 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-white/40 font-mono uppercase tracking-widest",children:[(0,t.jsxs)("p",{children:["© ",new Date().getFullYear()," BIO SANTÉ."]}),(0,t.jsx)("p",{className:"mt-2 md:mt-0",children:"Science & Nature"})]})]})})}],56691)},28587,e=>{"use strict";var t=e.i(43476),n=e.i(37902),i=e.i(71645),r=e.i(37727),l=e.i(27612),o=e.i(75254);let s=(0,o.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var a=e.i(7233),u=e.i(50965),d=e.i(72520),p=e.i(15788),c=e.i(39312),h=e.i(95468);let f=(0,o.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var m=e.i(83086),g=e.i(42258),y=e.i(18566),v=e.i(2671),E=e.i(47163);e.s(["CartDrawer",0,()=>{let{cart:e,updateQuantity:o,removeFromCart:b,setIsCartOpen:_,isCartOpen:I}=(0,g.useCart)(),A=(0,y.useRouter)(),[T,S]=(0,i.useState)(v.defaultSettings),[C,O]=(0,i.useState)(!1);(0,i.useEffect)(()=>{I?(O(!0),(async()=>{S(await (0,v.getPublicSettings)())})()):O(!1)},[I]);let x=()=>{O(!1),setTimeout(()=>_(!1),300)},N=e.reduce((e,t)=>e+t.price*t.quantity,0),w=e.reduce((e,t)=>e+t.quantity,0),R=w>=2||N>=T.delivery_free_threshold,P=(()=>{if(0===e.length)return 0;let t=0;return t=R?50:Math.max(25*Math.min(w/2,1),25*Math.min(N/T.delivery_free_threshold,1)),R&&(t=100),t})();return I?(0,t.jsxs)("div",{className:`jsx-e912cdff08663da3 fixed inset-0 z-[9999] overflow-hidden transition-all duration-300 ${C?"opacity-100":"opacity-0"}`,children:[(0,t.jsx)("div",{onClick:x,className:"jsx-e912cdff08663da3 absolute inset-0 bg-black/60 backdrop-blur-md transition-opacity"}),(0,t.jsx)("div",{className:`jsx-e912cdff08663da3 absolute inset-y-0 right-0 max-w-md w-full flex transition-transform duration-500 ease-out ${C?"translate-x-0":"translate-x-full"}`,children:(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 w-full h-full flex flex-col bg-white shadow-2xl overflow-hidden relative",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 absolute inset-0 opacity-[0.03] pointer-events-none",children:(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 absolute top-0 left-0 w-full h-full bg-[radial-gradient(#000_1px,transparent_1px)] [background-size:20px_20px]"})}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 relative flex items-center justify-between px-8 py-6 border-b border-gray-100 bg-white/80 backdrop-blur-md z-10",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 bg-black text-white p-2 rounded-xl shadow-lg shadow-black/10",children:(0,t.jsx)(u.ShoppingBag,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3",children:[(0,t.jsx)("h2",{className:"jsx-e912cdff08663da3 text-xl font-black text-gray-900 uppercase tracking-tight",children:"Mon Panier"}),(0,t.jsxs)("p",{className:"jsx-e912cdff08663da3 text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:[w," PRODUIT",w>1?"S":""]})]})]}),(0,t.jsx)("button",{onClick:x,className:"jsx-e912cdff08663da3 text-gray-400 hover:text-gray-900 p-2.5 rounded-full hover:bg-gray-100 transition-all active:scale-95",children:(0,t.jsx)(r.X,{className:"w-6 h-6"})})]}),e.length>0&&(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 px-8 py-6 bg-gradient-to-b from-gray-50 to-white border-b border-gray-100 z-10",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex items-center justify-between mb-4",children:[(0,t.jsxs)("h3",{className:"jsx-e912cdff08663da3 text-xs font-black text-gray-900 uppercase tracking-wider flex items-center gap-2",children:[(0,t.jsx)(m.Sparkles,{className:"w-4 h-4 text-amber-500 fill-amber-500"}),"Quêtes de Vitalité"]}),(0,t.jsxs)("span",{className:"jsx-e912cdff08663da3 text-[10px] font-bold px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full",children:["Progression ",Math.round(P),"%"]})]}),(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 relative h-2.5 w-full bg-gray-200 rounded-full overflow-hidden mb-6 shadow-inner",children:(0,t.jsx)("div",{style:{width:`${P}%`},className:"jsx-e912cdff08663da3 absolute top-0 left-0 h-full bg-gradient-to-r from-amber-400 via-amber-500 to-orange-500 transition-all duration-1000 ease-out shadow-[0_0_10px_rgba(245,158,11,0.5)]",children:(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 absolute inset-0 bg-[linear-gradient(45deg,rgba(255,255,255,0.2)_25%,transparent_25%,transparent_50%,rgba(255,255,255,0.2)_50%,rgba(255,255,255,0.2)_75%,transparent_75%,transparent)] bg-[length:20px_20px] animate-[shimmer_2s_linear_infinite]"})})}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex flex-col items-center gap-2 group",children:[(0,t.jsx)("div",{className:`jsx-e912cdff08663da3 w-8 h-8 rounded-full flex items-center justify-center transition-all duration-500 border-2 ${R?"bg-black border-black text-white shadow-lg":"bg-white border-gray-200 text-gray-400"}`,children:(0,t.jsx)(p.Truck,{className:"w-4 h-4"})}),(0,t.jsxs)("span",{className:`jsx-e912cdff08663da3 text-[9px] font-black uppercase text-center leading-tight transition-colors ${R?"text-gray-900":"text-gray-400"}`,children:["Privilège",(0,t.jsx)("br",{className:"jsx-e912cdff08663da3"}),"Livraison Offerte"]})]}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex flex-col items-center gap-2 group",children:[(0,t.jsx)("div",{className:`jsx-e912cdff08663da3 w-8 h-8 rounded-full flex items-center justify-center transition-all duration-500 border-2 ${P>=100?"bg-amber-500 border-amber-500 text-white shadow-lg":"bg-white border-gray-200 text-gray-400"}`,children:(0,t.jsx)(c.Zap,{className:`w-4 h-4 ${P>=100?"fill-white":""}`})}),(0,t.jsxs)("span",{className:`jsx-e912cdff08663da3 text-[9px] font-black uppercase text-center leading-tight transition-colors ${P>=100?"text-amber-600":"text-gray-400"}`,children:["Économe",(0,t.jsx)("br",{className:"jsx-e912cdff08663da3"}),"-4% Wave"]})]})]}),!R&&(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 mt-6 flex items-center gap-3 bg-amber-50/50 border border-amber-100 p-3 rounded-2xl animate-in slide-in-from-bottom-2",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 bg-amber-100 p-2 rounded-xl",children:(0,t.jsx)(f,{className:"w-4 h-4 text-amber-600"})}),(0,t.jsxs)("p",{className:"jsx-e912cdff08663da3 text-[10px] font-bold text-amber-800 leading-snug",children:["Plus que ",(0,t.jsx)("span",{className:"jsx-e912cdff08663da3 text-amber-600 underline text-xs",children:(0,E.formatCurrency)(Math.max(0,T.delivery_free_threshold-N))})," ou ",(0,t.jsxs)("span",{className:"jsx-e912cdff08663da3 text-amber-600 underline text-xs",children:[2-w>0?2-w:0," produit"]})," pour débloquer la ",(0,t.jsx)("span",{className:"jsx-e912cdff08663da3 uppercase text-amber-900 font-black tracking-tighter",children:"Livraison Gratuite !"})]})]})]}),(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 flex-1 overflow-y-auto p-8 space-y-6 bg-white custom-scrollbar z-0",children:0===e.length?(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 h-full flex flex-col items-center justify-center text-center",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 w-32 h-32 bg-gray-50 rounded-full flex items-center justify-center mb-6 border border-gray-100 animate-pulse",children:(0,t.jsx)(u.ShoppingBag,{className:"w-16 h-16 text-gray-200"})}),(0,t.jsx)("h3",{className:"jsx-e912cdff08663da3 text-xl font-black text-gray-900 uppercase tracking-tight mb-2",children:"Votre vitalité attend"}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 text-gray-400 text-sm max-w-[200px] mb-8 font-medium italic",children:"Commencez votre voyage santé en ajoutant des produits."}),(0,t.jsx)("button",{onClick:x,className:"jsx-e912cdff08663da3 bg-black text-white px-8 py-4 rounded-2xl font-black uppercase text-xs tracking-[0.2em] shadow-xl shadow-black/10 hover:scale-105 transition-all",children:"Découvrir nos produits"})]}):(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 space-y-4",children:e.map((e,n)=>(0,t.jsxs)("div",{style:{animationDelay:`${50*n}ms`},className:"jsx-e912cdff08663da3 flex gap-5 p-4 bg-white border-2 border-gray-50 rounded-[2rem] shadow-sm hover:shadow-md hover:border-black/5 transition-all group animate-in fade-in slide-in-from-right-4",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 h-24 w-24 flex-shrink-0 relative",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 absolute inset-0 bg-black/5 rounded-2xl group-hover:scale-95 transition-transform"}),(0,t.jsx)("img",{src:e.image,alt:e.name,className:"jsx-e912cdff08663da3 h-full w-full object-cover rounded-2xl shadow-sm group-hover:scale-105 transition-transform"})]}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex flex-1 flex-col justify-between py-1",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3",children:(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3",children:[(0,t.jsx)("h3",{className:"jsx-e912cdff08663da3 text-sm font-black text-gray-900 group-hover:text-amber-600 transition-colors",children:e.name}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 text-[10px] font-black text-gray-300 uppercase tracking-[0.1em] mt-0.5",children:e.category})]}),(0,t.jsx)("button",{onClick:()=>b(e.id),className:"jsx-e912cdff08663da3 text-gray-300 hover:text-red-500 p-1 transition-colors",children:(0,t.jsx)(l.Trash2,{className:"w-4 h-4"})})]})}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex items-center justify-between mt-auto",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex items-center bg-gray-50 rounded-xl p-1 border border-gray-100",children:[(0,t.jsx)("button",{onClick:()=>o(e.id,-1),disabled:e.quantity<=1,className:"jsx-e912cdff08663da3 w-7 h-7 flex items-center justify-center text-gray-400 hover:text-black hover:bg-white rounded-lg transition-all disabled:opacity-30",children:(0,t.jsx)(s,{className:"w-3 h-3"})}),(0,t.jsx)("span",{className:"jsx-e912cdff08663da3 w-8 text-center text-xs font-black text-gray-900",children:e.quantity}),(0,t.jsx)("button",{onClick:()=>o(e.id,1),className:"jsx-e912cdff08663da3 w-7 h-7 flex items-center justify-center text-gray-400 hover:text-black hover:bg-white rounded-lg transition-all",children:(0,t.jsx)(a.Plus,{className:"w-3 h-3"})})]}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 text-sm font-black text-gray-900 bg-gray-50 px-3 py-1.5 rounded-xl border border-gray-100",children:(0,E.formatCurrency)(e.price*e.quantity)})]})]})]},e.id))})}),e.length>0&&(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 border-t border-gray-100 bg-white p-8 space-y-4 shadow-[0_-20px_50px_rgba(0,0,0,0.02)] z-10",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 space-y-3 px-2",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex justify-between text-xs font-bold text-gray-400 uppercase tracking-widest",children:[(0,t.jsx)("p",{className:"jsx-e912cdff08663da3",children:"Sous-total"}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 text-gray-900",children:(0,E.formatCurrency)(N)})]}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex justify-between text-xs font-bold text-gray-400 uppercase tracking-widest",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 flex items-center gap-1.5",children:[(0,t.jsx)(p.Truck,{className:"w-3.5 h-3.5 text-gray-300"}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3",children:"Expédition"})]}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 "+((R?"text-green-600":"text-gray-900 font-black")||""),children:R?"Offert":(0,E.formatCurrency)(T.delivery_local_fee)})]}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 pt-4 flex justify-between items-baseline",children:[(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3",children:[(0,t.jsx)("h4",{className:"jsx-e912cdff08663da3 text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-1",children:"Total Final"}),(0,t.jsx)("p",{className:"jsx-e912cdff08663da3 text-3xl font-black text-gray-900 tracking-tighter",children:(0,E.formatCurrency)(N+(R?0:T.delivery_local_fee))})]}),R&&(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 bg-green-100 text-green-700 text-[10px] font-black px-3 py-1.5 rounded-full uppercase tracking-tighter shadow-sm",children:"Économie !"})]})]}),(0,t.jsxs)("button",{onClick:()=>{_(!1),A.push("/panier")},className:"jsx-e912cdff08663da3 group w-full relative h-16 bg-black text-white rounded-2xl font-black uppercase text-sm tracking-[0.2em] overflow-hidden transition-all active:scale-95 shadow-2xl shadow-black/20",children:[(0,t.jsx)("div",{className:"jsx-e912cdff08663da3 absolute inset-0 bg-gradient-to-r from-amber-500 to-orange-500 translate-y-16 group-hover:translate-y-0 transition-transform duration-500 ease-out"}),(0,t.jsxs)("div",{className:"jsx-e912cdff08663da3 relative flex items-center justify-center gap-3",children:[(0,t.jsx)("span",{className:"jsx-e912cdff08663da3",children:"Passer à la Caisse"}),(0,t.jsx)(d.ArrowRight,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})]}),(0,t.jsxs)("p",{className:"jsx-e912cdff08663da3 text-[9px] text-center text-gray-400 uppercase font-black tracking-widest flex items-center justify-center gap-2",children:[(0,t.jsx)(h.CheckCircle2,{className:"w-3 h-3 text-green-500"}),"Paiement 100% sécurisé et livraison garantie"]})]})]})}),(0,t.jsx)(n.default,{id:"e912cdff08663da3",children:"@keyframes shimmer{0%{background-position:-20px 0}to{background-position:20px 0}}.custom-scrollbar::-webkit-scrollbar{width:4px}.custom-scrollbar::-webkit-scrollbar-track{background:0 0}.custom-scrollbar::-webkit-scrollbar-thumb{background:#f1f1f1;border-radius:10px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:#e5e5e5}"})]}):null}],28587)},9011,e=>{"use strict";var t=e.i(43476),n=e.i(71645),i=e.i(43432),r=e.i(2671);e.s(["FloatingContacts",0,()=>{let[e,l]=(0,n.useState)(!0),[o,s]=(0,n.useState)(r.defaultSettings);return(0,n.useEffect)(()=>{(async()=>{s(await (0,r.getPublicSettings)())})()},[]),(0,n.useEffect)(()=>{let e=()=>{let e=document.querySelector("footer");e&&l(!(e.getBoundingClientRect().top<window.innerHeight))};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,t.jsxs)("div",{className:`fixed bottom-24 left-6 z-[1100] flex flex-col gap-3 transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,children:[(0,t.jsx)("a",{href:`https://wa.me/${o.contact_whatsapp.replace(/\+/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"bg-[#25D366] text-white p-3 rounded-full shadow-lg hover:scale-110 transition-transform flex items-center justify-center","aria-label":"Contact WhatsApp",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:"w-6 h-6 fill-current",children:(0,t.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),(0,t.jsx)("a",{href:`tel:${o.contact_customer_service.replace(/\s/g,"")}`,className:"bg-primary-900 text-white p-3 rounded-full shadow-lg hover:scale-110 transition-transform flex items-center justify-center border border-white/20","aria-label":"Appeler",children:(0,t.jsx)(i.Phone,{className:"w-6 h-6"})})]})}])},810,e=>{"use strict";var t=e.i(43476),n=e.i(8151);e.s(["GlobalBackground",0,()=>{let{activeColor:e}=(0,n.useUI)();return(0,t.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-0 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-grid-pattern opacity-[0.03]"}),(0,t.jsx)("div",{className:`absolute top-[20%] right-[-10%] w-[800px] h-[800px] rounded-full transition-bg-bloom blur-[120px] 
                ${"red"===e?"bg-bloom-red opacity-100 scale-110":"green"===e?"bg-bloom-green opacity-100 scale-110":"opacity-0 scale-90"}`}),(0,t.jsx)("div",{className:`absolute bottom-[10%] left-[-10%] w-[700px] h-[700px] rounded-full transition-bg-bloom blur-[100px] 
                ${"red"===e?"bg-bloom-red opacity-60 scale-100":"green"===e?"bg-bloom-green opacity-60 scale-100":"opacity-0 scale-90"}`}),(0,t.jsx)("div",{className:"absolute top-[20%] left-[10%] w-[500px] h-[500px] border border-black/5 rounded-full animate-slow-spin"}),(0,t.jsx)("div",{className:"absolute top-[60%] right-[5%] w-[600px] h-[600px] border border-black/5 rounded-full animate-slow-spin-reverse"}),(0,t.jsx)("div",{className:"absolute bottom-[10%] left-[20%] w-[400px] h-[400px] border border-black/5 rounded-full animate-slow-spin"})]})}])},48346,e=>{"use strict";let t,n,i,r,l;var o,s,a,u,d,p,c,h,f,m,g,y,v,E,b,_,I,A,T,S,C,O,x,N,w,R,P,j,M,D,k,U,q,L,G,H,F,V,B,J,$,Y,W,K,z,X,Q,Z,ee,et,en,ei,er,el,eo,es,ea,eu,ed,ep,ec,eh,ef,em,eg,ey,ev,eE,eb,e_,eI,eA,eT,eS,eC,eO,ex,eN,ew,eR,eP,ej,eM,eD,ek,eU,eq,eL,eG,eH,eF,eV,eB,eJ,e$,eY,eW,eK,ez,eX,eQ,eZ,e0,e1,e2,e6,e3,e4,e5,e8,e9,e7,te,tt,tn=e.i(43476),ti=e.i(71645),tr=e.i(37727),tl=e.i(75254);let to=(0,tl.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),ts=(0,tl.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);var ta=e.i(84614),tu=e.i(47167);class td{}function tp(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error(`Key '${n}' not found in valueMap.`)})}function tc(e,t,n){for(let i=0;i<t.length-1;i++){let r=t[i];if(r.endsWith("[]")){let l=r.slice(0,-2);if(!(l in e))if(Array.isArray(n))e[l]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${r}`);if(Array.isArray(e[l])){let r=e[l];if(Array.isArray(n))for(let e=0;e<r.length;e++)tc(r[e],t.slice(i+1),n[e]);else for(let e of r)tc(e,t.slice(i+1),n)}return}if(r.endsWith("[0]")){let l=r.slice(0,-3);l in e||(e[l]=[{}]),tc(e[l][0],t.slice(i+1),n);return}e[r]&&"object"==typeof e[r]||(e[r]={}),e=e[r]}let i=t[t.length-1],r=e[i];if(void 0!==r){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===r)return;if("object"==typeof r&&"object"==typeof n&&null!==r&&null!==n)Object.assign(r,n);else throw Error(`Cannot set value for an existing key. Key: ${i}`)}else"_self"!==i||"object"!=typeof n||null===n||Array.isArray(n)?e[i]=n:Object.assign(e,n)}function th(e,t,n){try{if(1===t.length&&"_self"===t[0])return e;for(let i=0;i<t.length;i++){if("object"!=typeof e||null===e)return n;let r=t[i];if(r.endsWith("[]")){let l=r.slice(0,-2);if(!(l in e))return n;{let r=e[l];if(!Array.isArray(r))return n;return r.map(e=>th(e,t.slice(i+1),n))}}e=e[r]}return e}catch(e){if(e instanceof TypeError)return n;throw e}}function tf(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}function tm(e){var t;let n,i,r,l,o={},s=th(e,["name"]);null!=s&&tc(o,["name"],s);let a=th(e,["metadata"]);null!=a&&tc(o,["metadata"],a);let u=th(e,["done"]);null!=u&&tc(o,["done"],u);let d=th(e,["error"]);null!=d&&tc(o,["error"],d);let p=th(e,["response"]);return null!=p&&tc(o,["response"],(n={},null!=(i=th(t=p,["sdkHttpResponse"]))&&tc(n,["sdkHttpResponse"],i),null!=(r=th(t,["parent"]))&&tc(n,["parent"],r),null!=(l=th(t,["documentName"]))&&tc(n,["documentName"],l),n)),o}(o=eu||(eu={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(s=ed||(ed={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",s.PYTHON="PYTHON",(a=ep||(ep={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",a.SILENT="SILENT",a.WHEN_IDLE="WHEN_IDLE",a.INTERRUPT="INTERRUPT",(u=ec||(ec={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",u.STRING="STRING",u.NUMBER="NUMBER",u.INTEGER="INTEGER",u.BOOLEAN="BOOLEAN",u.ARRAY="ARRAY",u.OBJECT="OBJECT",u.NULL="NULL",(d=eh||(eh={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",d.MODE_DYNAMIC="MODE_DYNAMIC",(p=ef||(ef={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",p.SIMPLE_SEARCH="SIMPLE_SEARCH",p.ELASTIC_SEARCH="ELASTIC_SEARCH",(c=em||(em={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",c.NO_AUTH="NO_AUTH",c.API_KEY_AUTH="API_KEY_AUTH",c.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",c.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",c.OAUTH="OAUTH",c.OIDC_AUTH="OIDC_AUTH",(h=eg||(eg={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",h.HTTP_IN_QUERY="HTTP_IN_QUERY",h.HTTP_IN_HEADER="HTTP_IN_HEADER",h.HTTP_IN_PATH="HTTP_IN_PATH",h.HTTP_IN_BODY="HTTP_IN_BODY",h.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(f=ey||(ey={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",f.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",f.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",f.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",f.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",f.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",f.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(m=ev||(ev={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",m.LOW="LOW",m.MEDIUM="MEDIUM",m.HIGH="HIGH",m.MINIMAL="MINIMAL",(g=eE||(eE={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",g.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",g.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",g.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",g.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",g.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",g.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",g.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",g.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",g.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",g.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(y=eb||(eb={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",y.SEVERITY="SEVERITY",y.PROBABILITY="PROBABILITY",(v=e_||(e_={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",v.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",v.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",v.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",v.BLOCK_NONE="BLOCK_NONE",v.OFF="OFF",(E=eI||(eI={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",E.STOP="STOP",E.MAX_TOKENS="MAX_TOKENS",E.SAFETY="SAFETY",E.RECITATION="RECITATION",E.LANGUAGE="LANGUAGE",E.OTHER="OTHER",E.BLOCKLIST="BLOCKLIST",E.PROHIBITED_CONTENT="PROHIBITED_CONTENT",E.SPII="SPII",E.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",E.IMAGE_SAFETY="IMAGE_SAFETY",E.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",E.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",E.NO_IMAGE="NO_IMAGE",E.IMAGE_RECITATION="IMAGE_RECITATION",E.IMAGE_OTHER="IMAGE_OTHER",(b=eA||(eA={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",b.NEGLIGIBLE="NEGLIGIBLE",b.LOW="LOW",b.MEDIUM="MEDIUM",b.HIGH="HIGH",(_=eT||(eT={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",_.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",_.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",_.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",_.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(I=eS||(eS={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",I.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",I.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",I.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",I.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(A=eC||(eC={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",A.SAFETY="SAFETY",A.OTHER="OTHER",A.BLOCKLIST="BLOCKLIST",A.PROHIBITED_CONTENT="PROHIBITED_CONTENT",A.IMAGE_SAFETY="IMAGE_SAFETY",A.MODEL_ARMOR="MODEL_ARMOR",A.JAILBREAK="JAILBREAK",(T=eO||(eO={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",T.ON_DEMAND="ON_DEMAND",T.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(S=ex||(ex={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",S.TEXT="TEXT",S.IMAGE="IMAGE",S.AUDIO="AUDIO",(C=eN||(eN={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",C.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",C.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",C.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(O=ew||(ew={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",O.TUNING_MODE_FULL="TUNING_MODE_FULL",O.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(x=eR||(eR={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",x.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",x.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",x.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",x.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",x.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",x.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(N=eP||(eP={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",N.JOB_STATE_QUEUED="JOB_STATE_QUEUED",N.JOB_STATE_PENDING="JOB_STATE_PENDING",N.JOB_STATE_RUNNING="JOB_STATE_RUNNING",N.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",N.JOB_STATE_FAILED="JOB_STATE_FAILED",N.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",N.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",N.JOB_STATE_PAUSED="JOB_STATE_PAUSED",N.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",N.JOB_STATE_UPDATING="JOB_STATE_UPDATING",N.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(w=ej||(ej={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",w.TUNING_TASK_I2V="TUNING_TASK_I2V",w.TUNING_TASK_T2V="TUNING_TASK_T2V",w.TUNING_TASK_R2V="TUNING_TASK_R2V",(R=eM||(eM={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",R.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",R.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",R.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",R.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(P=eD||(eD={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",P.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",P.BALANCED="BALANCED",P.PRIORITIZE_COST="PRIORITIZE_COST",(j=ek||(ek={})).UNSPECIFIED="UNSPECIFIED",j.BLOCKING="BLOCKING",j.NON_BLOCKING="NON_BLOCKING",(M=eU||(eU={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",M.MODE_DYNAMIC="MODE_DYNAMIC",(D=eq||(eq={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",D.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(k=eL||(eL={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",k.AUTO="AUTO",k.ANY="ANY",k.NONE="NONE",k.VALIDATED="VALIDATED",(U=eG||(eG={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",U.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",U.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",U.BLOCK_NONE="BLOCK_NONE",(q=eH||(eH={})).DONT_ALLOW="DONT_ALLOW",q.ALLOW_ADULT="ALLOW_ADULT",q.ALLOW_ALL="ALLOW_ALL",(L=eF||(eF={})).auto="auto",L.en="en",L.ja="ja",L.ko="ko",L.hi="hi",L.zh="zh",L.pt="pt",L.es="es",(G=eV||(eV={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",G.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",G.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",G.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",G.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(H=eB||(eB={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",H.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",H.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",H.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(F=eJ||(eJ={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",F.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",F.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",F.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(V=e$||(e$={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",V.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",V.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",V.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",V.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",V.EDIT_MODE_STYLE="EDIT_MODE_STYLE",V.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",V.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(B=eY||(eY={})).FOREGROUND="FOREGROUND",B.BACKGROUND="BACKGROUND",B.PROMPT="PROMPT",B.SEMANTIC="SEMANTIC",B.INTERACTIVE="INTERACTIVE",(J=eW||(eW={})).ASSET="ASSET",J.STYLE="STYLE",($=eK||(eK={})).INSERT="INSERT",$.REMOVE="REMOVE",$.REMOVE_STATIC="REMOVE_STATIC",$.OUTPAINT="OUTPAINT",(Y=ez||(ez={})).OPTIMIZED="OPTIMIZED",Y.LOSSLESS="LOSSLESS",(W=eX||(eX={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",W.PREFERENCE_TUNING="PREFERENCE_TUNING",(K=eQ||(eQ={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",K.STATE_PENDING="STATE_PENDING",K.STATE_ACTIVE="STATE_ACTIVE",K.STATE_FAILED="STATE_FAILED",(z=eZ||(eZ={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",z.PROCESSING="PROCESSING",z.ACTIVE="ACTIVE",z.FAILED="FAILED",(X=e0||(e0={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",X.UPLOADED="UPLOADED",X.GENERATED="GENERATED",(Q=e1||(e1={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",Q.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",Q.RESPONSE_REJECTED="RESPONSE_REJECTED",Q.NEED_MORE_INPUT="NEED_MORE_INPUT",(Z=e2||(e2={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Z.TEXT="TEXT",Z.IMAGE="IMAGE",Z.VIDEO="VIDEO",Z.AUDIO="AUDIO",Z.DOCUMENT="DOCUMENT",(ee=e6||(e6={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",ee.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",ee.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",(et=e3||(e3={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",et.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",et.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(en=e4||(e4={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",en.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",en.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(ei=e5||(e5={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",ei.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",ei.NO_INTERRUPTION="NO_INTERRUPTION",(er=e8||(e8={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",er.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",er.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(el=e9||(e9={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",el.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",el.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",el.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",el.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",el.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",el.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",el.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",el.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",el.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",el.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",el.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",el.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(eo=e7||(e7={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",eo.QUALITY="QUALITY",eo.DIVERSITY="DIVERSITY",eo.VOCALIZATION="VOCALIZATION",(es=te||(te={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",es.PLAY="PLAY",es.PAUSE="PAUSE",es.STOP="STOP",es.RESET_CONTEXT="RESET_CONTEXT";class tg{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ty{get text(){var e,t,n,i,r,l,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1,d=[];for(let e of null!=(s=null==(o=null==(l=null==(r=this.candidates)?void 0:r[0])?void 0:l.content)?void 0:o.parts)?s:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&"thoughtSignature"!==t&&(null!==n||void 0!==n)&&d.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,a+=e.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0}get data(){var e,t,n,i,r,l,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let a="",u=[];for(let e of null!=(s=null==(o=null==(l=null==(r=this.candidates)?void 0:r[0])?void 0:l.content)?void 0:o.parts)?s:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(a+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}get functionCalls(){var e,t,n,i,r,l,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let a=null==(s=null==(o=null==(l=null==(r=this.candidates)?void 0:r[0])?void 0:l.content)?void 0:o.parts)?void 0:s.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==a?void 0:a.length)!==0)return a}get executableCode(){var e,t,n,i,r,l,o,s,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null==(s=null==(o=null==(l=null==(r=this.candidates)?void 0:r[0])?void 0:l.content)?void 0:o.parts)?void 0:s.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(a=null==u?void 0:u[0])?void 0:a.code}get codeExecutionResult(){var e,t,n,i,r,l,o,s,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null==(s=null==(o=null==(l=null==(r=this.candidates)?void 0:r[0])?void 0:l.content)?void 0:o.parts)?void 0:s.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(a=null==u?void 0:u[0])?void 0:a.output}}class tv{}class tE{}class tb{}class t_{}class tI{}class tA{}class tT{}class tS{}class tC{}class tO{}class tx{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n,i=new tx;if(t){let t,i,r,l,o,s;t={},null!=(i=th(e,["name"]))&&tc(t,["name"],i),null!=(r=th(e,["metadata"]))&&tc(t,["metadata"],r),null!=(l=th(e,["done"]))&&tc(t,["done"],l),null!=(o=th(e,["error"]))&&tc(t,["error"],o),null!=(s=th(e,["response"]))&&tc(t,["response"],function(e){let t={},n=th(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s;return n={},null!=(i=th(e,["_self"]))&&tc(n,["video"],(r={},null!=(l=th(t=i,["gcsUri"]))&&tc(r,["uri"],l),null!=(o=th(t,["bytesBase64Encoded"]))&&tc(r,["videoBytes"],tf(o)),null!=(s=th(t,["mimeType"]))&&tc(r,["mimeType"],s),r)),n})),tc(t,["generatedVideos"],e)}let i=th(e,["raiMediaFilteredCount"]);null!=i&&tc(t,["raiMediaFilteredCount"],i);let r=th(e,["raiMediaFilteredReasons"]);return null!=r&&tc(t,["raiMediaFilteredReasons"],r),t}(s)),n=t}else{let t,i,r,l,o,s;t={},null!=(i=th(e,["name"]))&&tc(t,["name"],i),null!=(r=th(e,["metadata"]))&&tc(t,["metadata"],r),null!=(l=th(e,["done"]))&&tc(t,["done"],l),null!=(o=th(e,["error"]))&&tc(t,["error"],o),null!=(s=th(e,["response","generateVideoResponse"]))&&tc(t,["response"],function(e){let t={},n=th(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s;return n={},null!=(i=th(e,["video"]))&&tc(n,["video"],(r={},null!=(l=th(t=i,["uri"]))&&tc(r,["uri"],l),null!=(o=th(t,["encodedVideo"]))&&tc(r,["videoBytes"],tf(o)),null!=(s=th(t,["encoding"]))&&tc(r,["mimeType"],s),r)),n})),tc(t,["generatedVideos"],e)}let i=th(e,["raiMediaFilteredCount"]);null!=i&&tc(t,["raiMediaFilteredCount"],i);let r=th(e,["raiMediaFilteredReasons"]);return null!=r&&tc(t,["raiMediaFilteredReasons"],r),t}(s)),n=t}return Object.assign(i,n),i}}class tN{}class tw{}class tR{}class tP{}class tj{}class tM{}class tD{}class tk{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){var n;let i,r,l,o,s,a,u,d,p,c,h=new tk;return Object.assign(h,(s={},null!=(a=th(e,["name"]))&&tc(s,["name"],a),null!=(u=th(e,["metadata"]))&&tc(s,["metadata"],u),null!=(d=th(e,["done"]))&&tc(s,["done"],d),null!=(p=th(e,["error"]))&&tc(s,["error"],p),null!=(c=th(e,["response"]))&&tc(s,["response"],(i={},null!=(r=th(n=c,["sdkHttpResponse"]))&&tc(i,["sdkHttpResponse"],r),null!=(l=th(n,["parent"]))&&tc(i,["parent"],l),null!=(o=th(n,["documentName"]))&&tc(i,["documentName"],o),i)),s)),h}}class tU{}class tq{}class tL{}class tG{}class tH{get text(){var e,t,n;let i="",r=!1,l=[];for(let o of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&l.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;r=!0,i+=o.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?i:void 0}get data(){var e,t,n;let i="",r=[];for(let l of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(l))"inlineData"!==e&&null!==t&&r.push(e);l.inlineData&&"string"==typeof l.inlineData.data&&(i+=atob(l.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class tF{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tV{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new tV;return Object.assign(n,tm(e)),n}}function tB(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw Error("invalid model parameter");if(e.isVertexAI())if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;else{if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function tJ(e,t){let n=tB(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function t$(e){return Array.isArray(e)?e.map(e=>tY(e)):[tY(e)]}function tY(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function tW(e){let t=tY(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tK(e){let t=tY(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tz(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function tX(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>tz(e)):[tz(e)]}function tQ(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function tZ(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function t0(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function t1(e){if(null==e)throw Error("ContentUnion is required");return tQ(e)?e:{role:"user",parts:tX(e)}}function t2(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=t1(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=t1(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>t1(e)):[t1(t)]}function t6(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(tZ(e)||t0(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[t1(e)]}let t=[],n=[],i=tQ(e[0]);for(let r of e){let e=tQ(r);if(e!=i)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(r);else if(tZ(r)||t0(r))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else n.push(r)}return i||t.push({role:"user",parts:tX(n)}),t}function t3(e){let t={},n=["items"],i=["anyOf"],r=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let l=e.anyOf;for(let[o,s]of(null!=l&&2==l.length&&("null"===l[0].type?(t.nullable=!0,e=l[1]):"null"===l[1].type&&(t.nullable=!0,e=l[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(ec).includes(n[0].toUpperCase())?n[0].toUpperCase():ec.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.values(ec).includes(e.toUpperCase())?e.toUpperCase():ec.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=s)if("type"==o){if("null"===s)throw Error("type: null can not be the only possible type for the field.");if(s instanceof Array)continue;t.type=Object.values(ec).includes(s.toUpperCase())?s.toUpperCase():ec.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=t3(s);else if(i.includes(o)){let e=[];for(let n of s){if("null"==n.type){t.nullable=!0;continue}e.push(t3(n))}t[o]=e}else if(r.includes(o)){let e={};for(let[t,n]of Object.entries(s))e[t]=t3(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=s}return t}function t4(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function t5(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function t8(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=t3(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=t3(t.response));return e}function t9(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let n of e)t.push(n);return t}function t7(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,i=1){let r=!t.startsWith(`${n}/`)&&t.split("/").length===i;if(e.isVertexAI())if(t.startsWith("projects/"))return t;else if(t.startsWith("locations/"))return`projects/${e.getProject()}/${t}`;else if(t.startsWith(`${n}/`))return`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`;else if(r)return`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`;else return t;return r?`${n}/${t}`:t}(e,t,"cachedContents")}function ne(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function nt(e){var t;let n;if(null!=e&&"object"==typeof e&&"name"in e&&(n=e.name),null==e||"object"!=typeof e||!("uri"in e)||void 0!==(n=e.uri)){if(null==e||"object"!=typeof e||!("video"in e)||void 0!==(n=null==(t=e.video)?void 0:t.uri)){if("string"==typeof e&&(n=e),void 0===n)throw Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}}function nn(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function ni(e){for(let i of["models","tunedModels","publisherModels"]){var t,n;if(t=e,n=i,null!==t&&"object"==typeof t&&n in t)return e[i]}return[]}function nr(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;let i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(r>0||1!==i)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||1!==r)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function nl(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let n=t.inlinedResponses;if(!Array.isArray(n)||0===n.length)return e;let i=!1;for(let e of n){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function no(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function ns(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function na(e){let t={},n=th(e,["name"]);null!=n&&tc(t,["name"],n);let i=th(e,["metadata","displayName"]);null!=i&&tc(t,["displayName"],i);let r=th(e,["metadata","state"]);null!=r&&tc(t,["state"],ns(r));let l=th(e,["metadata","createTime"]);null!=l&&tc(t,["createTime"],l);let o=th(e,["metadata","endTime"]);null!=o&&tc(t,["endTime"],o);let s=th(e,["metadata","updateTime"]);null!=s&&tc(t,["updateTime"],s);let a=th(e,["metadata","model"]);null!=a&&tc(t,["model"],a);let u=th(e,["metadata","output"]);return null!=u&&tc(t,["dest"],function(e){let t={},n=th(e,["responsesFile"]);null!=n&&tc(t,["fileName"],n);let i=th(e,["inlinedResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r;return n={},null!=(i=th(t=e,["response"]))&&tc(n,["response"],function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["content"]);null!=n&&tc(t,["content"],n);let i=th(e,["citationMetadata"]);null!=i&&tc(t,["citationMetadata"],function(e){let t={},n=th(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["citations"],e)}return t}(i));let r=th(e,["tokenCount"]);null!=r&&tc(t,["tokenCount"],r);let l=th(e,["finishReason"]);null!=l&&tc(t,["finishReason"],l);let o=th(e,["avgLogprobs"]);null!=o&&tc(t,["avgLogprobs"],o);let s=th(e,["groundingMetadata"]);null!=s&&tc(t,["groundingMetadata"],s);let a=th(e,["index"]);null!=a&&tc(t,["index"],a);let u=th(e,["logprobsResult"]);null!=u&&tc(t,["logprobsResult"],u);let d=th(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["safetyRatings"],e)}let p=th(e,["urlContextMetadata"]);return null!=p&&tc(t,["urlContextMetadata"],p),t})(e))),tc(t,["candidates"],e)}let r=th(e,["modelVersion"]);null!=r&&tc(t,["modelVersion"],r);let l=th(e,["promptFeedback"]);null!=l&&tc(t,["promptFeedback"],l);let o=th(e,["responseId"]);null!=o&&tc(t,["responseId"],o);let s=th(e,["usageMetadata"]);return null!=s&&tc(t,["usageMetadata"],s),t}(i)),null!=(r=th(t,["error"]))&&tc(n,["error"],r),n})),tc(t,["inlinedResponses"],e)}let r=th(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["inlinedEmbedContentResponses"],e)}return t}(nl(u))),t}function nu(e){var t,n;let i,r,l,o,s,a,u,d,p={},c=th(e,["name"]);null!=c&&tc(p,["name"],c);let h=th(e,["displayName"]);null!=h&&tc(p,["displayName"],h);let f=th(e,["state"]);null!=f&&tc(p,["state"],ns(f));let m=th(e,["error"]);null!=m&&tc(p,["error"],m);let g=th(e,["createTime"]);null!=g&&tc(p,["createTime"],g);let y=th(e,["startTime"]);null!=y&&tc(p,["startTime"],y);let v=th(e,["endTime"]);null!=v&&tc(p,["endTime"],v);let E=th(e,["updateTime"]);null!=E&&tc(p,["updateTime"],E);let b=th(e,["model"]);null!=b&&tc(p,["model"],b);let _=th(e,["inputConfig"]);null!=_&&tc(p,["src"],(i={},null!=(r=th(n=_,["instancesFormat"]))&&tc(i,["format"],r),null!=(l=th(n,["gcsSource","uris"]))&&tc(i,["gcsUri"],l),null!=(o=th(n,["bigquerySource","inputUri"]))&&tc(i,["bigqueryUri"],o),i));let I=th(e,["outputConfig"]);null!=I&&tc(p,["dest"],(t=nl(I),s={},null!=(a=th(t,["predictionsFormat"]))&&tc(s,["format"],a),null!=(u=th(t,["gcsDestination","outputUriPrefix"]))&&tc(s,["gcsUri"],u),null!=(d=th(t,["bigqueryDestination","outputUri"]))&&tc(s,["bigqueryUri"],d),s));let A=th(e,["completionStats"]);return null!=A&&tc(p,["completionStats"],A),p}function nd(e){let t={},n=th(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c,h;return n={},null!=(i=th(t=e,["mediaResolution"]))&&tc(n,["mediaResolution"],i),null!=(r=th(t,["codeExecutionResult"]))&&tc(n,["codeExecutionResult"],r),null!=(l=th(t,["executableCode"]))&&tc(n,["executableCode"],l),null!=(o=th(t,["fileData"]))&&tc(n,["fileData"],function(e){let t={};if(void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=th(e,["fileUri"]);null!=n&&tc(t,["fileUri"],n);let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(o)),null!=(s=th(t,["functionCall"]))&&tc(n,["functionCall"],function(e){let t={},n=th(e,["id"]);null!=n&&tc(t,["id"],n);let i=th(e,["args"]);null!=i&&tc(t,["args"],i);let r=th(e,["name"]);if(null!=r&&tc(t,["name"],r),void 0!==th(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==th(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=th(t,["functionResponse"]))&&tc(n,["functionResponse"],a),null!=(u=th(t,["inlineData"]))&&tc(n,["inlineData"],function(e){let t={},n=th(e,["data"]);if(null!=n&&tc(t,["data"],n),void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(u)),null!=(d=th(t,["text"]))&&tc(n,["text"],d),null!=(p=th(t,["thought"]))&&tc(n,["thought"],p),null!=(c=th(t,["thoughtSignature"]))&&tc(n,["thoughtSignature"],c),null!=(h=th(t,["videoMetadata"]))&&tc(n,["videoMetadata"],h),n})),tc(t,["parts"],e)}let i=th(e,["role"]);return null!=i&&tc(t,["role"],i),t}function np(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["src"]);null!=r&&tc(n,["batch","inputConfig"],function(e,t){let n={};if(void 0!==th(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==th(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==th(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let i=th(t,["fileName"]);null!=i&&tc(n,["fileName"],i);let r=th(t,["inlinedRequests"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["request","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>nd(e))),tc(n,["request","contents"],e)}let l=th(t,["metadata"]);null!=l&&tc(n,["metadata"],l);let o=th(t,["config"]);return null!=o&&tc(n,["request","generationConfig"],function(e,t,n){var i;let r,l,o,s={},a=th(t,["systemInstruction"]);void 0!==n&&null!=a&&tc(n,["systemInstruction"],nd(t1(a)));let u=th(t,["temperature"]);null!=u&&tc(s,["temperature"],u);let d=th(t,["topP"]);null!=d&&tc(s,["topP"],d);let p=th(t,["topK"]);null!=p&&tc(s,["topK"],p);let c=th(t,["candidateCount"]);null!=c&&tc(s,["candidateCount"],c);let h=th(t,["maxOutputTokens"]);null!=h&&tc(s,["maxOutputTokens"],h);let f=th(t,["stopSequences"]);null!=f&&tc(s,["stopSequences"],f);let m=th(t,["responseLogprobs"]);null!=m&&tc(s,["responseLogprobs"],m);let g=th(t,["logprobs"]);null!=g&&tc(s,["logprobs"],g);let y=th(t,["presencePenalty"]);null!=y&&tc(s,["presencePenalty"],y);let v=th(t,["frequencyPenalty"]);null!=v&&tc(s,["frequencyPenalty"],v);let E=th(t,["seed"]);null!=E&&tc(s,["seed"],E);let b=th(t,["responseMimeType"]);null!=b&&tc(s,["responseMimeType"],b);let _=th(t,["responseSchema"]);null!=_&&tc(s,["responseSchema"],t3(_));let I=th(t,["responseJsonSchema"]);if(null!=I&&tc(s,["responseJsonSchema"],I),void 0!==th(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==th(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=th(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["category"]);if(null!=n&&tc(t,["category"],n),void 0!==th(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=th(e,["threshold"]);return null!=i&&tc(t,["threshold"],i),t})(e))),tc(n,["safetySettings"],e)}let T=th(t,["tools"]);if(void 0!==n&&null!=T){let e=t9(T);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["functionDeclarations"],e)}if(void 0!==th(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=th(e,["googleSearchRetrieval"]);null!=i&&tc(t,["googleSearchRetrieval"],i);let r=th(e,["computerUse"]);null!=r&&tc(t,["computerUse"],r);let l=th(e,["fileSearch"]);null!=l&&tc(t,["fileSearch"],l);let o=th(e,["codeExecution"]);if(null!=o&&tc(t,["codeExecution"],o),void 0!==th(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=th(e,["googleMaps"]);null!=s&&tc(t,["googleMaps"],function(e){let t={};if(void 0!==th(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=th(e,["enableWidget"]);return null!=n&&tc(t,["enableWidget"],n),t}(s));let a=th(e,["googleSearch"]);null!=a&&tc(t,["googleSearch"],function(e){let t={};if(void 0!==th(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==th(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=th(e,["timeRangeFilter"]);return null!=n&&tc(t,["timeRangeFilter"],n),t}(a));let u=th(e,["urlContext"]);return null!=u&&tc(t,["urlContext"],u),t})(t8(e)))),tc(n,["tools"],e)}let S=th(t,["toolConfig"]);if(void 0!==n&&null!=S&&tc(n,["toolConfig"],(r={},null!=(l=th(i=S,["functionCallingConfig"]))&&tc(r,["functionCallingConfig"],function(e){let t={},n=th(e,["mode"]);null!=n&&tc(t,["mode"],n);let i=th(e,["allowedFunctionNames"]);if(null!=i&&tc(t,["allowedFunctionNames"],i),void 0!==th(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(l)),null!=(o=th(i,["retrievalConfig"]))&&tc(r,["retrievalConfig"],o),r)),void 0!==th(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let C=th(t,["cachedContent"]);void 0!==n&&null!=C&&tc(n,["cachedContent"],t7(e,C));let O=th(t,["responseModalities"]);null!=O&&tc(s,["responseModalities"],O);let x=th(t,["mediaResolution"]);null!=x&&tc(s,["mediaResolution"],x);let N=th(t,["speechConfig"]);if(null!=N&&tc(s,["speechConfig"],t4(N)),void 0!==th(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let w=th(t,["thinkingConfig"]);null!=w&&tc(s,["thinkingConfig"],w);let R=th(t,["imageConfig"]);null!=R&&tc(s,["imageConfig"],function(e){let t={},n=th(e,["aspectRatio"]);null!=n&&tc(t,["aspectRatio"],n);let i=th(e,["imageSize"]);if(null!=i&&tc(t,["imageSize"],i),void 0!==th(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==th(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(R));let P=th(t,["enableEnhancedCivicAnswers"]);return null!=P&&tc(s,["enableEnhancedCivicAnswers"],P),s}(e,o,th(n,["request"],{}))),n})(e,t))),tc(n,["requests","requests"],t)}return n}(e,nr(e,r)));let l=th(t,["config"]);return null!=l&&function(e,t){let n=th(e,["displayName"]);if(void 0!==t&&null!=n&&tc(t,["batch","displayName"],n),void 0!==th(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(l,n),n}(ea=tt||(tt={})).PAGED_ITEM_BATCH_JOBS="batchJobs",ea.PAGED_ITEM_MODELS="models",ea.PAGED_ITEM_TUNING_JOBS="tuningJobs",ea.PAGED_ITEM_FILES="files",ea.PAGED_ITEM_CACHED_CONTENTS="cachedContents",ea.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",ea.PAGED_ITEM_DOCUMENTS="documents";class nc{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};(l=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=null!=(r=null==(i=l.config)?void 0:i.pageSize)?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null==(e=this.params.config)?void 0:e.pageToken)!==void 0}}class nh extends td{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nc(tt.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){let t=np(this.apiClient,e),n=tp("{model}:batchGenerateContent",t._url),i=t.batch.inputConfig.requests,r=i.requests,l=[];for(let e of r){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let n=t.request;n.systemInstruction=e,t.request=n}l.push(t)}return i.requests=l,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),void 0===n.dest){let t=this.getGcsUri(e),r=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${i}`;else if(r)n.dest=`${r}_dest_${i}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,r,l;let o="",s={};if(this.apiClient.isVertexAI()){let i,r,a,u,d,p,c=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["model"],tB(l,r)),null!=(a=th(e,["src"]))&&tc(i,["inputConfig"],function(e){let t={},n=th(e,["format"]);null!=n&&tc(t,["instancesFormat"],n);let i=th(e,["gcsUri"]);null!=i&&tc(t,["gcsSource","uris"],i);let r=th(e,["bigqueryUri"]);if(null!=r&&tc(t,["bigquerySource","inputUri"],r),void 0!==th(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==th(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(nr(l,a))),null!=(u=th(e,["config"]))&&(d=th(u,["displayName"]),void 0!==i&&null!=d&&tc(i,["displayName"],d),p=th(u,["dest"]),void 0!==i&&null!=p&&tc(i,["outputConfig"],function(e){let t={},n=th(e,["format"]);null!=n&&tc(t,["predictionsFormat"],n);let i=th(e,["gcsUri"]);null!=i&&tc(t,["gcsDestination","outputUriPrefix"],i);let r=th(e,["bigqueryUri"]);if(null!=r&&tc(t,["bigqueryDestination","outputUri"],r),void 0!==th(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==th(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==th(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(p)))),i);return o=tp("batchPredictionJobs",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nu(e))}{let t=np(this.apiClient,e);return o=tp("{model}:batchGenerateContent",t._url),s=t._query,delete t._url,delete t._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>na(e))}}async createEmbeddingsInternal(e){var t,n,i,r,l;let o="",s={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let a,u,d,p,c,h,f,m,g=(i=this.apiClient,p={},null!=(c=th(e,["model"]))&&tc(p,["_url","model"],tB(i,c)),null!=(h=th(e,["src"]))&&tc(p,["batch","inputConfig"],(r=i,a={},null!=(u=th(l=h,["fileName"]))&&tc(a,["file_name"],u),null!=(d=th(l,["inlinedRequests"]))&&tc(a,["requests"],function(e,t){let n={},i=th(t,["contents"]);if(null!=i){let t=t2(e,i);Array.isArray(t)&&(t=t.map(e=>e)),tc(n,["requests[]","request","content"],t)}let r=th(t,["config"]);return null!=r&&(tc(n,["_self"],function(e,t){let n=th(e,["taskType"]);void 0!==t&&null!=n&&tc(t,["requests[]","taskType"],n);let i=th(e,["title"]);void 0!==t&&null!=i&&tc(t,["requests[]","title"],i);let r=th(e,["outputDimensionality"]);if(void 0!==t&&null!=r&&tc(t,["requests[]","outputDimensionality"],r),void 0!==th(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==th(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(r,n)),!function(e,t){for(let[n,i]of Object.entries(t)){let t=n.split("."),r=i.split("."),l=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&r.length>o)for(let e=o;e<r.length;e++){let t=r[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||l.add(t)}!function e(t,n,i,r,l){if(r>=n.length||"object"!=typeof t||null===t)return;let o=n[r];if(o.endsWith("[]")){let s=o.slice(0,-2);if(s in t&&Array.isArray(t[s]))for(let o of t[s])e(o,n,i,r+1,l)}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!l.has(e)),n={};for(let i of e)n[i]=t[i];for(let[e,l]of Object.entries(n)){let n=[];for(let t of i.slice(r))"*"===t?n.push(e):n.push(t);tc(t,n,l)}for(let n of e)delete t[n]}}else o in t&&e(t[o],n,i,r+1,l)}(e,t,r,0,l)}}(n,{"requests[].*":"requests[].request.*"})),n}(r,d)),a)),null!=(f=th(e,["config"]))&&(m=th(f,["displayName"]),void 0!==p&&null!=m&&tc(p,["batch","displayName"],m)),p);return o=tp("{model}:asyncBatchEmbedContent",g._url),s=g._query,delete g._url,delete g._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>na(e))}}async get(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],no(l,r)),i);return s=tp("batchPredictionJobs/{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nu(e))}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],no(o,n)),t);return s=tp("batches/{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>na(e))}}async cancel(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],no(l,r)),i);s=tp("batchPredictionJobs/{name}:cancel",o._url),a=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],no(o,n)),t);s=tp("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal})}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s,a,u,d=(i={},null!=(r=th(e,["config"]))&&(s=th(r,["pageSize"]),void 0!==i&&null!=s&&tc(i,["_query","pageSize"],s),a=th(r,["pageToken"]),void 0!==i&&null!=a&&tc(i,["_query","pageToken"],a),u=th(r,["filter"]),void 0!==i&&null!=u&&tc(i,["_query","filter"],u)),i);return l=tp("batchPredictionJobs",d._url),o=d._query,delete d._url,delete d._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["batchPredictionJobs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>nu(e))),tc(t,["batchJobs"],e)}return t}(e),n=new tG;return Object.assign(n,t),n})}{let t,n,s=(t={},null!=(n=th(e,["config"]))&&function(e,t){let n=th(e,["pageSize"]);void 0!==t&&null!=n&&tc(t,["_query","pageSize"],n);let i=th(e,["pageToken"]);if(void 0!==t&&null!=i&&tc(t,["_query","pageToken"],i),void 0!==th(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(n,t),t);return l=tp("batches",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["operations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>na(e))),tc(t,["batchJobs"],e)}return t}(e),n=new tG;return Object.assign(n,t),n})}}async delete(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],no(l,r)),i);return s=tp("batchPredictionJobs/{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,r,l;return t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),null!=(i=th(e,["name"]))&&tc(t,["name"],i),null!=(r=th(e,["done"]))&&tc(t,["done"],r),null!=(l=th(e,["error"]))&&tc(t,["error"],l),t})}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],no(o,n)),t);return s=tp("batches/{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,r,l;return t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),null!=(i=th(e,["name"]))&&tc(t,["name"],i),null!=(r=th(e,["done"]))&&tc(t,["done"],r),null!=(l=th(e,["error"]))&&tc(t,["error"],l),t})}}}function nf(e){let t={},n=th(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c,h;return n={},null!=(i=th(t=e,["mediaResolution"]))&&tc(n,["mediaResolution"],i),null!=(r=th(t,["codeExecutionResult"]))&&tc(n,["codeExecutionResult"],r),null!=(l=th(t,["executableCode"]))&&tc(n,["executableCode"],l),null!=(o=th(t,["fileData"]))&&tc(n,["fileData"],function(e){let t={};if(void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=th(e,["fileUri"]);null!=n&&tc(t,["fileUri"],n);let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(o)),null!=(s=th(t,["functionCall"]))&&tc(n,["functionCall"],function(e){let t={},n=th(e,["id"]);null!=n&&tc(t,["id"],n);let i=th(e,["args"]);null!=i&&tc(t,["args"],i);let r=th(e,["name"]);if(null!=r&&tc(t,["name"],r),void 0!==th(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==th(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=th(t,["functionResponse"]))&&tc(n,["functionResponse"],a),null!=(u=th(t,["inlineData"]))&&tc(n,["inlineData"],function(e){let t={},n=th(e,["data"]);if(null!=n&&tc(t,["data"],n),void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(u)),null!=(d=th(t,["text"]))&&tc(n,["text"],d),null!=(p=th(t,["thought"]))&&tc(n,["thought"],p),null!=(c=th(t,["thoughtSignature"]))&&tc(n,["thoughtSignature"],c),null!=(h=th(t,["videoMetadata"]))&&tc(n,["videoMetadata"],h),n})),tc(t,["parts"],e)}let i=th(e,["role"]);return null!=i&&tc(t,["role"],i),t}class nm extends td{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nc(tt.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o,u=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["model"],tJ(l,r)),null!=(o=th(e,["config"]))&&function(e,t){let n=th(e,["ttl"]);void 0!==t&&null!=n&&tc(t,["ttl"],n);let i=th(e,["expireTime"]);void 0!==t&&null!=i&&tc(t,["expireTime"],i);let r=th(e,["displayName"]);void 0!==t&&null!=r&&tc(t,["displayName"],r);let l=th(e,["contents"]);if(void 0!==t&&null!=l){let e=t6(l);Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["contents"],e)}let o=th(e,["systemInstruction"]);void 0!==t&&null!=o&&tc(t,["systemInstruction"],t1(o));let s=th(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==th(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=th(e,["description"]);null!=n&&tc(t,["description"],n);let i=th(e,["name"]);null!=i&&tc(t,["name"],i);let r=th(e,["parameters"]);null!=r&&tc(t,["parameters"],r);let l=th(e,["parametersJsonSchema"]);null!=l&&tc(t,["parametersJsonSchema"],l);let o=th(e,["response"]);null!=o&&tc(t,["response"],o);let s=th(e,["responseJsonSchema"]);return null!=s&&tc(t,["responseJsonSchema"],s),t})(e))),tc(t,["functionDeclarations"],e)}let i=th(e,["retrieval"]);null!=i&&tc(t,["retrieval"],i);let r=th(e,["googleSearchRetrieval"]);null!=r&&tc(t,["googleSearchRetrieval"],r);let l=th(e,["computerUse"]);if(null!=l&&tc(t,["computerUse"],l),void 0!==th(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=th(e,["codeExecution"]);null!=o&&tc(t,["codeExecution"],o);let s=th(e,["enterpriseWebSearch"]);null!=s&&tc(t,["enterpriseWebSearch"],s);let a=th(e,["googleMaps"]);null!=a&&tc(t,["googleMaps"],a);let u=th(e,["googleSearch"]);null!=u&&tc(t,["googleSearch"],u);let d=th(e,["urlContext"]);return null!=d&&tc(t,["urlContext"],d),t})(e))),tc(t,["tools"],e)}let a=th(e,["toolConfig"]);void 0!==t&&null!=a&&tc(t,["toolConfig"],a);let u=th(e,["kmsKeyName"]);void 0!==t&&null!=u&&tc(t,["encryption_spec","kmsKeyName"],u)}(o,i),i);return s=tp("cachedContents",u._url),a=u._query,delete u._url,delete u._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,l,u=(o=this.apiClient,t={},null!=(n=th(e,["model"]))&&tc(t,["model"],tJ(o,n)),null!=(l=th(e,["config"]))&&function(e,t){var n;let i,r,l,o=th(e,["ttl"]);void 0!==t&&null!=o&&tc(t,["ttl"],o);let s=th(e,["expireTime"]);void 0!==t&&null!=s&&tc(t,["expireTime"],s);let a=th(e,["displayName"]);void 0!==t&&null!=a&&tc(t,["displayName"],a);let u=th(e,["contents"]);if(void 0!==t&&null!=u){let e=t6(u);Array.isArray(e)&&(e=e.map(e=>nf(e))),tc(t,["contents"],e)}let d=th(e,["systemInstruction"]);void 0!==t&&null!=d&&tc(t,["systemInstruction"],nf(t1(d)));let p=th(e,["tools"]);if(void 0!==t&&null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["functionDeclarations"],e)}if(void 0!==th(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=th(e,["googleSearchRetrieval"]);null!=i&&tc(t,["googleSearchRetrieval"],i);let r=th(e,["computerUse"]);null!=r&&tc(t,["computerUse"],r);let l=th(e,["fileSearch"]);null!=l&&tc(t,["fileSearch"],l);let o=th(e,["codeExecution"]);if(null!=o&&tc(t,["codeExecution"],o),void 0!==th(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=th(e,["googleMaps"]);null!=s&&tc(t,["googleMaps"],function(e){let t={};if(void 0!==th(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=th(e,["enableWidget"]);return null!=n&&tc(t,["enableWidget"],n),t}(s));let a=th(e,["googleSearch"]);null!=a&&tc(t,["googleSearch"],function(e){let t={};if(void 0!==th(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==th(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=th(e,["timeRangeFilter"]);return null!=n&&tc(t,["timeRangeFilter"],n),t}(a));let u=th(e,["urlContext"]);return null!=u&&tc(t,["urlContext"],u),t})(e))),tc(t,["tools"],e)}let c=th(e,["toolConfig"]);if(void 0!==t&&null!=c&&tc(t,["toolConfig"],(i={},null!=(r=th(n=c,["functionCallingConfig"]))&&tc(i,["functionCallingConfig"],function(e){let t={},n=th(e,["mode"]);null!=n&&tc(t,["mode"],n);let i=th(e,["allowedFunctionNames"]);if(null!=i&&tc(t,["allowedFunctionNames"],i),void 0!==th(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r)),null!=(l=th(n,["retrievalConfig"]))&&tc(i,["retrievalConfig"],l),i)),void 0!==th(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(l,t),t);return s=tp("cachedContents",u._url),a=u._query,delete u._url,delete u._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],t7(l,r)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],t7(o,n)),t);return s=tp("{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],t7(l,r)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tR;return Object.assign(r,i),r})}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],t7(o,n)),t);return s=tp("{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tR;return Object.assign(r,i),r})}}async update(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o,u,d,p=(l=this.apiClient,i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],t7(l,r)),null!=(o=th(e,["config"]))&&(u=th(o,["ttl"]),void 0!==i&&null!=u&&tc(i,["ttl"],u),d=th(o,["expireTime"]),void 0!==i&&null!=d&&tc(i,["expireTime"],d)),i);return s=tp("{name}",p._url),a=p._query,delete p._url,delete p._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,l,u,d,p=(o=this.apiClient,t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],t7(o,n)),null!=(l=th(e,["config"]))&&(u=th(l,["ttl"]),void 0!==t&&null!=u&&tc(t,["ttl"],u),d=th(l,["expireTime"]),void 0!==t&&null!=d&&tc(t,["expireTime"],d)),t);return s=tp("{name}",p._url),a=p._query,delete p._url,delete p._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s,a,u=(i={},null!=(r=th(e,["config"]))&&(s=th(r,["pageSize"]),void 0!==i&&null!=s&&tc(i,["_query","pageSize"],s),a=th(r,["pageToken"]),void 0!==i&&null!=a&&tc(i,["_query","pageToken"],a)),i);return l=tp("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["cachedContents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["cachedContents"],e)}return t}(e),n=new tP;return Object.assign(n,t),n})}{let t,n,s,a,u=(t={},null!=(n=th(e,["config"]))&&(s=th(n,["pageSize"]),void 0!==t&&null!=s&&tc(t,["_query","pageSize"],s),a=th(n,["pageToken"]),void 0!==t&&null!=a&&tc(t,["_query","pageToken"],a)),t);return l=tp("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["cachedContents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["cachedContents"],e)}return t}(e),n=new tP;return Object.assign(n,t),n})}}}function ng(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function ny(e){return this instanceof ny?(this.v=e,this):new ny(e)}function nv(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),l=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),i[Symbol.asyncIterator]=function(){return this},i;function o(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,i){l.push([e,t,n,i])>1||s(e,t)})},t&&(i[e]=t(i[e])))}function s(e,t){try{var n;(n=r[e](t)).value instanceof ny?Promise.resolve(n.value.v).then(a,u):d(l[0][2],n)}catch(e){d(l[0][3],e)}}function a(e){s("next",e)}function u(e){s("throw",e)}function d(e,t){e(t),l.shift(),l.length&&s(l[0][0],l[0][1])}}function nE(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){var l,o,s;l=i,o=r,s=(t=e[n](t)).done,Promise.resolve(t.value).then(function(e){l({value:e,done:s})},o)})}}}function nb(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function n_(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,i=0;for(;i<n;)if("user"===e[i].role)t.push(e[i]),i++;else{let r=[],l=!0;for(;i<n&&"model"===e[i].role;)r.push(e[i]),l&&!nb(e[i])&&(l=!1),i++;l?t.push(...r):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class nI{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new nA(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class nA{constructor(e,t,n,i={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=r,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(r)}async sendMessage(e){var t;await this.sendPromise;let n=t1(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});return this.sendPromise=(async()=>{var e,t,r;let l=await i,o=null==(t=null==(e=l.candidates)?void 0:e[0])?void 0:t.content,s=l.automaticFunctionCallingHistory,a=this.getHistory(!0).length,u=[];null!=s&&(u=null!=(r=s.slice(a))?r:[]),this.recordHistory(n,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;let n=t1(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});this.sendPromise=i.then(()=>void 0).catch(()=>void 0);let r=await i;return this.processStreamResponse(r,n)}getHistory(e=!1){return structuredClone(e?n_(this.history):this.history)}processStreamResponse(e,t){return nv(this,arguments,function*(){let n=[];try{for(var i,r,l,o,s,a,u,d=!0,p=nE(e);!(i=(u=yield ny(p.next())).done);d=!0){if(o=u.value,d=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;return void 0!==n&&nb(n)}(o)){let e=null==(a=null==(s=o.candidates)?void 0:s[0])?void 0:a.content;void 0!==e&&n.push(e)}yield yield ny(o)}}catch(e){r={error:e}}finally{try{!d&&!i&&(l=p.return)&&(yield ny(l.call(p)))}finally{if(r)throw r.error}}this.recordHistory(t,n)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(e=>void 0!==e.role)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...n_(n)):this.history.push(e),this.history.push(...i)}}class nT extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nT.prototype)}}class nS extends td{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nc(tt.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u=(l={},null!=(o=th(e,["config"]))&&(s=th(o,["pageSize"]),void 0!==l&&null!=s&&tc(l,["_query","pageSize"],s),a=th(o,["pageToken"]),void 0!==l&&null!=a&&tc(l,["_query","pageToken"],a)),l);return i=tp("files",u._url),r=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["files"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["files"],e)}return t}(e),n=new tU;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s=(l={},null!=(o=th(e,["file"]))&&tc(l,["file"],o),l);return i=tp("upload/v1beta/files",s._url),r=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tq;return Object.assign(r,i),r})}}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","file"],nt(o)),l);return i=tp("files/{file}",s._url),r=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","file"],nt(o)),l);return i=tp("files/{file}",s._url),r=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tL;return Object.assign(r,i),r})}}}function nC(e){let t={},n=th(e,["data"]);if(null!=n&&tc(t,["data"],n),void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}function nO(e){let t={},n=th(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c,h;return n={},null!=(i=th(t=e,["mediaResolution"]))&&tc(n,["mediaResolution"],i),null!=(r=th(t,["codeExecutionResult"]))&&tc(n,["codeExecutionResult"],r),null!=(l=th(t,["executableCode"]))&&tc(n,["executableCode"],l),null!=(o=th(t,["fileData"]))&&tc(n,["fileData"],function(e){let t={};if(void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=th(e,["fileUri"]);null!=n&&tc(t,["fileUri"],n);let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(o)),null!=(s=th(t,["functionCall"]))&&tc(n,["functionCall"],function(e){let t={},n=th(e,["id"]);null!=n&&tc(t,["id"],n);let i=th(e,["args"]);null!=i&&tc(t,["args"],i);let r=th(e,["name"]);if(null!=r&&tc(t,["name"],r),void 0!==th(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==th(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=th(t,["functionResponse"]))&&tc(n,["functionResponse"],a),null!=(u=th(t,["inlineData"]))&&tc(n,["inlineData"],function(e){let t={},n=th(e,["data"]);if(null!=n&&tc(t,["data"],n),void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(u)),null!=(d=th(t,["text"]))&&tc(n,["text"],d),null!=(p=th(t,["thought"]))&&tc(n,["thought"],p),null!=(c=th(t,["thoughtSignature"]))&&tc(n,["thoughtSignature"],c),null!=(h=th(t,["videoMetadata"]))&&tc(n,["videoMetadata"],h),n})),tc(t,["parts"],e)}let i=th(e,["role"]);return null!=i&&tc(t,["role"],i),t}function nx(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>nO(e))),tc(n,["contents"],e)}let l=th(t,["config"]);return null!=l&&tc(n,["generationConfig"],function(e,t,n){var i;let r,l,o,s={},a=th(t,["systemInstruction"]);void 0!==n&&null!=a&&tc(n,["systemInstruction"],nO(t1(a)));let u=th(t,["temperature"]);null!=u&&tc(s,["temperature"],u);let d=th(t,["topP"]);null!=d&&tc(s,["topP"],d);let p=th(t,["topK"]);null!=p&&tc(s,["topK"],p);let c=th(t,["candidateCount"]);null!=c&&tc(s,["candidateCount"],c);let h=th(t,["maxOutputTokens"]);null!=h&&tc(s,["maxOutputTokens"],h);let f=th(t,["stopSequences"]);null!=f&&tc(s,["stopSequences"],f);let m=th(t,["responseLogprobs"]);null!=m&&tc(s,["responseLogprobs"],m);let g=th(t,["logprobs"]);null!=g&&tc(s,["logprobs"],g);let y=th(t,["presencePenalty"]);null!=y&&tc(s,["presencePenalty"],y);let v=th(t,["frequencyPenalty"]);null!=v&&tc(s,["frequencyPenalty"],v);let E=th(t,["seed"]);null!=E&&tc(s,["seed"],E);let b=th(t,["responseMimeType"]);null!=b&&tc(s,["responseMimeType"],b);let _=th(t,["responseSchema"]);null!=_&&tc(s,["responseSchema"],t3(_));let I=th(t,["responseJsonSchema"]);if(null!=I&&tc(s,["responseJsonSchema"],I),void 0!==th(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==th(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=th(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["category"]);if(null!=n&&tc(t,["category"],n),void 0!==th(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=th(e,["threshold"]);return null!=i&&tc(t,["threshold"],i),t})(e))),tc(n,["safetySettings"],e)}let T=th(t,["tools"]);if(void 0!==n&&null!=T){let e=t9(T);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["functionDeclarations"],e)}if(void 0!==th(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=th(e,["googleSearchRetrieval"]);null!=i&&tc(t,["googleSearchRetrieval"],i);let r=th(e,["computerUse"]);null!=r&&tc(t,["computerUse"],r);let l=th(e,["fileSearch"]);null!=l&&tc(t,["fileSearch"],l);let o=th(e,["codeExecution"]);if(null!=o&&tc(t,["codeExecution"],o),void 0!==th(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=th(e,["googleMaps"]);null!=s&&tc(t,["googleMaps"],function(e){let t={};if(void 0!==th(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=th(e,["enableWidget"]);return null!=n&&tc(t,["enableWidget"],n),t}(s));let a=th(e,["googleSearch"]);null!=a&&tc(t,["googleSearch"],function(e){let t={};if(void 0!==th(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==th(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=th(e,["timeRangeFilter"]);return null!=n&&tc(t,["timeRangeFilter"],n),t}(a));let u=th(e,["urlContext"]);return null!=u&&tc(t,["urlContext"],u),t})(t8(e)))),tc(n,["tools"],e)}let S=th(t,["toolConfig"]);if(void 0!==n&&null!=S&&tc(n,["toolConfig"],(r={},null!=(l=th(i=S,["functionCallingConfig"]))&&tc(r,["functionCallingConfig"],function(e){let t={},n=th(e,["mode"]);null!=n&&tc(t,["mode"],n);let i=th(e,["allowedFunctionNames"]);if(null!=i&&tc(t,["allowedFunctionNames"],i),void 0!==th(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(l)),null!=(o=th(i,["retrievalConfig"]))&&tc(r,["retrievalConfig"],o),r)),void 0!==th(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let C=th(t,["cachedContent"]);void 0!==n&&null!=C&&tc(n,["cachedContent"],t7(e,C));let O=th(t,["responseModalities"]);null!=O&&tc(s,["responseModalities"],O);let x=th(t,["mediaResolution"]);null!=x&&tc(s,["mediaResolution"],x);let N=th(t,["speechConfig"]);if(null!=N&&tc(s,["speechConfig"],t4(N)),void 0!==th(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let w=th(t,["thinkingConfig"]);null!=w&&tc(s,["thinkingConfig"],w);let R=th(t,["imageConfig"]);null!=R&&tc(s,["imageConfig"],function(e){let t={},n=th(e,["aspectRatio"]);null!=n&&tc(t,["aspectRatio"],n);let i=th(e,["imageSize"]);if(null!=i&&tc(t,["imageSize"],i),void 0!==th(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==th(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(R));let P=th(t,["enableEnhancedCivicAnswers"]);return null!=P&&tc(s,["enableEnhancedCivicAnswers"],P),s}(e,l,n)),n}function nN(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>e)),tc(n,["contents"],e)}let l=th(t,["config"]);return null!=l&&tc(n,["generationConfig"],function(e,t,n){var i;let r,l,o,s,a,u={},d=th(t,["systemInstruction"]);void 0!==n&&null!=d&&tc(n,["systemInstruction"],t1(d));let p=th(t,["temperature"]);null!=p&&tc(u,["temperature"],p);let c=th(t,["topP"]);null!=c&&tc(u,["topP"],c);let h=th(t,["topK"]);null!=h&&tc(u,["topK"],h);let f=th(t,["candidateCount"]);null!=f&&tc(u,["candidateCount"],f);let m=th(t,["maxOutputTokens"]);null!=m&&tc(u,["maxOutputTokens"],m);let g=th(t,["stopSequences"]);null!=g&&tc(u,["stopSequences"],g);let y=th(t,["responseLogprobs"]);null!=y&&tc(u,["responseLogprobs"],y);let v=th(t,["logprobs"]);null!=v&&tc(u,["logprobs"],v);let E=th(t,["presencePenalty"]);null!=E&&tc(u,["presencePenalty"],E);let b=th(t,["frequencyPenalty"]);null!=b&&tc(u,["frequencyPenalty"],b);let _=th(t,["seed"]);null!=_&&tc(u,["seed"],_);let I=th(t,["responseMimeType"]);null!=I&&tc(u,["responseMimeType"],I);let A=th(t,["responseSchema"]);null!=A&&tc(u,["responseSchema"],t3(A));let T=th(t,["responseJsonSchema"]);null!=T&&tc(u,["responseJsonSchema"],T);let S=th(t,["routingConfig"]);null!=S&&tc(u,["routingConfig"],S);let C=th(t,["modelSelectionConfig"]);null!=C&&tc(u,["modelConfig"],C);let O=th(t,["safetySettings"]);if(void 0!==n&&null!=O){let e=O;Array.isArray(e)&&(e=e.map(e=>e)),tc(n,["safetySettings"],e)}let x=th(t,["tools"]);if(void 0!==n&&null!=x){let e=t9(x);Array.isArray(e)&&(e=e.map(e=>nG(t8(e)))),tc(n,["tools"],e)}let N=th(t,["toolConfig"]);void 0!==n&&null!=N&&tc(n,["toolConfig"],N);let w=th(t,["labels"]);void 0!==n&&null!=w&&tc(n,["labels"],w);let R=th(t,["cachedContent"]);void 0!==n&&null!=R&&tc(n,["cachedContent"],t7(e,R));let P=th(t,["responseModalities"]);null!=P&&tc(u,["responseModalities"],P);let j=th(t,["mediaResolution"]);null!=j&&tc(u,["mediaResolution"],j);let M=th(t,["speechConfig"]);null!=M&&tc(u,["speechConfig"],t4(M));let D=th(t,["audioTimestamp"]);null!=D&&tc(u,["audioTimestamp"],D);let k=th(t,["thinkingConfig"]);null!=k&&tc(u,["thinkingConfig"],k);let U=th(t,["imageConfig"]);if(null!=U&&tc(u,["imageConfig"],(r={},null!=(l=th(i=U,["aspectRatio"]))&&tc(r,["aspectRatio"],l),null!=(o=th(i,["imageSize"]))&&tc(r,["imageSize"],o),null!=(s=th(i,["outputMimeType"]))&&tc(r,["imageOutputOptions","mimeType"],s),null!=(a=th(i,["outputCompressionQuality"]))&&tc(r,["imageOutputOptions","compressionQuality"],a),r)),void 0!==th(t,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return u}(e,l,n)),n}function nw(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["content"]);null!=n&&tc(t,["content"],n);let i=th(e,["citationMetadata"]);null!=i&&tc(t,["citationMetadata"],function(e){let t={},n=th(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["citations"],e)}return t}(i));let r=th(e,["tokenCount"]);null!=r&&tc(t,["tokenCount"],r);let l=th(e,["finishReason"]);null!=l&&tc(t,["finishReason"],l);let o=th(e,["avgLogprobs"]);null!=o&&tc(t,["avgLogprobs"],o);let s=th(e,["groundingMetadata"]);null!=s&&tc(t,["groundingMetadata"],s);let a=th(e,["index"]);null!=a&&tc(t,["index"],a);let u=th(e,["logprobsResult"]);null!=u&&tc(t,["logprobsResult"],u);let d=th(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["safetyRatings"],e)}let p=th(e,["urlContextMetadata"]);return null!=p&&tc(t,["urlContextMetadata"],p),t})(e))),tc(t,["candidates"],e)}let r=th(e,["modelVersion"]);null!=r&&tc(t,["modelVersion"],r);let l=th(e,["promptFeedback"]);null!=l&&tc(t,["promptFeedback"],l);let o=th(e,["responseId"]);null!=o&&tc(t,["responseId"],o);let s=th(e,["usageMetadata"]);return null!=s&&tc(t,["usageMetadata"],s),t}function nR(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["candidates"],e)}let r=th(e,["createTime"]);null!=r&&tc(t,["createTime"],r);let l=th(e,["modelVersion"]);null!=l&&tc(t,["modelVersion"],l);let o=th(e,["promptFeedback"]);null!=o&&tc(t,["promptFeedback"],o);let s=th(e,["responseId"]);null!=s&&tc(t,["responseId"],s);let a=th(e,["usageMetadata"]);return null!=a&&tc(t,["usageMetadata"],a),t}function nP(e){let t={},n=th(e,["_self"]);null!=n&&tc(t,["image"],nj(n));let i=th(e,["raiFilteredReason"]);null!=i&&tc(t,["raiFilteredReason"],i);let r=th(e,["_self"]);null!=r&&tc(t,["safetyAttributes"],nL(r));let l=th(e,["prompt"]);return null!=l&&tc(t,["enhancedPrompt"],l),t}function nj(e){let t={},n=th(e,["gcsUri"]);null!=n&&tc(t,["gcsUri"],n);let i=th(e,["bytesBase64Encoded"]);null!=i&&tc(t,["imageBytes"],tf(i));let r=th(e,["mimeType"]);return null!=r&&tc(t,["mimeType"],r),t}function nM(e){let t={};if(void 0!==th(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let n=th(e,["imageBytes"]);null!=n&&tc(t,["bytesBase64Encoded"],tf(n));let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}function nD(e){let t={},n=th(e,["gcsUri"]);null!=n&&tc(t,["gcsUri"],n);let i=th(e,["imageBytes"]);null!=i&&tc(t,["bytesBase64Encoded"],tf(i));let r=th(e,["mimeType"]);return null!=r&&tc(t,["mimeType"],r),t}function nk(e){var t;let n,i,r,l,o={},s=th(e,["name"]);null!=s&&tc(o,["name"],s);let a=th(e,["displayName"]);null!=a&&tc(o,["displayName"],a);let u=th(e,["description"]);null!=u&&tc(o,["description"],u);let d=th(e,["version"]);null!=d&&tc(o,["version"],d);let p=th(e,["_self"]);null!=p&&tc(o,["tunedModelInfo"],(n={},null!=(i=th(t=p,["baseModel"]))&&tc(n,["baseModel"],i),null!=(r=th(t,["createTime"]))&&tc(n,["createTime"],r),null!=(l=th(t,["updateTime"]))&&tc(n,["updateTime"],l),n));let c=th(e,["inputTokenLimit"]);null!=c&&tc(o,["inputTokenLimit"],c);let h=th(e,["outputTokenLimit"]);null!=h&&tc(o,["outputTokenLimit"],h);let f=th(e,["supportedGenerationMethods"]);null!=f&&tc(o,["supportedActions"],f);let m=th(e,["temperature"]);null!=m&&tc(o,["temperature"],m);let g=th(e,["maxTemperature"]);null!=g&&tc(o,["maxTemperature"],g);let y=th(e,["topP"]);null!=y&&tc(o,["topP"],y);let v=th(e,["topK"]);null!=v&&tc(o,["topK"],v);let E=th(e,["thinking"]);return null!=E&&tc(o,["thinking"],E),o}function nU(e){var t;let n,i,r,l,o={},s=th(e,["name"]);null!=s&&tc(o,["name"],s);let a=th(e,["displayName"]);null!=a&&tc(o,["displayName"],a);let u=th(e,["description"]);null!=u&&tc(o,["description"],u);let d=th(e,["versionId"]);null!=d&&tc(o,["version"],d);let p=th(e,["deployedModels"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>{let t,n,i;return t={},null!=(n=th(e,["endpoint"]))&&tc(t,["name"],n),null!=(i=th(e,["deployedModelId"]))&&tc(t,["deployedModelId"],i),t})),tc(o,["endpoints"],e)}let c=th(e,["labels"]);null!=c&&tc(o,["labels"],c);let h=th(e,["_self"]);null!=h&&tc(o,["tunedModelInfo"],(n={},null!=(i=th(t=h,["labels","google-vertex-llm-tuning-base-model-id"]))&&tc(n,["baseModel"],i),null!=(r=th(t,["createTime"]))&&tc(n,["createTime"],r),null!=(l=th(t,["updateTime"]))&&tc(n,["updateTime"],l),n));let f=th(e,["defaultCheckpointId"]);null!=f&&tc(o,["defaultCheckpointId"],f);let m=th(e,["checkpoints"]);if(null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>e)),tc(o,["checkpoints"],e)}return o}function nq(e){let t={},n=th(e,["safetyAttributes","categories"]);null!=n&&tc(t,["categories"],n);let i=th(e,["safetyAttributes","scores"]);null!=i&&tc(t,["scores"],i);let r=th(e,["contentType"]);return null!=r&&tc(t,["contentType"],r),t}function nL(e){let t={},n=th(e,["safetyAttributes","categories"]);null!=n&&tc(t,["categories"],n);let i=th(e,["safetyAttributes","scores"]);null!=i&&tc(t,["scores"],i);let r=th(e,["contentType"]);return null!=r&&tc(t,["contentType"],r),t}function nG(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==th(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=th(e,["description"]);null!=n&&tc(t,["description"],n);let i=th(e,["name"]);null!=i&&tc(t,["name"],i);let r=th(e,["parameters"]);null!=r&&tc(t,["parameters"],r);let l=th(e,["parametersJsonSchema"]);null!=l&&tc(t,["parametersJsonSchema"],l);let o=th(e,["response"]);null!=o&&tc(t,["response"],o);let s=th(e,["responseJsonSchema"]);return null!=s&&tc(t,["responseJsonSchema"],s),t})(e))),tc(t,["functionDeclarations"],e)}let i=th(e,["retrieval"]);null!=i&&tc(t,["retrieval"],i);let r=th(e,["googleSearchRetrieval"]);null!=r&&tc(t,["googleSearchRetrieval"],r);let l=th(e,["computerUse"]);if(null!=l&&tc(t,["computerUse"],l),void 0!==th(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=th(e,["codeExecution"]);null!=o&&tc(t,["codeExecution"],o);let s=th(e,["enterpriseWebSearch"]);null!=s&&tc(t,["enterpriseWebSearch"],s);let a=th(e,["googleMaps"]);null!=a&&tc(t,["googleMaps"],a);let u=th(e,["googleSearch"]);null!=u&&tc(t,["googleSearch"],u);let d=th(e,["urlContext"]);return null!=d&&tc(t,["urlContext"],d),t}function nH(e){let t={},n=th(e,["uri"]);null!=n&&tc(t,["uri"],n);let i=th(e,["videoBytes"]);null!=i&&tc(t,["encodedVideo"],tf(i));let r=th(e,["mimeType"]);return null!=r&&tc(t,["encoding"],r),t}function nF(e){let t={},n=th(e,["uri"]);null!=n&&tc(t,["gcsUri"],n);let i=th(e,["videoBytes"]);null!=i&&tc(t,["bytesBase64Encoded"],tf(i));let r=th(e,["mimeType"]);return null!=r&&tc(t,["mimeType"],r),t}function nV(e,t){let n=th(e,["mimeType"]);void 0!==t&&null!=n&&tc(t,["mimeType"],n);let i=th(e,["displayName"]);void 0!==t&&null!=i&&tc(t,["displayName"],i);let r=th(e,["customMetadata"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["customMetadata"],e)}let l=th(e,["chunkingConfig"]);return void 0!==t&&null!=l&&tc(t,["chunkingConfig"],l),{}}let nB="x-goog-api-client";class nJ{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!=(t=this.clientOptions.apiVersion)?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!=(n=this.clientOptions.apiVersion)?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!=(e=this.clientOptions.vertexai)&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,n){let i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))i.searchParams.append(t,String(n));let r={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.unaryApiCall(i,r,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,i]of Object.entries(t))"object"==typeof i?n[e]=Object.assign(Object.assign({},n[e]),i):void 0!==i&&(n[e]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.streamApiCall(i,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){let n=new AbortController,r=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}i&&i.addEventListener("abort",()=>{n.abort()}),e.signal=r}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}e.body=JSON.stringify(function e(t,n){let i=Object.assign({},t);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],l=i[t];r&&"object"==typeof r&&!Array.isArray(r)&&l&&"object"==typeof l&&!Array.isArray(l)?i[t]=e(l,r):(l&&r&&typeof l!=typeof r&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof l}, New type: ${typeof r}. Overwriting.`),i[t]=r)}return i}(n,t))}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await n$(e),new tg(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await n$(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){return nv(this,arguments,function*(){var t;let n=null==(t=null==e?void 0:e.body)?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="",r="data:",l=["\n\n","\r\r","\r\n\r\n"];for(;;){let{done:o,value:s}=yield ny(n.read());if(o){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let a=i.decode(s,{stream:!0});try{let e=JSON.parse(a);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,r=`got status: ${n}. ${JSON.stringify(e)}`;if(i>=400&&i<600)throw new nT({message:r,status:i})}}catch(e){if("ApiError"===e.name)throw e}t+=a;let u=-1,d=0;for(;;){for(let e of(u=-1,d=0,l)){let n=t.indexOf(e);-1!==n&&(-1===u||n<u)&&(u=n,d=e.length)}if(-1===u)break;let n=t.substring(0,u);t=t.substring(u+d);let i=n.trim();if(i.startsWith(r)){let t=i.substring(r.length).trim();try{let n=new Response(t,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield ny(new tg(n))}catch(e){throw Error(`exception parsing stream chunk ${t}. ${e}`)}}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[nB]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){let n=new Headers;if(e&&e.headers){for(let[t,i]of Object.entries(e.headers))n.append(t,i);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=null!=(t=(n=e.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())?t:""),n}async uploadFile(e,t){var n;let i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);let r=this.clientOptions.uploader,l=await r.stat(e);i.sizeBytes=String(l.size);let o=null!=(n=null==t?void 0:t.mimeType)?n:l.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;let s={file:i},a=this.getFileName(e),u=tp("upload/v1beta/files",s._url),d=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,a,s,null==t?void 0:t.httpOptions);return r.upload(e,d,this)}async uploadFileToFileSearchStore(e,t,n){var i;let r=this.clientOptions.uploader,l=await r.stat(t),o=String(l.size),s=null!=(i=null==n?void 0:n.mimeType)?i:l.type;if(void 0===s||""===s)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let a=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),d={};null!=n&&nV(n,d);let p=await this.fetchUploadUrl(a,o,s,u,d,null==n?void 0:n.httpOptions);return r.uploadToFileSearchStore(t,p,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,i,r,l){var o;let s={};s=l||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};let a=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:s});if(!a||!(null==a?void 0:a.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let u=null==(o=null==a?void 0:a.headers)?void 0:o["x-goog-upload-url"];if(void 0===u)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function n$(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let n=e.status,i=JSON.stringify((null==(t=e.headers.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(n>=400&&n<600)throw new nT({message:i,status:n});throw Error(i)}}function nY(e){for(let n of e){var t;if(null!==(t=n)&&"object"==typeof t&&t instanceof nK||"object"==typeof n&&"inputSchema"in n)return!0}return!1}function nW(e){var t;let n=null!=(t=e[nB])?t:"";e[nB]=(n+" mcp_used/unknown").trimStart()}class nK{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new nK(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;let r={},l=[];for(let u of this.mcpClients)try{for(var o,s=!0,a=(t=void 0,nE(function(e){return nv(this,arguments,function*(e,t=100){let n,i=0;for(;i<t;){let t=yield ny(e.listTools({cursor:n}));for(let e of t.tools)yield yield ny(e),i++;if(!t.nextCursor)break;n=t.nextCursor}})}(u)));!(e=(o=await a.next()).done);s=!0){i=o.value,s=!1,l.push(i);let e=i.name;if(r[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);r[e]=u}}catch(e){t={error:e}}finally{try{!s&&!e&&(n=a.return)&&await n.call(a)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),function(e,t={}){let n=[],i=new Set;for(let r of e){let e=r.name;if(i.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i.add(e);let l=function(e,t={}){let n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(n.responseJsonSchema=e.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}(r,t);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e,i=this.functionNameToMcpClient[n.name];this.config.timeout&&(e={timeout:this.config.timeout});let r=await i.callTool({name:n.name,arguments:n.args},void 0,e);t.push({functionResponse:{name:n.name,response:r.isError?{error:r}:r}})}return t}}async function nz(e,t,n){let i=new tF;Object.assign(i,n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data)),t(i)}class nX{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;let i;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let r=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),o=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(this.apiClient.getDefaultHeaders()),s=this.apiClient.getApiKey(),a=`${r}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${s}`,u=()=>{},d=new Promise(e=>{u=e}),p=e.callbacks,c=this.apiClient,h={onopen:function(){u({})},onmessage:e=>{nz(c,p.onmessage,e)},onerror:null!=(t=null==p?void 0:p.onerror)?t:function(e){},onclose:null!=(n=null==p?void 0:p.onclose)?n:function(e){}},f=this.webSocketFactory.create(a,(i={},o.forEach((e,t)=>{i[t]=e}),i),h);f.connect(),await d;let m=tB(this.apiClient,e.model);return f.send(JSON.stringify({setup:{model:m}})),new nQ(f,this.apiClient)}}class nQ{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},n=th(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){let t,n;e.musicGenerationConfig||(e.musicGenerationConfig={});let i=(t={},null!=(n=th(e,["musicGenerationConfig"]))&&tc(t,["musicGenerationConfig"],n),t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(te.PLAY)}pause(){this.sendPlaybackControl(te.PAUSE)}stop(){this.sendPlaybackControl(te.STOP)}resetContext(){this.sendPlaybackControl(te.RESET_CONTEXT)}close(){this.conn.close()}}async function nZ(e,t,n){let i=new tH,r=JSON.parse(n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data);if(e.isVertexAI()){let e,t,n,l,o,s,a,u,d;Object.assign(i,(e={},null!=(t=th(r,["setupComplete"]))&&tc(e,["setupComplete"],t),null!=(n=th(r,["serverContent"]))&&tc(e,["serverContent"],n),null!=(l=th(r,["toolCall"]))&&tc(e,["toolCall"],l),null!=(o=th(r,["toolCallCancellation"]))&&tc(e,["toolCallCancellation"],o),null!=(s=th(r,["usageMetadata"]))&&tc(e,["usageMetadata"],function(e){let t={},n=th(e,["promptTokenCount"]);null!=n&&tc(t,["promptTokenCount"],n);let i=th(e,["cachedContentTokenCount"]);null!=i&&tc(t,["cachedContentTokenCount"],i);let r=th(e,["candidatesTokenCount"]);null!=r&&tc(t,["responseTokenCount"],r);let l=th(e,["toolUsePromptTokenCount"]);null!=l&&tc(t,["toolUsePromptTokenCount"],l);let o=th(e,["thoughtsTokenCount"]);null!=o&&tc(t,["thoughtsTokenCount"],o);let s=th(e,["totalTokenCount"]);null!=s&&tc(t,["totalTokenCount"],s);let a=th(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["promptTokensDetails"],e)}let u=th(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["cacheTokensDetails"],e)}let d=th(e,["candidatesTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["responseTokensDetails"],e)}let p=th(e,["toolUsePromptTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["toolUsePromptTokensDetails"],e)}let c=th(e,["trafficType"]);return null!=c&&tc(t,["trafficType"],c),t}(s)),null!=(a=th(r,["goAway"]))&&tc(e,["goAway"],a),null!=(u=th(r,["sessionResumptionUpdate"]))&&tc(e,["sessionResumptionUpdate"],u),null!=(d=th(r,["voiceActivityDetectionSignal"]))&&tc(e,["voiceActivityDetectionSignal"],d),e))}else Object.assign(i,r);t(i)}class n0{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new nX(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,r,l,o,s,a;let u,d;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let p=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),h=this.apiClient.getHeaders();e.config&&e.config.tools&&nY(e.config.tools)&&nW(h);let f=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(h);if(this.apiClient.isVertexAI())u=`${p}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(f,u);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==c&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),u=`${p}/ws/google.ai.generativelanguage.${c}.GenerativeService.${t}?${n}=${e}`}let m=()=>{},g=new Promise(e=>{m=e}),y=e.callbacks,v=this.apiClient,E={onopen:function(){var e;null==(e=null==y?void 0:y.onopen)||e.call(y),m({})},onmessage:e=>{nZ(v,y.onmessage,e)},onerror:null!=(t=null==y?void 0:y.onerror)?t:function(e){},onclose:null!=(n=null==y?void 0:y.onclose)?n:function(e){}},b=this.webSocketFactory.create(u,(d={},f.forEach((e,t)=>{d[t]=e}),d),E);b.connect(),await g;let _=tB(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&_.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();_=`projects/${e}/locations/${t}/`+_}let I={};this.apiClient.isVertexAI()&&(null==(i=e.config)?void 0:i.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[ex.AUDIO]}:e.config.responseModalities=[ex.AUDIO]),(null==(r=e.config)?void 0:r.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let A=null!=(o=null==(l=e.config)?void 0:l.tools)?o:[],T=[];for(let e of A)this.isCallableTool(e)?T.push(await e.tool()):T.push(e);T.length>0&&(e.config.tools=T);let S={model:_,config:e.config,callbacks:e.callbacks};if(this.apiClient.isVertexAI()){let e,t,n;s=this.apiClient,e={},null!=(t=th(S,["model"]))&&tc(e,["setup","model"],tB(s,t)),null!=(n=th(S,["config"]))&&tc(e,["config"],function(e,t){let n=th(e,["generationConfig"]);void 0!==t&&null!=n&&tc(t,["setup","generationConfig"],function(e){let t={},n=th(e,["modelSelectionConfig"]);null!=n&&tc(t,["modelConfig"],n);let i=th(e,["responseJsonSchema"]);null!=i&&tc(t,["responseJsonSchema"],i);let r=th(e,["audioTimestamp"]);null!=r&&tc(t,["audioTimestamp"],r);let l=th(e,["candidateCount"]);null!=l&&tc(t,["candidateCount"],l);let o=th(e,["enableAffectiveDialog"]);null!=o&&tc(t,["enableAffectiveDialog"],o);let s=th(e,["frequencyPenalty"]);null!=s&&tc(t,["frequencyPenalty"],s);let a=th(e,["logprobs"]);null!=a&&tc(t,["logprobs"],a);let u=th(e,["maxOutputTokens"]);null!=u&&tc(t,["maxOutputTokens"],u);let d=th(e,["mediaResolution"]);null!=d&&tc(t,["mediaResolution"],d);let p=th(e,["presencePenalty"]);null!=p&&tc(t,["presencePenalty"],p);let c=th(e,["responseLogprobs"]);null!=c&&tc(t,["responseLogprobs"],c);let h=th(e,["responseMimeType"]);null!=h&&tc(t,["responseMimeType"],h);let f=th(e,["responseModalities"]);null!=f&&tc(t,["responseModalities"],f);let m=th(e,["responseSchema"]);null!=m&&tc(t,["responseSchema"],m);let g=th(e,["routingConfig"]);null!=g&&tc(t,["routingConfig"],g);let y=th(e,["seed"]);null!=y&&tc(t,["seed"],y);let v=th(e,["speechConfig"]);null!=v&&tc(t,["speechConfig"],v);let E=th(e,["stopSequences"]);null!=E&&tc(t,["stopSequences"],E);let b=th(e,["temperature"]);null!=b&&tc(t,["temperature"],b);let _=th(e,["thinkingConfig"]);null!=_&&tc(t,["thinkingConfig"],_);let I=th(e,["topK"]);null!=I&&tc(t,["topK"],I);let A=th(e,["topP"]);if(null!=A&&tc(t,["topP"],A),void 0!==th(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));let i=th(e,["responseModalities"]);void 0!==t&&null!=i&&tc(t,["setup","generationConfig","responseModalities"],i);let r=th(e,["temperature"]);void 0!==t&&null!=r&&tc(t,["setup","generationConfig","temperature"],r);let l=th(e,["topP"]);void 0!==t&&null!=l&&tc(t,["setup","generationConfig","topP"],l);let o=th(e,["topK"]);void 0!==t&&null!=o&&tc(t,["setup","generationConfig","topK"],o);let s=th(e,["maxOutputTokens"]);void 0!==t&&null!=s&&tc(t,["setup","generationConfig","maxOutputTokens"],s);let a=th(e,["mediaResolution"]);void 0!==t&&null!=a&&tc(t,["setup","generationConfig","mediaResolution"],a);let u=th(e,["seed"]);void 0!==t&&null!=u&&tc(t,["setup","generationConfig","seed"],u);let d=th(e,["speechConfig"]);void 0!==t&&null!=d&&tc(t,["setup","generationConfig","speechConfig"],t5(d));let p=th(e,["thinkingConfig"]);void 0!==t&&null!=p&&tc(t,["setup","generationConfig","thinkingConfig"],p);let c=th(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&tc(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=th(e,["systemInstruction"]);void 0!==t&&null!=h&&tc(t,["setup","systemInstruction"],t1(h));let f=th(e,["tools"]);if(void 0!==t&&null!=f){let e=t9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==th(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=th(e,["description"]);null!=n&&tc(t,["description"],n);let i=th(e,["name"]);null!=i&&tc(t,["name"],i);let r=th(e,["parameters"]);null!=r&&tc(t,["parameters"],r);let l=th(e,["parametersJsonSchema"]);null!=l&&tc(t,["parametersJsonSchema"],l);let o=th(e,["response"]);null!=o&&tc(t,["response"],o);let s=th(e,["responseJsonSchema"]);return null!=s&&tc(t,["responseJsonSchema"],s),t})(e))),tc(t,["functionDeclarations"],e)}let i=th(e,["retrieval"]);null!=i&&tc(t,["retrieval"],i);let r=th(e,["googleSearchRetrieval"]);null!=r&&tc(t,["googleSearchRetrieval"],r);let l=th(e,["computerUse"]);if(null!=l&&tc(t,["computerUse"],l),void 0!==th(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=th(e,["codeExecution"]);null!=o&&tc(t,["codeExecution"],o);let s=th(e,["enterpriseWebSearch"]);null!=s&&tc(t,["enterpriseWebSearch"],s);let a=th(e,["googleMaps"]);null!=a&&tc(t,["googleMaps"],a);let u=th(e,["googleSearch"]);null!=u&&tc(t,["googleSearch"],u);let d=th(e,["urlContext"]);return null!=d&&tc(t,["urlContext"],d),t})(t8(e)))),tc(t,["setup","tools"],e)}let m=th(e,["sessionResumption"]);void 0!==t&&null!=m&&tc(t,["setup","sessionResumption"],m);let g=th(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&tc(t,["setup","inputAudioTranscription"],g);let y=th(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&tc(t,["setup","outputAudioTranscription"],y);let v=th(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&tc(t,["setup","realtimeInputConfig"],v);let E=th(e,["contextWindowCompression"]);void 0!==t&&null!=E&&tc(t,["setup","contextWindowCompression"],E);let b=th(e,["proactivity"]);void 0!==t&&null!=b&&tc(t,["setup","proactivity"],b);let _=th(e,["explicitVadSignal"]);return void 0!==t&&null!=_&&tc(t,["setup","explicitVadSignal"],_),{}}(n,e)),I=e}else{let e,t,n;a=this.apiClient,e={},null!=(t=th(S,["model"]))&&tc(e,["setup","model"],tB(a,t)),null!=(n=th(S,["config"]))&&tc(e,["config"],function(e,t){let n=th(e,["generationConfig"]);void 0!==t&&null!=n&&tc(t,["setup","generationConfig"],n);let i=th(e,["responseModalities"]);void 0!==t&&null!=i&&tc(t,["setup","generationConfig","responseModalities"],i);let r=th(e,["temperature"]);void 0!==t&&null!=r&&tc(t,["setup","generationConfig","temperature"],r);let l=th(e,["topP"]);void 0!==t&&null!=l&&tc(t,["setup","generationConfig","topP"],l);let o=th(e,["topK"]);void 0!==t&&null!=o&&tc(t,["setup","generationConfig","topK"],o);let s=th(e,["maxOutputTokens"]);void 0!==t&&null!=s&&tc(t,["setup","generationConfig","maxOutputTokens"],s);let a=th(e,["mediaResolution"]);void 0!==t&&null!=a&&tc(t,["setup","generationConfig","mediaResolution"],a);let u=th(e,["seed"]);void 0!==t&&null!=u&&tc(t,["setup","generationConfig","seed"],u);let d=th(e,["speechConfig"]);void 0!==t&&null!=d&&tc(t,["setup","generationConfig","speechConfig"],t5(d));let p=th(e,["thinkingConfig"]);void 0!==t&&null!=p&&tc(t,["setup","generationConfig","thinkingConfig"],p);let c=th(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&tc(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=th(e,["systemInstruction"]);void 0!==t&&null!=h&&tc(t,["setup","systemInstruction"],function(e){let t={},n=th(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c,h;return n={},null!=(i=th(t=e,["mediaResolution"]))&&tc(n,["mediaResolution"],i),null!=(r=th(t,["codeExecutionResult"]))&&tc(n,["codeExecutionResult"],r),null!=(l=th(t,["executableCode"]))&&tc(n,["executableCode"],l),null!=(o=th(t,["fileData"]))&&tc(n,["fileData"],function(e){let t={};if(void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=th(e,["fileUri"]);null!=n&&tc(t,["fileUri"],n);let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(o)),null!=(s=th(t,["functionCall"]))&&tc(n,["functionCall"],function(e){let t={},n=th(e,["id"]);null!=n&&tc(t,["id"],n);let i=th(e,["args"]);null!=i&&tc(t,["args"],i);let r=th(e,["name"]);if(null!=r&&tc(t,["name"],r),void 0!==th(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==th(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=th(t,["functionResponse"]))&&tc(n,["functionResponse"],a),null!=(u=th(t,["inlineData"]))&&tc(n,["inlineData"],nC(u)),null!=(d=th(t,["text"]))&&tc(n,["text"],d),null!=(p=th(t,["thought"]))&&tc(n,["thought"],p),null!=(c=th(t,["thoughtSignature"]))&&tc(n,["thoughtSignature"],c),null!=(h=th(t,["videoMetadata"]))&&tc(n,["videoMetadata"],h),n})),tc(t,["parts"],e)}let i=th(e,["role"]);return null!=i&&tc(t,["role"],i),t}(t1(h)));let f=th(e,["tools"]);if(void 0!==t&&null!=f){let e=t9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["functionDeclarations"],e)}if(void 0!==th(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=th(e,["googleSearchRetrieval"]);null!=i&&tc(t,["googleSearchRetrieval"],i);let r=th(e,["computerUse"]);null!=r&&tc(t,["computerUse"],r);let l=th(e,["fileSearch"]);null!=l&&tc(t,["fileSearch"],l);let o=th(e,["codeExecution"]);if(null!=o&&tc(t,["codeExecution"],o),void 0!==th(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=th(e,["googleMaps"]);null!=s&&tc(t,["googleMaps"],function(e){let t={};if(void 0!==th(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=th(e,["enableWidget"]);return null!=n&&tc(t,["enableWidget"],n),t}(s));let a=th(e,["googleSearch"]);null!=a&&tc(t,["googleSearch"],function(e){let t={};if(void 0!==th(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==th(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=th(e,["timeRangeFilter"]);return null!=n&&tc(t,["timeRangeFilter"],n),t}(a));let u=th(e,["urlContext"]);return null!=u&&tc(t,["urlContext"],u),t})(t8(e)))),tc(t,["setup","tools"],e)}let m=th(e,["sessionResumption"]);void 0!==t&&null!=m&&tc(t,["setup","sessionResumption"],function(e){let t={},n=th(e,["handle"]);if(null!=n&&tc(t,["handle"],n),void 0!==th(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=th(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&tc(t,["setup","inputAudioTranscription"],g);let y=th(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&tc(t,["setup","outputAudioTranscription"],y);let v=th(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&tc(t,["setup","realtimeInputConfig"],v);let E=th(e,["contextWindowCompression"]);void 0!==t&&null!=E&&tc(t,["setup","contextWindowCompression"],E);let b=th(e,["proactivity"]);if(void 0!==t&&null!=b&&tc(t,["setup","proactivity"],b),void 0!==th(e,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(n,e)),I=e}return delete I.config,b.send(JSON.stringify(I)),new n2(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let n1={turnComplete:!0};class n2{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=t6(t.turns),e.isVertexAI()||(n=n.map(e=>nO(e)))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},n1),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},n=th(e,["media"]);if(null!=n){let e=t$(n);Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["mediaChunks"],e)}let i=th(e,["audio"]);null!=i&&tc(t,["audio"],tK(i));let r=th(e,["audioStreamEnd"]);null!=r&&tc(t,["audioStreamEnd"],r);let l=th(e,["video"]);null!=l&&tc(t,["video"],tW(l));let o=th(e,["text"]);null!=o&&tc(t,["text"],o);let s=th(e,["activityStart"]);null!=s&&tc(t,["activityStart"],s);let a=th(e,["activityEnd"]);return null!=a&&tc(t,["activityEnd"],a),t}(e)}:{realtimeInput:function(e){let t={},n=th(e,["media"]);if(null!=n){let e=t$(n);Array.isArray(e)&&(e=e.map(e=>nC(e))),tc(t,["mediaChunks"],e)}let i=th(e,["audio"]);null!=i&&tc(t,["audio"],nC(tK(i)));let r=th(e,["audioStreamEnd"]);null!=r&&tc(t,["audioStreamEnd"],r);let l=th(e,["video"]);null!=l&&tc(t,["video"],nC(tW(l)));let o=th(e,["text"]);null!=o&&tc(t,["text"],o);let s=th(e,["activityStart"]);null!=s&&tc(t,["activityStart"],s);let a=th(e,["activityEnd"]);return null!=a&&tc(t,["activityEnd"],a),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function n6(e){var t,n,i;if(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.disable)return!0;let r=!1;for(let t of null!=(n=null==e?void 0:e.tools)?n:[])if(n3(t)){r=!0;break}if(!r)return!0;let l=null==(i=null==e?void 0:e.automaticFunctionCalling)?void 0:i.maximumRemoteCalls;return(!(!l||!(l<0)&&Number.isInteger(l))||0==l)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0)}function n3(e){return"callTool"in e&&"function"==typeof e.callTool}function n4(e){var t;let n=[];return(null==(t=null==e?void 0:e.config)?void 0:t.tools)&&e.config.tools.forEach((e,t)=>{n3(e)||e.functionDeclarations&&e.functionDeclarations.length>0&&n.push(t)}),n}function n5(e){var t;return!(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.ignoreCallHistory)}class n8 extends td{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,i,r,l,o,s,a;let u,d,p=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!(null!=(a=null==(s=null==(o=e.config)?void 0:o.tools)?void 0:s.some(e=>n3(e)))&&a)||n6(e.config))return await this.generateContentInternal(p);let c=n4(e);if(c.length>0){let e=c.map(e=>`tools[${e}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let h=t6(p.contents),f=null!=(i=null==(n=null==(t=p.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,m=0;for(;m<f&&(u=await this.generateContentInternal(p)).functionCalls&&0!==u.functionCalls.length;){let t=u.candidates[0].content,n=[];for(let t of null!=(l=null==(r=e.config)?void 0:r.tools)?l:[])if(n3(t)){let e=await t.callTool(u.functionCalls);n.push(...e)}m++,d={role:"user",parts:n},p.contents=t6(p.contents),p.contents.push(t),p.contents.push(d),n5(p.config)&&(h.push(t),h.push(d))}return n5(p.config)&&(u.automaticFunctionCallingHistory=h),u},this.generateContentStream=async e=>{var t,n,i,r,l;if(this.maybeMoveToResponseJsonSchem(e),n6(e.config)){let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}let o=n4(e);if(o.length>0){let e=o.map(e=>`tools[${e}]`).join(", ");throw Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let s=null==(i=null==(n=null==(t=null==e?void 0:e.config)?void 0:t.toolConfig)?void 0:n.functionCallingConfig)?void 0:i.streamFunctionCallArguments,a=null==(l=null==(r=null==e?void 0:e.config)?void 0:r.automaticFunctionCalling)?void 0:l.disable;if(s&&!a)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n,i=[];if(null==e?void 0:e.generatedImages)for(let r of e.generatedImages)r&&(null==r?void 0:r.safetyAttributes)&&(null==(t=null==r?void 0:r.safetyAttributes)?void 0:t.contentType)==="Positive Prompt"?n=null==r?void 0:r.safetyAttributes:i.push(r);return n?{generatedImages:i,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:i,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase)if(null==(t=n.config)?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else n.config.filter="labels.tune-type:*";return new nc(tt.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,i,r,l,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(t=e.video)?void 0:t.uri)&&(null==(n=e.video)?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null==(r=null==(i=e.source)?void 0:i.video)?void 0:r.uri)&&(null==(o=null==(l=e.source)?void 0:l.video)?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,n,i;let r=null==(t=e.config)?void 0:t.tools;if(!r)return e;let l=await Promise.all(r.map(async e=>n3(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(o.config.tools=l,e.config&&e.config.tools&&nY(e.config.tools)){let t=Object.assign({},null!=(i=null==(n=e.config.httpOptions)?void 0:n.headers)?i:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),nW(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,n,i;let r=new Map;for(let l of null!=(n=null==(t=e.config)?void 0:t.tools)?n:[])if(n3(l))for(let e of null!=(i=(await l.tool()).functionDeclarations)?i:[]){if(!e.name)throw Error("Function declaration name is required.");if(r.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);r.set(e.name,l)}return r}async processAfcStream(e){var t,n,i;let r=null!=(i=null==(n=null==(t=e.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,l=!1,o=0;return function(e,t,n){return nv(this,arguments,function*(){for(;o<r;){l&&(o++,l=!1);let m=yield ny(e.processParamsMaybeAddMcpUsage(n)),g=yield ny(e.generateContentStreamInternal(m)),y=[],v=[];try{for(var i,s,a,u,d,p,c,h=!0,f=(s=void 0,nE(g));!(i=(c=yield ny(f.next())).done);h=!0)if(u=c.value,h=!1,yield yield ny(u),u.candidates&&(null==(d=u.candidates[0])?void 0:d.content)){for(let e of(v.push(u.candidates[0].content),null!=(p=u.candidates[0].content.parts)?p:[]))if(o<r&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield ny(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){s={error:e}}finally{try{!h&&!i&&(a=f.return)&&(yield ny(a.call(f)))}finally{if(s)throw s.error}}if(y.length>0){l=!0;let e=new ty;e.candidates=[{content:{role:"user",parts:y}}],yield yield ny(e);let t=[];t.push(...v),t.push({role:"user",parts:y});let i=t6(n.contents).concat(t);n.contents=i}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=nN(this.apiClient,e);return l=tp("{model}:generateContent",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=nR(e),n=new ty;return Object.assign(n,t),n})}{let t=nx(this.apiClient,e);return l=tp("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=nw(e),n=new ty;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=nN(this.apiClient,e);return l=tp("{model}:streamGenerateContent?alt=sse",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.requestStream({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(function(e){return nv(this,arguments,function*(){var t,n,i,r;try{for(var l,o=!0,s=nE(e);!(t=(l=yield ny(s.next())).done);o=!0){r=l.value,o=!1;let e=nR((yield ny(r.json())));e.sdkHttpResponse={headers:r.headers};let t=new ty;Object.assign(t,e),yield yield ny(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=s.return)&&(yield ny(i.call(s)))}finally{if(n)throw n.error}}})})}{let t=nx(this.apiClient,e);return l=tp("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(function(e){return nv(this,arguments,function*(){var t,n,i,r;try{for(var l,o=!0,s=nE(e);!(t=(l=yield ny(s.next())).done);o=!0){r=l.value,o=!1;let e=nw((yield ny(r.json())));e.sdkHttpResponse={headers:r.headers};let t=new ty;Object.assign(t,e),yield yield ny(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=s.return)&&(yield ny(i.call(s)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n,i,r,l,o,s={},a=th(t,["model"]);null!=a&&tc(s,["_url","model"],tB(e,a));let u=th(t,["contents"]);if(null!=u){let t=t2(e,u);Array.isArray(t)&&(t=t.map(e=>e)),tc(s,["instances[]","content"],t)}let d=th(t,["config"]);return null!=d&&(n=th(d,["taskType"]),void 0!==s&&null!=n&&tc(s,["instances[]","task_type"],n),i=th(d,["title"]),void 0!==s&&null!=i&&tc(s,["instances[]","title"],i),r=th(d,["outputDimensionality"]),void 0!==s&&null!=r&&tc(s,["parameters","outputDimensionality"],r),l=th(d,["mimeType"]),void 0!==s&&null!=l&&tc(s,["instances[]","mimeType"],l),o=th(d,["autoTruncate"]),void 0!==s&&null!=o&&tc(s,["parameters","autoTruncate"],o)),s}(this.apiClient,e);return l=tp("{model}:predict",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s;return n={},null!=(i=th(e,["values"]))&&tc(n,["values"],i),null!=(r=th(e,["statistics"]))&&tc(n,["statistics"],(l={},null!=(o=th(t=r,["truncated"]))&&tc(l,["truncated"],o),null!=(s=th(t,["token_count"]))&&tc(l,["tokenCount"],s),l)),n})),tc(t,["embeddings"],e)}let r=th(e,["metadata"]);return null!=r&&tc(t,["metadata"],r),t}(e),n=new tv;return Object.assign(n,t),n})}{let t=function(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let t=t2(e,r);Array.isArray(t)&&(t=t.map(e=>e)),tc(n,["requests[]","content"],t)}let l=th(t,["config"]);null!=l&&function(e,t){let n=th(e,["taskType"]);void 0!==t&&null!=n&&tc(t,["requests[]","taskType"],n);let i=th(e,["title"]);void 0!==t&&null!=i&&tc(t,["requests[]","title"],i);let r=th(e,["outputDimensionality"]);if(void 0!==t&&null!=r&&tc(t,["requests[]","outputDimensionality"],r),void 0!==th(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==th(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(l,n);let o=th(t,["model"]);return void 0!==o&&tc(n,["requests[]","model"],tB(e,o)),n}(this.apiClient,e);return l=tp("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["embeddings"],e)}let r=th(e,["metadata"]);return null!=r&&tc(t,["metadata"],r),t}(e),n=new tv;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o,u,d,p,c,h,f,m,g,y,v,E,b,_,I,A,T,S,C,O=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["_url","model"],tB(l,r)),null!=(o=th(e,["prompt"]))&&tc(i,["instances[0]","prompt"],o),null!=(u=th(e,["config"]))&&(d=th(u,["outputGcsUri"]),void 0!==i&&null!=d&&tc(i,["parameters","storageUri"],d),p=th(u,["negativePrompt"]),void 0!==i&&null!=p&&tc(i,["parameters","negativePrompt"],p),c=th(u,["numberOfImages"]),void 0!==i&&null!=c&&tc(i,["parameters","sampleCount"],c),h=th(u,["aspectRatio"]),void 0!==i&&null!=h&&tc(i,["parameters","aspectRatio"],h),f=th(u,["guidanceScale"]),void 0!==i&&null!=f&&tc(i,["parameters","guidanceScale"],f),m=th(u,["seed"]),void 0!==i&&null!=m&&tc(i,["parameters","seed"],m),g=th(u,["safetyFilterLevel"]),void 0!==i&&null!=g&&tc(i,["parameters","safetySetting"],g),y=th(u,["personGeneration"]),void 0!==i&&null!=y&&tc(i,["parameters","personGeneration"],y),v=th(u,["includeSafetyAttributes"]),void 0!==i&&null!=v&&tc(i,["parameters","includeSafetyAttributes"],v),E=th(u,["includeRaiReason"]),void 0!==i&&null!=E&&tc(i,["parameters","includeRaiReason"],E),b=th(u,["language"]),void 0!==i&&null!=b&&tc(i,["parameters","language"],b),_=th(u,["outputMimeType"]),void 0!==i&&null!=_&&tc(i,["parameters","outputOptions","mimeType"],_),I=th(u,["outputCompressionQuality"]),void 0!==i&&null!=I&&tc(i,["parameters","outputOptions","compressionQuality"],I),A=th(u,["addWatermark"]),void 0!==i&&null!=A&&tc(i,["parameters","addWatermark"],A),T=th(u,["labels"]),void 0!==i&&null!=T&&tc(i,["labels"],T),S=th(u,["imageSize"]),void 0!==i&&null!=S&&tc(i,["parameters","sampleImageSize"],S),C=th(u,["enhancePrompt"]),void 0!==i&&null!=C&&tc(i,["parameters","enhancePrompt"],C)),i);return s=tp("{model}:predict",O._url),a=O._query,delete O._url,delete O._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(O),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nP(e))),tc(t,["generatedImages"],e)}let r=th(e,["positivePromptSafetyAttributes"]);return null!=r&&tc(t,["positivePromptSafetyAttributes"],nL(r)),t}(e),n=new tE;return Object.assign(n,t),n})}{let t,n,l,u,d=(o=this.apiClient,t={},null!=(n=th(e,["model"]))&&tc(t,["_url","model"],tB(o,n)),null!=(l=th(e,["prompt"]))&&tc(t,["instances[0]","prompt"],l),null!=(u=th(e,["config"]))&&function(e,t){if(void 0!==th(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==th(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let n=th(e,["numberOfImages"]);void 0!==t&&null!=n&&tc(t,["parameters","sampleCount"],n);let i=th(e,["aspectRatio"]);void 0!==t&&null!=i&&tc(t,["parameters","aspectRatio"],i);let r=th(e,["guidanceScale"]);if(void 0!==t&&null!=r&&tc(t,["parameters","guidanceScale"],r),void 0!==th(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let l=th(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&tc(t,["parameters","safetySetting"],l);let o=th(e,["personGeneration"]);void 0!==t&&null!=o&&tc(t,["parameters","personGeneration"],o);let s=th(e,["includeSafetyAttributes"]);void 0!==t&&null!=s&&tc(t,["parameters","includeSafetyAttributes"],s);let a=th(e,["includeRaiReason"]);void 0!==t&&null!=a&&tc(t,["parameters","includeRaiReason"],a);let u=th(e,["language"]);void 0!==t&&null!=u&&tc(t,["parameters","language"],u);let d=th(e,["outputMimeType"]);void 0!==t&&null!=d&&tc(t,["parameters","outputOptions","mimeType"],d);let p=th(e,["outputCompressionQuality"]);if(void 0!==t&&null!=p&&tc(t,["parameters","outputOptions","compressionQuality"],p),void 0!==th(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==th(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let c=th(e,["imageSize"]);if(void 0!==t&&null!=c&&tc(t,["parameters","sampleImageSize"],c),void 0!==th(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(u,t),t);return s=tp("{model}:predict",d._url),a=d._query,delete d._url,delete d._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t,n;let i,r,l,o,s,a,u;return i={},null!=(r=th(t=e,["_self"]))&&tc(i,["image"],(l={},null!=(o=th(n=r,["bytesBase64Encoded"]))&&tc(l,["imageBytes"],tf(o)),null!=(s=th(n,["mimeType"]))&&tc(l,["mimeType"],s),l)),null!=(a=th(t,["raiFilteredReason"]))&&tc(i,["raiFilteredReason"],a),null!=(u=th(t,["_self"]))&&tc(i,["safetyAttributes"],nq(u)),i})),tc(t,["generatedImages"],e)}let r=th(e,["positivePromptSafetyAttributes"]);return null!=r&&tc(t,["positivePromptSafetyAttributes"],nq(r)),t}(e),n=new tE;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n,i,r,l,o,s,a,u,d,p,c,h,f,m,g,y,v,E={},b=th(t,["model"]);null!=b&&tc(E,["_url","model"],tB(e,b));let _=th(t,["prompt"]);null!=_&&tc(E,["instances[0]","prompt"],_);let I=th(t,["referenceImages"]);if(null!=I){let e=I;Array.isArray(e)&&(e=e.map(e=>(function(e){let t,n,i,r,l,o,s,a={},u=th(e,["referenceImage"]);null!=u&&tc(a,["referenceImage"],nD(u));let d=th(e,["referenceId"]);null!=d&&tc(a,["referenceId"],d);let p=th(e,["referenceType"]);null!=p&&tc(a,["referenceType"],p);let c=th(e,["maskImageConfig"]);null!=c&&tc(a,["maskImageConfig"],(t={},null!=(n=th(c,["maskMode"]))&&tc(t,["maskMode"],n),null!=(i=th(c,["segmentationClasses"]))&&tc(t,["maskClasses"],i),null!=(r=th(c,["maskDilation"]))&&tc(t,["dilation"],r),t));let h=th(e,["controlImageConfig"]);null!=h&&tc(a,["controlImageConfig"],(l={},null!=(o=th(h,["controlType"]))&&tc(l,["controlType"],o),null!=(s=th(h,["enableControlImageComputation"]))&&tc(l,["computeControl"],s),l));let f=th(e,["styleImageConfig"]);null!=f&&tc(a,["styleImageConfig"],f);let m=th(e,["subjectImageConfig"]);return null!=m&&tc(a,["subjectImageConfig"],m),a})(e))),tc(E,["instances[0]","referenceImages"],e)}let A=th(t,["config"]);return null!=A&&(n=th(A,["outputGcsUri"]),void 0!==E&&null!=n&&tc(E,["parameters","storageUri"],n),i=th(A,["negativePrompt"]),void 0!==E&&null!=i&&tc(E,["parameters","negativePrompt"],i),r=th(A,["numberOfImages"]),void 0!==E&&null!=r&&tc(E,["parameters","sampleCount"],r),l=th(A,["aspectRatio"]),void 0!==E&&null!=l&&tc(E,["parameters","aspectRatio"],l),o=th(A,["guidanceScale"]),void 0!==E&&null!=o&&tc(E,["parameters","guidanceScale"],o),s=th(A,["seed"]),void 0!==E&&null!=s&&tc(E,["parameters","seed"],s),a=th(A,["safetyFilterLevel"]),void 0!==E&&null!=a&&tc(E,["parameters","safetySetting"],a),u=th(A,["personGeneration"]),void 0!==E&&null!=u&&tc(E,["parameters","personGeneration"],u),d=th(A,["includeSafetyAttributes"]),void 0!==E&&null!=d&&tc(E,["parameters","includeSafetyAttributes"],d),p=th(A,["includeRaiReason"]),void 0!==E&&null!=p&&tc(E,["parameters","includeRaiReason"],p),c=th(A,["language"]),void 0!==E&&null!=c&&tc(E,["parameters","language"],c),h=th(A,["outputMimeType"]),void 0!==E&&null!=h&&tc(E,["parameters","outputOptions","mimeType"],h),f=th(A,["outputCompressionQuality"]),void 0!==E&&null!=f&&tc(E,["parameters","outputOptions","compressionQuality"],f),m=th(A,["addWatermark"]),void 0!==E&&null!=m&&tc(E,["parameters","addWatermark"],m),g=th(A,["labels"]),void 0!==E&&null!=g&&tc(E,["labels"],g),y=th(A,["editMode"]),void 0!==E&&null!=y&&tc(E,["parameters","editMode"],y),v=th(A,["baseSteps"]),void 0!==E&&null!=v&&tc(E,["parameters","editConfig","baseSteps"],v)),E}(this.apiClient,e);return i=tp("{model}:predict",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nP(e))),tc(t,["generatedImages"],e)}return t}(e),n=new tb;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n,i;let r="",l={};if(this.apiClient.isVertexAI()){let o,s,a,u,d,p,c,h,f,m,g,y,v,E,b,_,I=(i=this.apiClient,o={},null!=(s=th(e,["model"]))&&tc(o,["_url","model"],tB(i,s)),null!=(a=th(e,["image"]))&&tc(o,["instances[0]","image"],nD(a)),null!=(u=th(e,["upscaleFactor"]))&&tc(o,["parameters","upscaleConfig","upscaleFactor"],u),null!=(d=th(e,["config"]))&&(p=th(d,["outputGcsUri"]),void 0!==o&&null!=p&&tc(o,["parameters","storageUri"],p),c=th(d,["safetyFilterLevel"]),void 0!==o&&null!=c&&tc(o,["parameters","safetySetting"],c),h=th(d,["personGeneration"]),void 0!==o&&null!=h&&tc(o,["parameters","personGeneration"],h),f=th(d,["includeRaiReason"]),void 0!==o&&null!=f&&tc(o,["parameters","includeRaiReason"],f),m=th(d,["outputMimeType"]),void 0!==o&&null!=m&&tc(o,["parameters","outputOptions","mimeType"],m),g=th(d,["outputCompressionQuality"]),void 0!==o&&null!=g&&tc(o,["parameters","outputOptions","compressionQuality"],g),y=th(d,["enhanceInputImage"]),void 0!==o&&null!=y&&tc(o,["parameters","upscaleConfig","enhanceInputImage"],y),v=th(d,["imagePreservationFactor"]),void 0!==o&&null!=v&&tc(o,["parameters","upscaleConfig","imagePreservationFactor"],v),E=th(d,["labels"]),void 0!==o&&null!=E&&tc(o,["labels"],E),b=th(d,["numberOfImages"]),void 0!==o&&null!=b&&tc(o,["parameters","sampleCount"],b),_=th(d,["mode"]),void 0!==o&&null!=_&&tc(o,["parameters","mode"],_)),o);return r=tp("{model}:predict",I._url),l=I._query,delete I._url,delete I._query,this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(I),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nP(e))),tc(t,["generatedImages"],e)}return t}(e),n=new t_;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n,i;let r="",l={};if(this.apiClient.isVertexAI()){let o,s,a,u,d,p,c,h,f,m,g,y,v,E,b,_=(i=this.apiClient,o={},null!=(s=th(e,["model"]))&&tc(o,["_url","model"],tB(i,s)),null!=(a=th(e,["source"]))&&function(e,t){let n=th(e,["prompt"]);void 0!==t&&null!=n&&tc(t,["instances[0]","prompt"],n);let i=th(e,["personImage"]);void 0!==t&&null!=i&&tc(t,["instances[0]","personImage","image"],nD(i));let r=th(e,["productImages"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>{let t,n;return t={},null!=(n=th(e,["productImage"]))&&tc(t,["image"],nD(n)),t})),tc(t,["instances[0]","productImages"],e)}}(a,o),null!=(u=th(e,["config"]))&&(d=th(u,["numberOfImages"]),void 0!==o&&null!=d&&tc(o,["parameters","sampleCount"],d),p=th(u,["baseSteps"]),void 0!==o&&null!=p&&tc(o,["parameters","baseSteps"],p),c=th(u,["outputGcsUri"]),void 0!==o&&null!=c&&tc(o,["parameters","storageUri"],c),h=th(u,["seed"]),void 0!==o&&null!=h&&tc(o,["parameters","seed"],h),f=th(u,["safetyFilterLevel"]),void 0!==o&&null!=f&&tc(o,["parameters","safetySetting"],f),m=th(u,["personGeneration"]),void 0!==o&&null!=m&&tc(o,["parameters","personGeneration"],m),g=th(u,["addWatermark"]),void 0!==o&&null!=g&&tc(o,["parameters","addWatermark"],g),y=th(u,["outputMimeType"]),void 0!==o&&null!=y&&tc(o,["parameters","outputOptions","mimeType"],y),v=th(u,["outputCompressionQuality"]),void 0!==o&&null!=v&&tc(o,["parameters","outputOptions","compressionQuality"],v),E=th(u,["enhancePrompt"]),void 0!==o&&null!=E&&tc(o,["parameters","enhancePrompt"],E),b=th(u,["labels"]),void 0!==o&&null!=b&&tc(o,["labels"],b)),o);return r=tp("{model}:predict",_._url),l=_._query,delete _._url,delete _._query,this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(_),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=th(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>nP(e))),tc(t,["generatedImages"],e)}return t}(e),n=new tI;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n,i,r,l;let o="",s={};if(this.apiClient.isVertexAI()){let a,u,d,p,c,h,f,m,g,y,v,E,b,_,I,A=(i=this.apiClient,h={},null!=(f=th(e,["model"]))&&tc(h,["_url","model"],tB(i,f)),null!=(m=th(e,["source"]))&&(r=m,l=h,d=th(r,["prompt"]),void 0!==l&&null!=d&&tc(l,["instances[0]","prompt"],d),p=th(r,["image"]),void 0!==l&&null!=p&&tc(l,["instances[0]","image"],nD(p)),c=th(r,["scribbleImage"]),void 0!==l&&null!=c&&tc(l,["instances[0]","scribble"],(a={},null!=(u=th(c,["image"]))&&tc(a,["image"],nD(u)),a))),null!=(g=th(e,["config"]))&&(y=th(g,["mode"]),void 0!==h&&null!=y&&tc(h,["parameters","mode"],y),v=th(g,["maxPredictions"]),void 0!==h&&null!=v&&tc(h,["parameters","maxPredictions"],v),E=th(g,["confidenceThreshold"]),void 0!==h&&null!=E&&tc(h,["parameters","confidenceThreshold"],E),b=th(g,["maskDilation"]),void 0!==h&&null!=b&&tc(h,["parameters","maskDilation"],b),_=th(g,["binaryColorThreshold"]),void 0!==h&&null!=_&&tc(h,["parameters","binaryColorThreshold"],_),I=th(g,["labels"]),void 0!==h&&null!=I&&tc(h,["labels"],I)),h);return o=tp("{model}:predict",A._url),s=A._query,delete A._url,delete A._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(A),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=th(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["_self"]);null!=n&&tc(t,["mask"],nj(n));let i=th(e,["labels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["labels"],e)}return t})(e))),tc(t,["generatedMasks"],e)}return t}(e),n=new tA;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["_url","name"],tB(l,r)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nU(e))}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["model"]))&&tc(t,["_url","name"],tB(o,n)),t);return s=tp("{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>nk(e))}}async listInternal(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o,u,d,p,c=(l=this.apiClient,i={},null!=(r=th(e,["config"]))&&(o=th(r,["pageSize"]),void 0!==i&&null!=o&&tc(i,["_query","pageSize"],o),u=th(r,["pageToken"]),void 0!==i&&null!=u&&tc(i,["_query","pageToken"],u),d=th(r,["filter"]),void 0!==i&&null!=d&&tc(i,["_query","filter"],d),p=th(r,["queryBase"]),void 0!==i&&null!=p&&tc(i,["_url","models_url"],nn(l,p))),i);return s=tp("{models_url}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["_self"]);if(null!=r){let e=ni(r);Array.isArray(e)&&(e=e.map(e=>nU(e))),tc(t,["models"],e)}return t}(e),n=new tT;return Object.assign(n,t),n})}{let t,n,l,u,d,p,c=(o=this.apiClient,t={},null!=(n=th(e,["config"]))&&(l=th(n,["pageSize"]),void 0!==t&&null!=l&&tc(t,["_query","pageSize"],l),u=th(n,["pageToken"]),void 0!==t&&null!=u&&tc(t,["_query","pageToken"],u),d=th(n,["filter"]),void 0!==t&&null!=d&&tc(t,["_query","filter"],d),p=th(n,["queryBase"]),void 0!==t&&null!=p&&tc(t,["_url","models_url"],nn(o,p))),t);return s=tp("{models_url}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["_self"]);if(null!=r){let e=ni(r);Array.isArray(e)&&(e=e.map(e=>nk(e))),tc(t,["models"],e)}return t}(e),n=new tT;return Object.assign(n,t),n})}}async update(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o,u,d,p,c=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["_url","model"],tB(l,r)),null!=(o=th(e,["config"]))&&(u=th(o,["displayName"]),void 0!==i&&null!=u&&tc(i,["displayName"],u),d=th(o,["description"]),void 0!==i&&null!=d&&tc(i,["description"],d),p=th(o,["defaultCheckpointId"]),void 0!==i&&null!=p&&tc(i,["defaultCheckpointId"],p)),i);return s=tp("{model}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nU(e))}{let t,n,l,u,d,p,c=(o=this.apiClient,t={},null!=(n=th(e,["model"]))&&tc(t,["_url","name"],tB(o,n)),null!=(l=th(e,["config"]))&&(u=th(l,["displayName"]),void 0!==t&&null!=u&&tc(t,["displayName"],u),d=th(l,["description"]),void 0!==t&&null!=d&&tc(t,["description"],d),p=th(l,["defaultCheckpointId"]),void 0!==t&&null!=p&&tc(t,["defaultCheckpointId"],p)),t);return s=tp("{name}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>nk(e))}}async delete(e){var t,n,i,r,l,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,r,o=(l=this.apiClient,i={},null!=(r=th(e,["model"]))&&tc(i,["_url","name"],tB(l,r)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tS;return Object.assign(r,i),r})}{let t,n,l=(o=this.apiClient,t={},null!=(n=th(e,["model"]))&&tc(t,["_url","name"],tB(o,n)),t);return s=tp("{name}",l._url),a=l._query,delete l._url,delete l._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tS;return Object.assign(r,i),r})}}async countTokens(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>e)),tc(n,["contents"],e)}let l=th(t,["config"]);return null!=l&&function(e,t){let n=th(e,["systemInstruction"]);void 0!==t&&null!=n&&tc(t,["systemInstruction"],t1(n));let i=th(e,["tools"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nG(e))),tc(t,["tools"],e)}let r=th(e,["generationConfig"]);void 0!==t&&null!=r&&tc(t,["generationConfig"],function(e){let t={},n=th(e,["modelSelectionConfig"]);null!=n&&tc(t,["modelConfig"],n);let i=th(e,["responseJsonSchema"]);null!=i&&tc(t,["responseJsonSchema"],i);let r=th(e,["audioTimestamp"]);null!=r&&tc(t,["audioTimestamp"],r);let l=th(e,["candidateCount"]);null!=l&&tc(t,["candidateCount"],l);let o=th(e,["enableAffectiveDialog"]);null!=o&&tc(t,["enableAffectiveDialog"],o);let s=th(e,["frequencyPenalty"]);null!=s&&tc(t,["frequencyPenalty"],s);let a=th(e,["logprobs"]);null!=a&&tc(t,["logprobs"],a);let u=th(e,["maxOutputTokens"]);null!=u&&tc(t,["maxOutputTokens"],u);let d=th(e,["mediaResolution"]);null!=d&&tc(t,["mediaResolution"],d);let p=th(e,["presencePenalty"]);null!=p&&tc(t,["presencePenalty"],p);let c=th(e,["responseLogprobs"]);null!=c&&tc(t,["responseLogprobs"],c);let h=th(e,["responseMimeType"]);null!=h&&tc(t,["responseMimeType"],h);let f=th(e,["responseModalities"]);null!=f&&tc(t,["responseModalities"],f);let m=th(e,["responseSchema"]);null!=m&&tc(t,["responseSchema"],m);let g=th(e,["routingConfig"]);null!=g&&tc(t,["routingConfig"],g);let y=th(e,["seed"]);null!=y&&tc(t,["seed"],y);let v=th(e,["speechConfig"]);null!=v&&tc(t,["speechConfig"],v);let E=th(e,["stopSequences"]);null!=E&&tc(t,["stopSequences"],E);let b=th(e,["temperature"]);null!=b&&tc(t,["temperature"],b);let _=th(e,["thinkingConfig"]);null!=_&&tc(t,["thinkingConfig"],_);let I=th(e,["topK"]);null!=I&&tc(t,["topK"],I);let A=th(e,["topP"]);if(null!=A&&tc(t,["topP"],A),void 0!==th(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(r))}(l,n),n}(this.apiClient,e);return l=tp("{model}:countTokens",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,r=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),null!=(i=th(e,["totalTokens"]))&&tc(t,["totalTokens"],i),t),l=new tC;return Object.assign(l,r),l})}{let t=function(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>nO(e))),tc(n,["contents"],e)}let l=th(t,["config"]);return null!=l&&function(e){if(void 0!==th(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==th(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==th(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(l),n}(this.apiClient,e);return l=tp("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,r,l=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),null!=(i=th(e,["totalTokens"]))&&tc(t,["totalTokens"],i),null!=(r=th(e,["cachedContentTokenCount"]))&&tc(t,["cachedContentTokenCount"],r),t),o=new tC;return Object.assign(o,l),o})}}async computeTokens(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=th(t,["model"]);null!=i&&tc(n,["_url","model"],tB(e,i));let r=th(t,["contents"]);if(null!=r){let e=t6(r);Array.isArray(e)&&(e=e.map(e=>e)),tc(n,["contents"],e)}return n}(this.apiClient,e);return i=tp("{model}:computeTokens",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["tokensInfo"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["tokensInfo"],e)}return t}(e),n=new tO;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,r,l,o,s,a,u,d;let p="",c={};if(this.apiClient.isVertexAI()){let i,r,o,u,d,h,f,m,g,y,v=(l=this.apiClient,u={},null!=(d=th(e,["model"]))&&tc(u,["_url","model"],tB(l,d)),null!=(h=th(e,["prompt"]))&&tc(u,["instances[0]","prompt"],h),null!=(f=th(e,["image"]))&&tc(u,["instances[0]","image"],nD(f)),null!=(m=th(e,["video"]))&&tc(u,["instances[0]","video"],nF(m)),null!=(g=th(e,["source"]))&&(s=g,a=u,i=th(s,["prompt"]),void 0!==a&&null!=i&&tc(a,["instances[0]","prompt"],i),r=th(s,["image"]),void 0!==a&&null!=r&&tc(a,["instances[0]","image"],nD(r)),o=th(s,["video"]),void 0!==a&&null!=o&&tc(a,["instances[0]","video"],nF(o))),null!=(y=th(e,["config"]))&&function(e,t){var n;let i,r,l,o=th(e,["numberOfVideos"]);void 0!==t&&null!=o&&tc(t,["parameters","sampleCount"],o);let s=th(e,["outputGcsUri"]);void 0!==t&&null!=s&&tc(t,["parameters","storageUri"],s);let a=th(e,["fps"]);void 0!==t&&null!=a&&tc(t,["parameters","fps"],a);let u=th(e,["durationSeconds"]);void 0!==t&&null!=u&&tc(t,["parameters","durationSeconds"],u);let d=th(e,["seed"]);void 0!==t&&null!=d&&tc(t,["parameters","seed"],d);let p=th(e,["aspectRatio"]);void 0!==t&&null!=p&&tc(t,["parameters","aspectRatio"],p);let c=th(e,["resolution"]);void 0!==t&&null!=c&&tc(t,["parameters","resolution"],c);let h=th(e,["personGeneration"]);void 0!==t&&null!=h&&tc(t,["parameters","personGeneration"],h);let f=th(e,["pubsubTopic"]);void 0!==t&&null!=f&&tc(t,["parameters","pubsubTopic"],f);let m=th(e,["negativePrompt"]);void 0!==t&&null!=m&&tc(t,["parameters","negativePrompt"],m);let g=th(e,["enhancePrompt"]);void 0!==t&&null!=g&&tc(t,["parameters","enhancePrompt"],g);let y=th(e,["generateAudio"]);void 0!==t&&null!=y&&tc(t,["parameters","generateAudio"],y);let v=th(e,["lastFrame"]);void 0!==t&&null!=v&&tc(t,["instances[0]","lastFrame"],nD(v));let E=th(e,["referenceImages"]);if(void 0!==t&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r;return n={},null!=(i=th(t=e,["image"]))&&tc(n,["image"],nD(i)),null!=(r=th(t,["referenceType"]))&&tc(n,["referenceType"],r),n})),tc(t,["instances[0]","referenceImages"],e)}let b=th(e,["mask"]);void 0!==t&&null!=b&&tc(t,["instances[0]","mask"],(i={},null!=(r=th(n=b,["image"]))&&tc(i,["_self"],nD(r)),null!=(l=th(n,["maskMode"]))&&tc(i,["maskMode"],l),i));let _=th(e,["compressionQuality"]);void 0!==t&&null!=_&&tc(t,["parameters","compressionQuality"],_)}(y,u),u);return p=tp("{model}:predictLongRunning",v._url),c=v._query,delete v._url,delete v._query,this.apiClient.request({path:p,queryParams:c,body:JSON.stringify(v),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,r,l,o,s=(t={},null!=(n=th(e,["name"]))&&tc(t,["name"],n),null!=(i=th(e,["metadata"]))&&tc(t,["metadata"],i),null!=(r=th(e,["done"]))&&tc(t,["done"],r),null!=(l=th(e,["error"]))&&tc(t,["error"],l),null!=(o=th(e,["response"]))&&tc(t,["response"],function(e){let t={},n=th(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s;return n={},null!=(i=th(e,["_self"]))&&tc(n,["video"],(r={},null!=(l=th(t=i,["gcsUri"]))&&tc(r,["uri"],l),null!=(o=th(t,["bytesBase64Encoded"]))&&tc(r,["videoBytes"],tf(o)),null!=(s=th(t,["mimeType"]))&&tc(r,["mimeType"],s),r)),n})),tc(t,["generatedVideos"],e)}let i=th(e,["raiMediaFilteredCount"]);null!=i&&tc(t,["raiMediaFilteredCount"],i);let r=th(e,["raiMediaFilteredReasons"]);return null!=r&&tc(t,["raiMediaFilteredReasons"],r),t}(o)),t),a=new tx;return Object.assign(a,s),a})}{let t,n,l,s,a,h,f,m,g,y,v=(o=this.apiClient,s={},null!=(a=th(e,["model"]))&&tc(s,["_url","model"],tB(o,a)),null!=(h=th(e,["prompt"]))&&tc(s,["instances[0]","prompt"],h),null!=(f=th(e,["image"]))&&tc(s,["instances[0]","image"],nM(f)),null!=(m=th(e,["video"]))&&tc(s,["instances[0]","video"],nH(m)),null!=(g=th(e,["source"]))&&(u=g,d=s,t=th(u,["prompt"]),void 0!==d&&null!=t&&tc(d,["instances[0]","prompt"],t),n=th(u,["image"]),void 0!==d&&null!=n&&tc(d,["instances[0]","image"],nM(n)),l=th(u,["video"]),void 0!==d&&null!=l&&tc(d,["instances[0]","video"],nH(l))),null!=(y=th(e,["config"]))&&function(e,t){let n=th(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&tc(t,["parameters","sampleCount"],n),void 0!==th(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==th(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let i=th(e,["durationSeconds"]);if(void 0!==t&&null!=i&&tc(t,["parameters","durationSeconds"],i),void 0!==th(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let r=th(e,["aspectRatio"]);void 0!==t&&null!=r&&tc(t,["parameters","aspectRatio"],r);let l=th(e,["resolution"]);void 0!==t&&null!=l&&tc(t,["parameters","resolution"],l);let o=th(e,["personGeneration"]);if(void 0!==t&&null!=o&&tc(t,["parameters","personGeneration"],o),void 0!==th(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let s=th(e,["negativePrompt"]);void 0!==t&&null!=s&&tc(t,["parameters","negativePrompt"],s);let a=th(e,["enhancePrompt"]);if(void 0!==t&&null!=a&&tc(t,["parameters","enhancePrompt"],a),void 0!==th(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let u=th(e,["lastFrame"]);void 0!==t&&null!=u&&tc(t,["instances[0]","lastFrame"],nM(u));let d=th(e,["referenceImages"]);if(void 0!==t&&null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r;return n={},null!=(i=th(t=e,["image"]))&&tc(n,["image"],nM(i)),null!=(r=th(t,["referenceType"]))&&tc(n,["referenceType"],r),n})),tc(t,["instances[0]","referenceImages"],e)}if(void 0!==th(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==th(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(y,s),s);return p=tp("{model}:predictLongRunning",v._url),c=v._query,delete v._url,delete v._query,this.apiClient.request({path:p,queryParams:c,body:JSON.stringify(v),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,r,l,o,s=(t={},null!=(n=th(e,["name"]))&&tc(t,["name"],n),null!=(i=th(e,["metadata"]))&&tc(t,["metadata"],i),null!=(r=th(e,["done"]))&&tc(t,["done"],r),null!=(l=th(e,["error"]))&&tc(t,["error"],l),null!=(o=th(e,["response","generateVideoResponse"]))&&tc(t,["response"],function(e){let t={},n=th(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s;return n={},null!=(i=th(e,["video"]))&&tc(n,["video"],(r={},null!=(l=th(t=i,["uri"]))&&tc(r,["uri"],l),null!=(o=th(t,["encodedVideo"]))&&tc(r,["videoBytes"],tf(o)),null!=(s=th(t,["encoding"]))&&tc(r,["mimeType"],s),r)),n})),tc(t,["generatedVideos"],e)}let i=th(e,["raiMediaFilteredCount"]);null!=i&&tc(t,["raiMediaFilteredCount"],i);let r=th(e,["raiMediaFilteredReasons"]);return null!=r&&tc(t,["raiMediaFilteredReasons"],r),t}(o)),t),a=new tx;return Object.assign(a,s),a})}}}class n9 extends td{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let r=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let r=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s=(i={},null!=(r=th(e,["operationName"]))&&tc(i,["_url","operationName"],r),i);return l=tp("{operationName}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}{let t,n,s=(t={},null!=(n=th(e,["operationName"]))&&tc(t,["_url","operationName"],n),t);return l=tp("{operationName}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l,o,s,a=(l={},null!=(o=th(e,["operationName"]))&&tc(l,["operationName"],o),null!=(s=th(e,["resourceName"]))&&tc(l,["_url","resourceName"],s),l);return i=tp("{resourceName}:fetchPredictOperation",a._url),r=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}class n7 extends td{constructor(e){super(),this.apiClient=e}async create(e){var t,n,i,r,l;let o="",s={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let a,u,d,p,c,h,f,m,g,y,v=(i=this.apiClient,p={},null!=(c=th(e,["config"]))&&tc(p,["config"],(h=th(c,["expireTime"]),void 0!==p&&null!=h&&tc(p,["expireTime"],h),f=th(c,["newSessionExpireTime"]),void 0!==p&&null!=f&&tc(p,["newSessionExpireTime"],f),m=th(c,["uses"]),void 0!==p&&null!=m&&tc(p,["uses"],m),g=th(c,["liveConnectConstraints"]),void 0!==p&&null!=g&&tc(p,["bidiGenerateContentSetup"],(r=i,a={},null!=(u=th(l=g,["model"]))&&tc(a,["setup","model"],tB(r,u)),null!=(d=th(l,["config"]))&&tc(a,["config"],function(e,t){let n=th(e,["generationConfig"]);void 0!==t&&null!=n&&tc(t,["setup","generationConfig"],n);let i=th(e,["responseModalities"]);void 0!==t&&null!=i&&tc(t,["setup","generationConfig","responseModalities"],i);let r=th(e,["temperature"]);void 0!==t&&null!=r&&tc(t,["setup","generationConfig","temperature"],r);let l=th(e,["topP"]);void 0!==t&&null!=l&&tc(t,["setup","generationConfig","topP"],l);let o=th(e,["topK"]);void 0!==t&&null!=o&&tc(t,["setup","generationConfig","topK"],o);let s=th(e,["maxOutputTokens"]);void 0!==t&&null!=s&&tc(t,["setup","generationConfig","maxOutputTokens"],s);let a=th(e,["mediaResolution"]);void 0!==t&&null!=a&&tc(t,["setup","generationConfig","mediaResolution"],a);let u=th(e,["seed"]);void 0!==t&&null!=u&&tc(t,["setup","generationConfig","seed"],u);let d=th(e,["speechConfig"]);void 0!==t&&null!=d&&tc(t,["setup","generationConfig","speechConfig"],t5(d));let p=th(e,["thinkingConfig"]);void 0!==t&&null!=p&&tc(t,["setup","generationConfig","thinkingConfig"],p);let c=th(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&tc(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=th(e,["systemInstruction"]);void 0!==t&&null!=h&&tc(t,["setup","systemInstruction"],function(e){let t={},n=th(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c,h;return n={},null!=(i=th(t=e,["mediaResolution"]))&&tc(n,["mediaResolution"],i),null!=(r=th(t,["codeExecutionResult"]))&&tc(n,["codeExecutionResult"],r),null!=(l=th(t,["executableCode"]))&&tc(n,["executableCode"],l),null!=(o=th(t,["fileData"]))&&tc(n,["fileData"],function(e){let t={};if(void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=th(e,["fileUri"]);null!=n&&tc(t,["fileUri"],n);let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(o)),null!=(s=th(t,["functionCall"]))&&tc(n,["functionCall"],function(e){let t={},n=th(e,["id"]);null!=n&&tc(t,["id"],n);let i=th(e,["args"]);null!=i&&tc(t,["args"],i);let r=th(e,["name"]);if(null!=r&&tc(t,["name"],r),void 0!==th(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==th(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=th(t,["functionResponse"]))&&tc(n,["functionResponse"],a),null!=(u=th(t,["inlineData"]))&&tc(n,["inlineData"],function(e){let t={},n=th(e,["data"]);if(null!=n&&tc(t,["data"],n),void 0!==th(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=th(e,["mimeType"]);return null!=i&&tc(t,["mimeType"],i),t}(u)),null!=(d=th(t,["text"]))&&tc(n,["text"],d),null!=(p=th(t,["thought"]))&&tc(n,["thought"],p),null!=(c=th(t,["thoughtSignature"]))&&tc(n,["thoughtSignature"],c),null!=(h=th(t,["videoMetadata"]))&&tc(n,["videoMetadata"],h),n})),tc(t,["parts"],e)}let i=th(e,["role"]);return null!=i&&tc(t,["role"],i),t}(t1(h)));let f=th(e,["tools"]);if(void 0!==t&&null!=f){let e=t9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=th(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["functionDeclarations"],e)}if(void 0!==th(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=th(e,["googleSearchRetrieval"]);null!=i&&tc(t,["googleSearchRetrieval"],i);let r=th(e,["computerUse"]);null!=r&&tc(t,["computerUse"],r);let l=th(e,["fileSearch"]);null!=l&&tc(t,["fileSearch"],l);let o=th(e,["codeExecution"]);if(null!=o&&tc(t,["codeExecution"],o),void 0!==th(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=th(e,["googleMaps"]);null!=s&&tc(t,["googleMaps"],function(e){let t={};if(void 0!==th(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=th(e,["enableWidget"]);return null!=n&&tc(t,["enableWidget"],n),t}(s));let a=th(e,["googleSearch"]);null!=a&&tc(t,["googleSearch"],function(e){let t={};if(void 0!==th(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==th(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=th(e,["timeRangeFilter"]);return null!=n&&tc(t,["timeRangeFilter"],n),t}(a));let u=th(e,["urlContext"]);return null!=u&&tc(t,["urlContext"],u),t})(t8(e)))),tc(t,["setup","tools"],e)}let m=th(e,["sessionResumption"]);void 0!==t&&null!=m&&tc(t,["setup","sessionResumption"],function(e){let t={},n=th(e,["handle"]);if(null!=n&&tc(t,["handle"],n),void 0!==th(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=th(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&tc(t,["setup","inputAudioTranscription"],g);let y=th(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&tc(t,["setup","outputAudioTranscription"],y);let v=th(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&tc(t,["setup","realtimeInputConfig"],v);let E=th(e,["contextWindowCompression"]);void 0!==t&&null!=E&&tc(t,["setup","contextWindowCompression"],E);let b=th(e,["proactivity"]);if(void 0!==t&&null!=b&&tc(t,["setup","proactivity"],b),void 0!==th(e,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(d,a)),a)),y=th(c,["lockAdditionalFields"]),void 0!==p&&null!=y&&tc(p,["fieldMask"],y),{})),p);o=tp("auth_tokens",v._url),s=v._query,delete v.config,delete v._url,delete v._query;let E=function(e,t){let n=null,i=e.bidiGenerateContentSetup;if("object"==typeof i&&null!==i&&"setup"in i){let t=i.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==i&&delete e.bidiGenerateContentSetup;let r=e.fieldMask;if(n){let i=function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n];if("object"==typeof i&&null!=i&&Object.keys(i).length>0){let e=Object.keys(i).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)i?e.fieldMask=i:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==r&&Array.isArray(r)&&r.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];r.length>0&&(n=r.map(e=>t.includes(e)?`generationConfig.${e}`:e));let l=[];i&&l.push(i),n.length>0&&l.push(...n),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==r&&Array.isArray(r)&&r.length>0?e.fieldMask=r.join(","):delete e.fieldMask;return e}(v,e.config);return this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(E),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}}class ie extends td{constructor(e){super(),this.apiClient=e,this.list=async e=>new nc(tt.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","name"],o),l);return i=tp("{name}",s._url),r=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","name"],o),null!=(s=th(e,["config"]))&&(a=th(s,["force"]),void 0!==l&&null!=a&&tc(l,["_query","force"],a)),l);i=tp("{name}",u._url),r=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u,d=(l={},null!=(o=th(e,["parent"]))&&tc(l,["_url","parent"],o),null!=(s=th(e,["config"]))&&(a=th(s,["pageSize"]),void 0!==l&&null!=a&&tc(l,["_query","pageSize"],a),u=th(s,["pageToken"]),void 0!==l&&null!=u&&tc(l,["_query","pageToken"],u)),l);return i=tp("{parent}/documents",d._url),r=d._query,delete d._url,delete d._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["documents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["documents"],e)}return t}(e),n=new tj;return Object.assign(n,t),n})}}}class it extends td{constructor(e,t=new ie(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new nc(tt.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a=(l={},null!=(o=th(e,["config"]))&&(s=th(o,["displayName"]),void 0!==l&&null!=s&&tc(l,["displayName"],s)),l);return i=tp("fileSearchStores",a._url),r=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","name"],o),l);return i=tp("{name}",s._url),r=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u=(l={},null!=(o=th(e,["name"]))&&tc(l,["_url","name"],o),null!=(s=th(e,["config"]))&&(a=th(s,["force"]),void 0!==l&&null!=a&&tc(l,["_query","force"],a)),l);i=tp("{name}",u._url),r=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u=(l={},null!=(o=th(e,["config"]))&&(s=th(o,["pageSize"]),void 0!==l&&null!=s&&tc(l,["_query","pageSize"],s),a=th(o,["pageToken"]),void 0!==l&&null!=a&&tc(l,["_query","pageToken"],a)),l);return i=tp("fileSearchStores",u._url),r=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=th(e,["sdkHttpResponse"]);null!=n&&tc(t,["sdkHttpResponse"],n);let i=th(e,["nextPageToken"]);null!=i&&tc(t,["nextPageToken"],i);let r=th(e,["fileSearchStores"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["fileSearchStores"],e)}return t}(e),n=new tM;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a=(l={},null!=(o=th(e,["fileSearchStoreName"]))&&tc(l,["_url","file_search_store_name"],o),null!=(s=th(e,["config"]))&&nV(s,l),l);return i=tp("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),r=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tD;return Object.assign(r,i),r})}}async importFile(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u=(l={},null!=(o=th(e,["fileSearchStoreName"]))&&tc(l,["_url","file_search_store_name"],o),null!=(s=th(e,["fileName"]))&&tc(l,["fileName"],s),null!=(a=th(e,["config"]))&&function(e,t){let n=th(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc(t,["customMetadata"],e)}let i=th(e,["chunkingConfig"]);void 0!==t&&null!=i&&tc(t,["chunkingConfig"],i)}(a,l),l);return i=tp("{file_search_store_name}:importFile",u._url),r=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{var t;let n,i,r,l,o,s,a,u,d,p,c=(o={},null!=(s=th(e,["name"]))&&tc(o,["name"],s),null!=(a=th(e,["metadata"]))&&tc(o,["metadata"],a),null!=(u=th(e,["done"]))&&tc(o,["done"],u),null!=(d=th(e,["error"]))&&tc(o,["error"],d),null!=(p=th(e,["response"]))&&tc(o,["response"],(n={},null!=(i=th(t=p,["sdkHttpResponse"]))&&tc(n,["sdkHttpResponse"],i),null!=(r=th(t,["parent"]))&&tc(n,["parent"],r),null!=(l=th(t,["documentName"]))&&tc(n,["documentName"],l),n)),o),h=new tk;return Object.assign(h,c),h})}}}let ii=function(){let{crypto:e}=globalThis;if(null==e?void 0:e.randomUUID)return ii=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^n()&15>>e/4).toString(16))};function ir(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let il=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(e){}try{return Error(JSON.stringify(e))}catch(e){}}return Error(e)};class io extends Error{}class is extends io{constructor(e,t,n,i){super(`${is.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,n){let i=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){return e&&i?400===e?new ip(e,t,n,i):401===e?new ic(e,t,n,i):403===e?new ih(e,t,n,i):404===e?new im(e,t,n,i):409===e?new ig(e,t,n,i):422===e?new iy(e,t,n,i):429===e?new iv(e,t,n,i):e>=500?new iE(e,t,n,i):new is(e,t,n,i):new iu({message:n,cause:il(t)})}}class ia extends is{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class iu extends is{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class id extends iu{constructor({message:e}={}){super({message:null!=e?e:"Request timed out."})}}class ip extends is{}class ic extends is{}class ih extends is{}class im extends is{}class ig extends is{}class iy extends is{}class iv extends is{}class iE extends is{}let ib=/^[a-z][a-z0-9+.-]*:/i,i_=e=>(i_=Array.isArray)(e),iI=i_,iA="0.0.1",iT=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",iS=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";function iC(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function iO(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function ix(e){var t,n;if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void await (null==(n=(t=e[Symbol.asyncIterator]()).return)?void 0:n.call(t));let i=e.getReader(),r=i.cancel();i.releaseLock(),await r}let iN=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),iw=()=>{var e;if("undefined"==typeof File){let{process:t}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null==(e=null==t?void 0:t.versions)?void 0:e.node)&&20>parseInt(t.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function iR(e,t,n){return iw(),new File(e,null!=t?t:"unknown_file",n)}let iP=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function ij(e,t,n){var i;let r,l;if(iw(),null!=(r=e=await e)&&"object"==typeof r&&"string"==typeof r.name&&"number"==typeof r.lastModified&&iP(r))return e instanceof File?e:iR([await e.arrayBuffer()],e.name);if(null!=(l=e)&&"object"==typeof l&&"string"==typeof l.url&&"function"==typeof l.blob){let i=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),iR(await iM(i),t,n)}let o=await iM(e);if(t||(t=("object"==typeof(i=e)&&null!==i&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0),!(null==n?void 0:n.type)){let e=o.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(n=Object.assign(Object.assign({},n),{type:e}))}return iR(o,t,n)}async function iM(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(iP(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator])try{for(var n,i,r,l,o,s,a=!0,u=nE(e);!(n=(s=await u.next()).done);a=!0)l=s.value,a=!1,t.push(...await iM(l))}catch(e){i={error:e}}finally{try{!a&&!n&&(r=u.return)&&await r.call(u)}finally{if(i)throw i.error}}else{let t=null==(o=null==e?void 0:e.constructor)?void 0:o.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class iD{constructor(e){this._client=e}}function ik(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}iD._key=[];let iU=Object.freeze(Object.create(null)),iq=((e=ik)=>function(t,...n){let i;if(1===t.length)return t[0];let r=!1,l=[],o=t.reduce((t,i,o)=>{var s,a,u;/[?#]/.test(i)&&(r=!0);let d=n[o],p=(r?encodeURIComponent:e)(""+d);return o!==n.length&&(null==d||"object"==typeof d&&d.toString===(null==(u=Object.getPrototypeOf(null!=(a=Object.getPrototypeOf(null!=(s=d.hasOwnProperty)?s:iU))?a:iU))?void 0:u.toString))&&(p=d+"",l.push({start:t.length+i.length,length:p.length,error:`Value of type ${Object.prototype.toString.call(d).slice(8,-1)} is not a valid path parameter`})),t+i+(o===n.length?"":p)},""),s=o.split(/[?#]/,1)[0],a=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(i=a.exec(s));)l.push({start:i.index,length:i[0].length,error:`Value "${i[0]}" can't be safely passed as a path parameter`});if(l.sort((e,t)=>e.start-t.start),l.length>0){let e=0,t=l.reduce((t,n)=>{let i=" ".repeat(n.start-e),r="^".repeat(n.length);return e=n.start+n.length,t+i+r},"");throw new io(`Path parameters result in path with invalid segments:
${l.map(e=>e.error).join("\n")}
${o}
${t}`)}return o})(ik);class iL extends iD{create(e,t){var n;let{api_version:i=this._client.apiVersion}=e,r=ng(e,["api_version"]);if("model"in r&&"agent_config"in r)throw new io("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in r&&"generation_config"in r)throw new io("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(iq`/${i}/interactions`,Object.assign(Object.assign({body:r},t),{stream:null!=(n=e.stream)&&n}))}delete(e,t={},n){let{api_version:i=this._client.apiVersion}=null!=t?t:{};return this._client.delete(iq`/${i}/interactions/${e}`,n)}cancel(e,t={},n){let{api_version:i=this._client.apiVersion}=null!=t?t:{};return this._client.post(iq`/${i}/interactions/${e}/cancel`,n)}get(e,t={},n){var i;let r=null!=t?t:{},{api_version:l=this._client.apiVersion}=r,o=ng(r,["api_version"]);return this._client.get(iq`/${l}/interactions/${e}`,Object.assign(Object.assign({query:o},n),{stream:null!=(i=null==t?void 0:t.stream)&&i}))}}iL._key=Object.freeze(["interactions"]);class iG extends iL{}function iH(e){let t;return(null!=n?n:n=(t=new globalThis.TextEncoder).encode.bind(t))(e)}function iF(e){let t;return(null!=i?i:i=(t=new globalThis.TextDecoder).decode.bind(t))(e)}class iV{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?iH(e):e;this.buffer=function(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),i=0;for(let t of e)n.set(t,i),i+=t.length;return n}([this.buffer,n]);let i=[];for(;null!=(t=function(e,t){for(let n=null!=t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}(this.buffer,this.carriageReturnIndex));){if(t.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=t.index;continue}if(null!=this.carriageReturnIndex&&(t.index!==this.carriageReturnIndex+1||t.carriage)){i.push(iF(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let e=null!==this.carriageReturnIndex?t.preceding-1:t.preceding,n=iF(this.buffer.subarray(0,e));i.push(n),this.buffer=this.buffer.subarray(t.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode("\n"):[]}}iV.NEWLINE_CHARS=new Set(["\n","\r"]),iV.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let iB={off:0,error:200,warn:300,info:400,debug:500},iJ=(e,t,n)=>{if(e){if(Object.prototype.hasOwnProperty.call(iB,e))return e;iz(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(iB))}`)}};function i$(){}function iY(e,t,n){return!t||iB[e]>iB[n]?i$:t[e].bind(t)}let iW={error:i$,warn:i$,info:i$,debug:i$},iK=new WeakMap;function iz(e){var t;let n=e.logger,i=null!=(t=e.logLevel)?t:"off";if(!n)return iW;let r=iK.get(n);if(r&&r[0]===i)return r[1];let l={error:iY("error",n,i),warn:iY("warn",n,i),info:iY("info",n,i),debug:iY("debug",n,i)};return iK.set(n,[i,l]),l}let iX=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-goog-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class iQ{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let i=!1,r=n?iz(n):console;return new iQ(function(){return nv(this,arguments,function*(){var n,l,o,s;if(i)throw new io("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let a=!1;try{try{for(var u,d=!0,p=nE(function(e,t){return nv(this,arguments,function*(){var n,i,r,l;if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new io("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new io("Attempted to iterate over a response with no body")}let o=new iZ,s=new iV,a=iO(e.body);try{for(var u,d=!0,p=nE(function(e){return nv(this,arguments,function*(){var t,n,i,r;let l=new Uint8Array;try{for(var o,s=!0,a=nE(e);!(t=(o=yield ny(a.next())).done);s=!0){let e;if(r=o.value,s=!1,null==r)continue;let t=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?iH(r):r,n=new Uint8Array(l.length+t.length);for(n.set(l),n.set(t,l.length),l=n;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(l));)yield yield ny(l.slice(0,e)),l=l.slice(e)}}catch(e){n={error:e}}finally{try{!s&&!t&&(i=a.return)&&(yield ny(i.call(a)))}finally{if(n)throw n.error}}l.length>0&&(yield yield ny(l))})}(a));!(n=(u=yield ny(p.next())).done);d=!0)for(let e of(l=u.value,d=!1,s.decode(l))){let t=o.decode(e);t&&(yield yield ny(t))}}catch(e){i={error:e}}finally{try{!d&&!n&&(r=p.return)&&(yield ny(r.call(p)))}finally{if(i)throw i.error}}for(let e of s.flush()){let t=o.decode(e);t&&(yield yield ny(t))}})}(e,t));!(n=(u=yield ny(p.next())).done);d=!0)if(s=u.value,d=!1,!a)if(s.data.startsWith("[DONE]")){a=!0;continue}else try{yield yield ny(JSON.parse(s.data))}catch(e){throw r.error("Could not parse message into JSON:",s.data),r.error("From chunk:",s.raw),e}}catch(e){l={error:e}}finally{try{!d&&!n&&(o=p.return)&&(yield ny(o.call(p)))}finally{if(l)throw l.error}}a=!0}catch(e){if(ir(e))return yield ny(void 0);throw e}finally{a||t.abort()}})},t,n)}static fromReadableStream(e,t,n){let i=!1;return new iQ(function(){return nv(this,arguments,function*(){var n,r,l,o;if(i)throw new io("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let s=!1;try{try{for(var a,u=!0,d=nE(function(){return nv(this,arguments,function*(){var t,n,i,r;let l=new iV,o=iO(e);try{for(var s,a=!0,u=nE(o);!(t=(s=yield ny(u.next())).done);a=!0)for(let e of(r=s.value,a=!1,l.decode(r)))yield yield ny(e)}catch(e){n={error:e}}finally{try{!a&&!t&&(i=u.return)&&(yield ny(i.call(u)))}finally{if(n)throw n.error}}for(let e of l.flush())yield yield ny(e)})}());!(n=(a=yield ny(d.next())).done);u=!0)o=a.value,u=!1,!s&&o&&(yield yield ny(JSON.parse(o)))}catch(e){r={error:e}}finally{try{!u&&!n&&(l=d.return)&&(yield ny(l.call(d)))}finally{if(r)throw r.error}}s=!0}catch(e){if(ir(e))return yield ny(void 0);throw e}finally{s||t.abort()}})},t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),i=i=>({next:()=>{if(0===i.length){let i=n.next();e.push(i),t.push(i)}return i.shift()}});return[new iQ(()=>i(e),this.controller,this.client),new iQ(()=>i(t),this.controller,this.client)]}toReadableStream(){let e,t=this;return iC({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:n,done:i}=await e.next();if(i)return t.close();let r=iH(JSON.stringify(n)+"\n");t.enqueue(r)}catch(e){t.error(e)}},async cancel(){var t;await (null==(t=e.return)?void 0:t.call(e))}})}}class iZ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){var t;let n;if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[i,r,l]=-1!==(n=(t=e).indexOf(":"))?[t.substring(0,n),":",t.substring(n+1)]:[t,"",""];return l.startsWith(" ")&&(l=l.substring(1)),"event"===i?this.event=l:"data"===i&&this.data.push(l),null}}async function i0(e,t){let{response:n,requestLogID:i,retryOfRequestLogID:r,startTime:l}=t,o=await (async()=>{var i;if(t.options.stream)return(iz(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(n,t.controller,e):iQ.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;let r=n.headers.get("content-type"),l=null==(i=null==r?void 0:r.split(";")[0])?void 0:i.trim();return(null==l?void 0:l.includes("application/json"))||(null==l?void 0:l.endsWith("+json"))?await n.json():await n.text()})();return iz(e).debug(`[${i}] response parsed`,iX({retryOfRequestLogID:r,url:n.url,status:n.status,body:o,durationMs:Date.now()-l})),o}class i1 extends Promise{constructor(e,t,n=i0){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new i1(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}let i2=Symbol("brand.privateNullableHeaders"),i6=e=>{let t=new Headers,n=new Set;for(let i of e){let e=new Set;for(let[r,l]of function*(e){let t;if(!e)return;if(i2 in e){let{values:t,nulls:n}=e;for(let e of(yield*t.entries(),n))yield[e,null];return}let n=!1;for(let i of(e instanceof Headers?t=e.entries():iI(e)?t=e:(n=!0,t=Object.entries(null!=e?e:{})),t)){let e=i[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=iI(i[1])?i[1]:[i[1]],r=!1;for(let i of t)void 0!==i&&(n&&!r&&(r=!0,yield[e,null]),yield[e,i])}}(i)){let i=r.toLowerCase();e.has(i)||(t.delete(r),e.add(i)),null===l?(t.delete(r),n.add(i)):(t.append(r,l),n.delete(i))}}return{[i2]:!0,values:t,nulls:n}},i3=e=>{var t,n,i,r,l,o;return void 0!==globalThis.process?null!=(i=null==(n=null==(t=globalThis.process.env)?void 0:t[e])?void 0:n.trim())?i:void 0:void 0!==globalThis.Deno?null==(o=null==(l=null==(r=globalThis.Deno.env)?void 0:r.get)?void 0:l.call(r,e))?void 0:o.trim():void 0};class i4{constructor(e){var t,n,i,r,l,o,s,{baseURL:a=i3("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=null!=(t=i3("GEMINI_API_KEY"))?t:null,apiVersion:d="v1beta"}=e;const p=Object.assign(Object.assign({apiKey:u,apiVersion:d},ng(e,["baseURL","apiKey","apiVersion"])),{baseURL:a||"https://generativelanguage.googleapis.com"});this.baseURL=p.baseURL,this.timeout=null!=(n=p.timeout)?n:i4.DEFAULT_TIMEOUT,this.logger=null!=(i=p.logger)?i:console;const c="warn";this.logLevel=c,this.logLevel=null!=(l=null!=(r=iJ(p.logLevel,"ClientOptions.logLevel",this))?r:iJ(i3("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))?l:c,this.fetchOptions=p.fetchOptions,this.maxRetries=null!=(o=p.maxRetries)?o:2,this.fetch=null!=(s=p.fetch)?s:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=iN,this._options=p,this.apiKey=u,this.apiVersion=d,this.clientAdapter=p.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key")||this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){let t=i6([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return i6([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return i6([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new io(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${iA}`}defaultIdempotencyKey(){return`stainless-node-retry-${ii()}`}makeStatusError(e,t,n,i){return is.generate(e,t,n,i)}buildURL(e,t,n){let i=!this.baseURLOverridden()&&n||this.baseURL,r=new URL(ib.test(e)?e:i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(l)&&(t=Object.assign(Object.assign({},l),t)),"object"==typeof t&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){let t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)))}request(e,t=null){return new i1(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var i,r,l;let o=await e,s=null!=(i=o.maxRetries)?i:this.maxRetries;null==t&&(t=s),await this.prepareOptions(o);let{req:a,url:u,timeout:d}=await this.buildRequest(o,{retryCount:s-t});await this.prepareRequest(a,{url:u,options:o});let p="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===n?"":`, retryOf: ${n}`,h=Date.now();if(iz(this).debug(`[${p}] sending request`,iX({retryOfRequestLogID:n,method:o.method,url:u,options:o,headers:a.headers})),null==(r=o.signal)?void 0:r.aborted)throw new ia;let f=new AbortController,m=await this.fetchWithTimeout(u,a,d,f).catch(il),g=Date.now();if(m instanceof globalThis.Error){let e=`retrying, ${t} attempts remaining`;if(null==(l=o.signal)?void 0:l.aborted)throw new ia;let i=ir(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return iz(this).info(`[${p}] connection ${i?"timed out":"failed"} - ${e}`),iz(this).debug(`[${p}] connection ${i?"timed out":"failed"} (${e})`,iX({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),this.retryRequest(o,t,null!=n?n:p);if(iz(this).info(`[${p}] connection ${i?"timed out":"failed"} - error; no more retries left`),iz(this).debug(`[${p}] connection ${i?"timed out":"failed"} (error; no more retries left)`,iX({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),i)throw new id;throw new iu({cause:m})}let y=`[${p}${c}] ${a.method} ${u} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${g-h}ms`;if(!m.ok){let e=await this.shouldRetry(m);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await ix(m.body),iz(this).info(`${y} - ${e}`),iz(this).debug(`[${p}] response error (${e})`,iX({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),this.retryRequest(o,t,null!=n?n:p,m.headers)}let i=e?"error; no more retries left":"error; not retryable";iz(this).info(`${y} - ${i}`);let r=await m.text().catch(e=>il(e).message),l=(e=>{try{return JSON.parse(e)}catch(e){return}})(r),s=l?void 0:r;throw iz(this).debug(`[${p}] response error (${i})`,iX({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:s,durationMs:Date.now()-h})),this.makeStatusError(m.status,l,s,m.headers)}return iz(this).info(y),iz(this).debug(`[${p}] response start`,iX({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),{response:m,options:o,controller:f,requestLogID:p,retryOfRequestLogID:n,startTime:h}}async fetchWithTimeout(e,t,n,i){let r=t||{},{signal:l,method:o}=r,s=ng(r,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());let a=setTimeout(()=>i.abort(),n),u=globalThis.ReadableStream&&s.body instanceof globalThis.ReadableStream||"object"==typeof s.body&&null!==s.body&&Symbol.asyncIterator in s.body,d=Object.assign(Object.assign(Object.assign({signal:i.signal},u?{duplex:"half"}:{}),{method:"GET"}),s);o&&(d.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,d)}finally{clearTimeout(a)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,n,i){var r;let l,o,s=null==i?void 0:i.get("retry-after-ms");if(s){let e=parseFloat(s);Number.isNaN(e)||(l=e)}let a=null==i?void 0:i.get("retry-after");if(a&&!l){let e=parseFloat(a);l=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(l&&0<=l&&l<6e4)){let n=null!=(r=e.maxRetries)?r:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,n)}return await (o=l,new Promise(e=>setTimeout(e,o))),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,i,r;let l=Object.assign({},e),{method:o,path:s,query:a,defaultBaseURL:u}=l,d=this.buildURL(s,a,u);"timeout"in l&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new io(`${e} must be an integer`);if(t<0)throw new io(`${e} must be a positive integer`)})("timeout",l.timeout),l.timeout=null!=(n=l.timeout)?n:this.timeout;let{bodyHeaders:p,body:c}=this.buildBody({options:l}),h=await this.buildHeaders({options:e,method:o,bodyHeaders:p,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:h},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"}),c&&{body:c}),null!=(i=this.fetchOptions)?i:{}),null!=(r=l.fetchOptions)?r:{}),url:d,timeout:l.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:i,retryCount:r}){let l={};this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);let o=await this.authHeaders(e),s=i6([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),null!=t?t:t=(()=>{var e,t,n,i,r;let l="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":iA,"X-Stainless-OS":iS(Deno.build.os),"X-Stainless-Arch":iT(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!=(t=null==(e=Deno.version)?void 0:e.deno)?t:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":iA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":iA,"X-Stainless-OS":iS(null!=(n=globalThis.process.platform)?n:"unknown"),"X-Stainless-Arch":iT(null!=(i=globalThis.process.arch)?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!=(r=globalThis.process.version)?r:"unknown"};let o=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,i=n[2]||0,r=n[3]||0;return{browser:e,version:`${t}.${i}.${r}`}}}return null}();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":iA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":iA,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),this._options.defaultHeaders,i,e.headers,o]);return this.validateHeaders(s),s.values}buildBody({options:{body:e,headers:t}}){let n;if(!e)return{bodyHeaders:void 0,body:void 0};let i=i6([t]);if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream)return{bodyHeaders:void 0,body:e};if("object"!=typeof e||!(Symbol.asyncIterator in e)&&(!(Symbol.iterator in e)||!("next"in e)||"function"!=typeof e.next))return this.encoder({body:e,headers:i});return{bodyHeaders:void 0,body:(n=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator](),iC({start(){},async pull(e){let{done:t,value:i}=await n.next();t?e.close():e.enqueue(i)},async cancel(){var e;await (null==(e=n.return)?void 0:e.call(n))}}))}}}i4.DEFAULT_TIMEOUT=6e4;class i5 extends i4{constructor(){super(...arguments),this.interactions=new iG(this)}}function i8(e,t){let n,i,r,l={},o=th(e,["sdkHttpResponse"]);null!=o&&tc(l,["sdkHttpResponse"],o);let s=th(e,["name"]);null!=s&&tc(l,["name"],s);let a=th(e,["state"]);null!=a&&tc(l,["state"],ne(a));let u=th(e,["createTime"]);null!=u&&tc(l,["createTime"],u);let d=th(e,["tuningTask","startTime"]);null!=d&&tc(l,["startTime"],d);let p=th(e,["tuningTask","completeTime"]);null!=p&&tc(l,["endTime"],p);let c=th(e,["updateTime"]);null!=c&&tc(l,["updateTime"],c);let h=th(e,["description"]);null!=h&&tc(l,["description"],h);let f=th(e,["baseModel"]);null!=f&&tc(l,["baseModel"],f);let m=th(e,["_self"]);return null!=m&&tc(l,["tunedModel"],(n={},null!=(i=th(m,["name"]))&&tc(n,["model"],i),null!=(r=th(m,["name"]))&&tc(n,["endpoint"],r),n)),l}function i9(e,t){let n={},i=th(e,["sdkHttpResponse"]);null!=i&&tc(n,["sdkHttpResponse"],i);let r=th(e,["name"]);null!=r&&tc(n,["name"],r);let l=th(e,["state"]);null!=l&&tc(n,["state"],ne(l));let o=th(e,["createTime"]);null!=o&&tc(n,["createTime"],o);let s=th(e,["startTime"]);null!=s&&tc(n,["startTime"],s);let a=th(e,["endTime"]);null!=a&&tc(n,["endTime"],a);let u=th(e,["updateTime"]);null!=u&&tc(n,["updateTime"],u);let d=th(e,["error"]);null!=d&&tc(n,["error"],d);let p=th(e,["description"]);null!=p&&tc(n,["description"],p);let c=th(e,["baseModel"]);null!=c&&tc(n,["baseModel"],c);let h=th(e,["tunedModel"]);null!=h&&tc(n,["tunedModel"],h);let f=th(e,["preTunedModel"]);null!=f&&tc(n,["preTunedModel"],f);let m=th(e,["supervisedTuningSpec"]);null!=m&&tc(n,["supervisedTuningSpec"],m);let g=th(e,["preferenceOptimizationSpec"]);null!=g&&tc(n,["preferenceOptimizationSpec"],g);let y=th(e,["tuningDataStats"]);null!=y&&tc(n,["tuningDataStats"],y);let v=th(e,["encryptionSpec"]);null!=v&&tc(n,["encryptionSpec"],v);let E=th(e,["partnerModelTuningSpec"]);null!=E&&tc(n,["partnerModelTuningSpec"],E);let b=th(e,["customBaseModel"]);null!=b&&tc(n,["customBaseModel"],b);let _=th(e,["experiment"]);null!=_&&tc(n,["experiment"],_);let I=th(e,["labels"]);null!=I&&tc(n,["labels"],I);let A=th(e,["outputUri"]);null!=A&&tc(n,["outputUri"],A);let T=th(e,["pipelineJob"]);null!=T&&tc(n,["pipelineJob"],T);let S=th(e,["serviceAccount"]);null!=S&&tc(n,["serviceAccount"],S);let C=th(e,["tunedModelDisplayName"]);null!=C&&tc(n,["tunedModelDisplayName"],C);let O=th(e,["veoTuningSpec"]);return null!=O&&tc(n,["veoTuningSpec"],O),n}function i7(e,t){let n={},i=th(e,["gcsUri"]);null!=i&&tc(n,["validationDatasetUri"],i);let r=th(e,["vertexDatasetResource"]);return null!=r&&tc(n,["validationDatasetUri"],r),n}i5.GeminiNextGenAPIClient=i5,i5.GeminiNextGenAPIClientError=io,i5.APIError=is,i5.APIConnectionError=iu,i5.APIConnectionTimeoutError=id,i5.APIUserAbortError=ia,i5.NotFoundError=im,i5.ConflictError=ig,i5.RateLimitError=iv,i5.BadRequestError=ip,i5.AuthenticationError=ic,i5.InternalServerError=iE,i5.PermissionDeniedError=ih,i5.UnprocessableEntityError=iy,i5.toFile=ij,i5.Interactions=iG;class re extends td{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nc(tt.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI())if(e.baseModel.startsWith("projects/")){let n={tunedModelName:e.baseModel};(null==(t=e.config)?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);let i=Object.assign(Object.assign({},e),{preTunedModel:n});return i.baseModel=void 0,await this.tuneInternal(i)}else{let t=Object.assign({},e);return await this.tuneInternal(t)}{let t=Object.assign({},e),n=await this.tuneMldevInternal(t),i="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?i=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:eP.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s=(i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],r),i);return l=tp("{name}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>i9(e))}{let t,n,s=(t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],n),t);return l=tp("{name}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>i8(e))}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s,a,u,d=(i={},null!=(r=th(e,["config"]))&&(s=th(r,["pageSize"]),void 0!==i&&null!=s&&tc(i,["_query","pageSize"],s),a=th(r,["pageToken"]),void 0!==i&&null!=a&&tc(i,["_query","pageToken"],a),u=th(r,["filter"]),void 0!==i&&null!=u&&tc(i,["_query","filter"],u)),i);return l=tp("tuningJobs",d._url),o=d._query,delete d._url,delete d._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=th(e,["sdkHttpResponse"]);null!=i&&tc(n,["sdkHttpResponse"],i);let r=th(e,["nextPageToken"]);null!=r&&tc(n,["nextPageToken"],r);let l=th(e,["tuningJobs"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>i9(e))),tc(n,["tuningJobs"],e)}return n}(e),n=new tN;return Object.assign(n,t),n})}{let t,n,s,a,u,d=(t={},null!=(n=th(e,["config"]))&&(s=th(n,["pageSize"]),void 0!==t&&null!=s&&tc(t,["_query","pageSize"],s),a=th(n,["pageToken"]),void 0!==t&&null!=a&&tc(t,["_query","pageToken"],a),u=th(n,["filter"]),void 0!==t&&null!=u&&tc(t,["_query","filter"],u)),t);return l=tp("tunedModels",d._url),o=d._query,delete d._url,delete d._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=th(e,["sdkHttpResponse"]);null!=i&&tc(n,["sdkHttpResponse"],i);let r=th(e,["nextPageToken"]);null!=r&&tc(n,["nextPageToken"],r);let l=th(e,["tunedModels"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>i8(e))),tc(n,["tuningJobs"],e)}return n}(e),n=new tN;return Object.assign(n,t),n})}}async cancel(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i,r,s=(i={},null!=(r=th(e,["name"]))&&tc(i,["_url","name"],r),i);return l=tp("{name}:cancel",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tw;return Object.assign(r,i),r})}{let t,n,s=(t={},null!=(n=th(e,["name"]))&&tc(t,["_url","name"],n),t);return l=tp("{name}:cancel",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),t),r=new tw;return Object.assign(r,i),r})}}async tuneInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l,o,s,a,u,d=(l={},null!=(o=th(e,["baseModel"]))&&tc(l,["baseModel"],o),null!=(s=th(e,["preTunedModel"]))&&tc(l,["preTunedModel"],s),null!=(a=th(e,["trainingDataset"]))&&function(e,t,n){let i=th(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=th(e,["gcsUri"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){let n=th(e,["gcsUri"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let r=th(n,["config","method"]);if(void 0===r&&(r="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===r){let n=th(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===r){let n=th(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==th(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(a,l,e),null!=(u=th(e,["config"]))&&function(e,t,n){let i=th(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=th(e,["validationDataset"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec"],i7(n))}else if("PREFERENCE_TUNING"===i){let n=th(e,["validationDataset"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec"],i7(n))}let r=th(e,["tunedModelDisplayName"]);void 0!==t&&null!=r&&tc(t,["tunedModelDisplayName"],r);let l=th(e,["description"]);void 0!==t&&null!=l&&tc(t,["description"],l);let o=th(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){let n=th(e,["epochCount"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){let n=th(e,["epochCount"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let s=th(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){let n=th(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===s){let n=th(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let a=th(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){let n=th(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===a){let n=th(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let u=th(n,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){let n=th(e,["adapterSize"]);void 0!==t&&null!=n&&tc(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===u){let n=th(e,["adapterSize"]);void 0!==t&&null!=n&&tc(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==th(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==th(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let d=th(e,["labels"]);void 0!==t&&null!=d&&tc(t,["labels"],d);let p=th(e,["beta"]);void 0!==t&&null!=p&&tc(t,["preferenceOptimizationSpec","hyperParameters","beta"],p)}(u,l,e),l);return i=tp("tuningJobs",d._url),r=d._query,delete d._url,delete d._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>i9(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l,o,s,a,u,d=(l={},null!=(o=th(e,["baseModel"]))&&tc(l,["baseModel"],o),null!=(s=th(e,["preTunedModel"]))&&tc(l,["preTunedModel"],s),null!=(a=th(e,["trainingDataset"]))&&function(e,t){if(void 0!==th(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==th(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=th(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),tc({},["examples","examples"],e)}}(a),null!=(u=th(e,["config"]))&&function(e,t,n){if(void 0!==th(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let i=th(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=i&&tc(t,["displayName"],i),void 0!==th(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let r=th(e,["epochCount"]);void 0!==t&&null!=r&&tc(t,["tuningTask","hyperparameters","epochCount"],r);let l=th(e,["learningRateMultiplier"]);if(null!=l&&tc({},["tuningTask","hyperparameters","learningRateMultiplier"],l),void 0!==th(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==th(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==th(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=th(e,["batchSize"]);void 0!==t&&null!=o&&tc(t,["tuningTask","hyperparameters","batchSize"],o);let s=th(e,["learningRate"]);if(void 0!==t&&null!=s&&tc(t,["tuningTask","hyperparameters","learningRate"],s),void 0!==th(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==th(e,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(u,l),l);return i=tp("tunedModels",d._url),r=d._query,delete d._url,delete d._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,r,l,o;return t={},null!=(n=th(e,["sdkHttpResponse"]))&&tc(t,["sdkHttpResponse"],n),null!=(i=th(e,["name"]))&&tc(t,["name"],i),null!=(r=th(e,["metadata"]))&&tc(t,["metadata"],r),null!=(l=th(e,["done"]))&&tc(t,["done"],l),null!=(o=th(e,["error"]))&&tc(t,["error"],o),t})}}}class rt{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}let rn="x-goog-upload-status";async function ri(e,t,n){var i;let r=await rl(e,t,n),l=await (null==r?void 0:r.json());if((null==(i=null==r?void 0:r.headers)?void 0:i[rn])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return l.file}async function rr(e,t,n){var i;let r=await rl(e,t,n),l=await (null==r?void 0:r.json());if((null==(i=null==r?void 0:r.headers)?void 0:i[rn])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=tm(l),s=new tV;return Object.assign(s,o),s}async function rl(e,t,n){var i,r;let l=0,o=0,s=new tg(new Response),a="upload";for(l=e.size;o<l;){let u=Math.min(8388608,l-o),d=e.slice(o,o+u);o+u>=l&&(a+=", finalize");let p=0,c=1e3;for(;p<3&&(null==(i=null==(s=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}))?void 0:s.headers)||!i[rn]);)p++,await function(e){return new Promise(t=>setTimeout(t,e))}(c),c*=2;if(o+=u,(null==(r=null==s?void 0:s.headers)?void 0:r[rn])!=="active")break;if(l<=o)throw Error("All content has been uploaded, but the upload status is not finalized.")}return s}async function ro(e){return{size:e.size,type:e.type}}class rs{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await ri(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await rr(e,t,n)}async stat(e){if("string"!=typeof e)return await ro(e);throw Error("File path is not supported in browser uploader.")}}class ra{create(e,t,n){return new ru(e,t,n)}}class ru{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}let rd="x-goog-api-key";class rp{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(rd)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(rd,this.apiKey)}}}class rc{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;(null==e?void 0:e.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let t=new i5({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!=(t=e.vertexai)&&t,this.apiKey=e.apiKey;const n=function(e,t,n,i){return(null==e?void 0:e.baseUrl)?e.baseUrl:t?null!=l?l:n:null!=r?r:i}(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new rp(this.apiKey);this.apiClient=new nJ({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new rs,downloader:new rt}),this.models=new n8(this.apiClient),this.live=new n0(this.apiClient,i,new ra),this.batches=new nh(this.apiClient),this.chats=new nI(this.models,this.apiClient),this.caches=new nm(this.apiClient),this.files=new nS(this.apiClient),this.operations=new n9(this.apiClient),this.authTokens=new n7(this.apiClient),this.tunings=new re(this.apiClient),this.fileSearchStores=new it(this.apiClient)}}let rh=e.i(24687).products.map(e=>`- ${e.name} (${e.category}): ${e.description}. Prix: ${e.price}. Bienfaits: ${e.benefits.join(", ")}.`).join("\n"),rf=`
Vous \xeates "VitaliBot", l'assistant virtuel expert de la boutique "BIO SANT\xc9".
Votre r\xf4le est d'aider les clients \xe0 trouver des produits naturels pour l'hypertension, le diab\xe8te et la prostate.

R\xc8GLES STRICTES :
1. NE JAMAIS donner d'avis m\xe9dical, de diagnostic ou de prescription.
2. Si un utilisateur d\xe9crit des sympt\xf4mes graves, conseillez-lui IMM\xc9DIATEMENT de consulter un m\xe9decin.
3. Basez vos recommandations UNIQUEMENT sur la liste de produits suivante :
${rh}

4. Soyez empathique, professionnel et rassurant.
5. R\xe9pondez toujours en Fran\xe7ais.
6. Soyez concis (max 3-4 phrases par r\xe9ponse sauf si on demande des d\xe9tails).

Exemple :
User: "J'ai mal \xe0 la t\xeate et ma tension est haute."
Assistant: "Je suis d\xe9sol\xe9 d'apprendre cela. Pour des probl\xe8mes de tension persistants, il est crucial de consulter votre m\xe9decin. En compl\xe9ment d'un suivi m\xe9dical, nous proposons 'TensionGuard Bio' qui aide \xe0 maintenir une pression saine gr\xe2ce \xe0 l'aub\xe9pine."
`,rm=null,rg=async(e,t)=>{let n=(!rm&&tu.default.env.API_KEY&&(rm=new rc({apiKey:tu.default.env.API_KEY})),rm);if(!n)throw Error("API Key manquante.");try{let i=n.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:rf,temperature:.7},history:t.map(e=>({role:e.role,parts:[{text:e.text}]}))});return(await i.sendMessage({message:e})).text}catch(e){throw console.error("Gemini Error:",e),e}};e.s(["AIChat",0,()=>{let[e,t]=(0,ti.useState)(!1),[n,i]=(0,ti.useState)([{role:"model",text:"Bonjour ! Je suis VitaliBot. Comment puis-je vous aider à trouver le bon produit aujourd'hui ?"}]),[r,l]=(0,ti.useState)(""),[o,s]=(0,ti.useState)(!1),a=(0,ti.useRef)(null);(0,ti.useEffect)(()=>{a.current?.scrollIntoView({behavior:"smooth"})},[n,e]);let u=async()=>{if(!r.trim()||o)return;let e={role:"user",text:r};i(t=>[...t,e]),l(""),s(!0);try{let t=[...n,e],r=await rg(e.text,t);if(r)i(e=>[...e,{role:"model",text:r}]);else throw Error("Empty response")}catch(e){i(e=>[...e,{role:"model",text:"Désolé, je rencontre des difficultés techniques momentanées. Veuillez réessayer plus tard.",isError:!0}])}finally{s(!1)}};return(0,tn.jsxs)(tn.Fragment,{children:[!e&&(0,tn.jsx)("button",{onClick:()=>t(!0),className:"fixed bottom-6 right-6 z-[1100] flex items-center justify-center bg-primary-900 text-white p-4 rounded-full shadow-2xl hover:shadow-primary-900/40 transform hover:scale-110 transition-all duration-300 group border border-white/20","aria-label":"Assistant Santé",children:(0,tn.jsx)(ts,{className:"w-6 h-6 group-hover:rotate-12 transition-transform"})}),e&&(0,tn.jsxs)("div",{className:"fixed bottom-6 right-6 z-[1200] w-[400px] max-w-[calc(100vw-2rem)] h-[600px] max-h-[calc(100vh-8rem)] bg-[#F4F4F0] rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.2)] flex flex-col overflow-hidden border border-black/5 animate-in slide-in-from-bottom-4 duration-500",children:[(0,tn.jsxs)("div",{className:"bg-primary-900 p-5 flex justify-between items-center text-white relative",children:[(0,tn.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tn.jsx)("div",{className:"bg-white/10 p-2.5 rounded-2xl backdrop-blur-md",children:(0,tn.jsx)(ts,{className:"w-6 h-6"})}),(0,tn.jsxs)("div",{children:[(0,tn.jsx)("h3",{className:"font-bold text-lg tracking-tight",children:"VitaliBot"}),(0,tn.jsxs)("p",{className:"text-[10px] text-white/60 uppercase tracking-widest flex items-center gap-1.5 font-semibold",children:[(0,tn.jsx)("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"}),"Assistant Expert"]})]})]}),(0,tn.jsx)("button",{onClick:()=>t(!1),className:"bg-white/10 hover:bg-white/20 p-2 rounded-xl transition-all duration-300","aria-label":"Fermer",children:(0,tn.jsx)(tr.X,{className:"w-5 h-5"})})]}),(0,tn.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[n.map((e,t)=>(0,tn.jsxs)("div",{className:`flex gap-3 ${"user"===e.role?"justify-end":"justify-start"}`,children:["model"===e.role&&(0,tn.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-900/10 flex items-center justify-center flex-shrink-0",children:(0,tn.jsx)(ts,{className:"w-4 h-4 text-primary-900"})}),(0,tn.jsx)("div",{className:`max-w-[80%] p-4 rounded-3xl text-sm leading-relaxed ${"user"===e.role?"bg-primary-900 text-white rounded-tr-none shadow-lg shadow-primary-900/20":"bg-white text-gray-800 rounded-tl-none border border-black/5 shadow-sm"} ${e.isError?"bg-red-50 border-red-200 text-red-600":""}`,children:e.text}),"user"===e.role&&(0,tn.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-900/10 flex items-center justify-center flex-shrink-0",children:(0,tn.jsx)(ta.User,{className:"w-4 h-4 text-primary-900"})})]},t)),o&&(0,tn.jsx)("div",{className:"flex justify-start",children:(0,tn.jsxs)("div",{className:"bg-white p-3 rounded-2xl rounded-bl-none border border-gray-200 shadow-sm flex items-center gap-2",children:[(0,tn.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,tn.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,tn.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),(0,tn.jsx)("div",{ref:a})]}),(0,tn.jsxs)("div",{className:"p-5 bg-white border-t border-black/5",children:[(0,tn.jsxs)("div",{className:"relative flex items-center",children:[(0,tn.jsx)("input",{type:"text",value:r,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:"Posez votre question...",className:"w-full bg-gray-50 border-none rounded-2xl pl-5 pr-14 py-4 text-sm focus:ring-2 focus:ring-primary-900 transition-all placeholder:text-gray-400",disabled:o}),(0,tn.jsx)("button",{onClick:u,disabled:o||!r.trim(),className:"absolute right-2 p-2.5 bg-primary-900 text-white rounded-xl hover:bg-primary-800 disabled:opacity-30 disabled:hover:bg-primary-900 transition-all shadow-lg shadow-primary-900/20",children:(0,tn.jsx)(to,{className:"w-5 h-5"})})]}),(0,tn.jsx)("p",{className:"text-[10px] text-center text-black/30 mt-3 font-medium uppercase tracking-wider",children:"Réponses basées sur la science naturelle"})]})]})]})}],48346)}]);