(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31343,95242,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>a],31343);let r=(0,t.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]);e.s(["Pause",()=>r],95242)},3408,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>t])},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},88511,e=>{"use strict";let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],88511)},81203,e=>{"use strict";let t=(0,e.i(75254).default)("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);e.s(["Power",()=>t],81203)},55930,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(7233),l=e.i(87951),s=e.i(31343),i=e.i(95242),o=e.i(88511),n=e.i(27612),d=e.i(75254);let c=(0,d.default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var u=e.i(81203),x=e.i(31278),m=e.i(3408),m=m;let g=(0,d.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var h=e.i(69074),p=e.i(47163);function y(){let[e,d]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[f,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)("all"),[w,k]=(0,a.useState)(!1),[_,M]=(0,a.useState)(null),[C,P]=(0,a.useState)(null),A=(0,a.useRef)(null),[S,$]=(0,a.useState)({product_id:"",author:"",location:"",duration:"0:00",text_content:""}),[L,T]=(0,a.useState)(null),[U,R]=(0,a.useState)(null),[z,E]=(0,a.useState)(null),[F,I]=(0,a.useState)(!1);(0,a.useEffect)(()=>{q()},[]),(0,a.useEffect)(()=>{y.length>0&&H()},[v,y]);let q=async()=>{try{let e=await fetch(`${p.API_URL}/api/admin/products`),t=await e.json();b(t.products||[]),t.products?.length>0&&!S.product_id&&$(e=>({...e,product_id:t.products[0].id}))}catch(e){console.error("Failed to fetch products:",e)}},H=async()=>{try{let e="all"===v?`${p.API_URL}/api/admin/testimonials`:`${p.API_URL}/api/admin/testimonials?product_id=${v}`,t=await fetch(e),a=await t.json();d(a.testimonials||[])}catch(e){console.error("Failed to fetch testimonials:",e)}finally{j(!1)}},D=async e=>{e.preventDefault(),I(!0);try{let e=new FormData;e.append("product_id",S.product_id),e.append("author",S.author),e.append("location",S.location),e.append("duration",S.duration),e.append("text_content",S.text_content),L&&e.append("audio",L),U&&e.append("author_image",U);let t=_?`${p.API_URL}/api/admin/testimonials/${_.id}`:`${p.API_URL}/api/admin/testimonials`,a=await fetch(t,{method:_?"PATCH":"POST",body:e});if(a.ok)k(!1),O(),H();else{let e=await a.json();alert(e.error||"Erreur lors de la sauvegarde")}}catch(e){console.error("Failed to save testimonial:",e),alert("Erreur de connexion")}finally{I(!1)}},O=()=>{M(null),$({product_id:y[0]?.id||"",author:"",location:"",duration:"0:00",text_content:""}),T(null),R(null),E(null)},V=async e=>{try{await fetch(`${p.API_URL}/api/admin/testimonials/${e}/toggle`,{method:"POST"}),H()}catch(e){console.error("Failed to toggle testimonial:",e)}},B=async e=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce témoignage ?"))try{await fetch(`${p.API_URL}/api/admin/testimonials/${e}`,{method:"DELETE"}),H()}catch(e){console.error("Failed to delete testimonial:",e)}},K=e.reduce((e,t)=>(e[t.product_id]||(e[t.product_id]=[]),e[t.product_id].push(t),e),{});return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Témoignages"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Audio, texte et images pour chaque produit"})]}),(0,t.jsxs)("button",{onClick:()=>{O(),k(!0)},className:"flex items-center gap-2 bg-black text-white px-4 py-2 rounded-xl hover:bg-gray-800 transition-colors",children:[(0,t.jsx)(r.Plus,{className:"w-5 h-5"}),"Ajouter"]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,t.jsx)("button",{onClick:()=>N("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${"all"===v?"bg-black text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tous"}),y.map(e=>(0,t.jsx)("button",{onClick:()=>N(e.id),className:`px-4 py-2 rounded-lg font-medium transition-colors ${v===e.id?"bg-black text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.name},e.id))]}),f?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-black"})}):0===e.length?(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-12 text-center",children:[(0,t.jsx)(l.Mic,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Aucun témoignage pour le moment"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:'Cliquez sur "Ajouter" pour créer votre premier témoignage'})]}):(0,t.jsx)("div",{className:"space-y-6",children:Object.entries(K).map(([e,a])=>{let r,d=y.find(t=>t.id===e);return(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:`px-6 py-4 border-b ${(r=y.find(t=>t.id===e),({red:"bg-rose-50 border-rose-200",green:"bg-emerald-50 border-emerald-200",blue:"bg-blue-50 border-blue-200",yellow:"bg-yellow-50 border-yellow-200",orange:"bg-orange-50 border-orange-200",purple:"bg-purple-50 border-purple-200"})[r?.theme_color||"gray"]||"bg-gray-50 border-gray-200")}`,children:[(0,t.jsx)("h3",{className:"font-bold text-gray-900",children:d?.name||e}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[a.length," témoignage(s)"]})]}),(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:a.map(a=>{let r;return(0,t.jsxs)("div",{className:"px-6 py-4 flex items-center gap-4",children:[(0,t.jsx)(c,{className:"w-5 h-5 text-gray-300 cursor-grab"}),a.author_image?(0,t.jsx)("img",{src:a.author_image,alt:a.author,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-100"}):(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",children:(0,t.jsx)(m.default,{className:"w-5 h-5 text-gray-400"})}),a.audio_url&&(0,t.jsx)("button",{onClick:()=>{C===a.id?(A.current?.pause(),P(null)):(A.current&&A.current.pause(),A.current=new Audio(a.audio_url),A.current.play(),A.current.onended=()=>P(null),P(a.id))},className:`w-10 h-10 rounded-full flex items-center justify-center transition-colors text-white ${C===a.id?"bg-gray-900":(r=y.find(t=>t.id===e),({red:"bg-rose-500",green:"bg-emerald-500",blue:"bg-blue-500",yellow:"bg-yellow-500",orange:"bg-orange-500",purple:"bg-purple-500"})[r?.theme_color||"gray"]||"bg-gray-500")}`,children:C===a.id?(0,t.jsx)(i.Pause,{className:"w-4 h-4"}):(0,t.jsx)(s.Play,{className:"w-4 h-4 ml-0.5"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900",children:a.author}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:a.location}),a.text_content&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 italic mt-1 truncate",children:['"',a.text_content,'"']})]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[a.audio_url&&(0,t.jsx)("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded",children:(0,t.jsx)(l.Mic,{className:"w-3 h-3 inline"})}),a.text_content&&(0,t.jsx)("span",{className:"text-xs bg-green-100 text-green-600 px-2 py-0.5 rounded",children:(0,t.jsx)(g,{className:"w-3 h-3 inline"})}),a.author_image&&(0,t.jsx)("span",{className:"text-xs bg-purple-100 text-purple-600 px-2 py-0.5 rounded",children:(0,t.jsx)(m.default,{className:"w-3 h-3 inline"})})]}),(0,t.jsx)("span",{className:"text-sm font-mono text-gray-400 bg-gray-100 px-2 py-1 rounded",children:a.duration}),(0,t.jsx)("button",{onClick:()=>V(a.id),className:`p-2 rounded-lg transition-colors ${a.is_active?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,title:a.is_active?"Actif":"Inactif",children:(0,t.jsx)(u.Power,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>{M(a),$({product_id:a.product_id,author:a.author,location:a.location,duration:a.duration,text_content:a.text_content||""}),E(a.author_image||null),k(!0)},className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",children:(0,t.jsx)(o.Edit,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>B(a.id),className:"p-2 rounded-lg bg-red-50 text-red-500 hover:bg-red-100 transition-colors",children:(0,t.jsx)(n.Trash2,{className:"w-4 h-4"})})]},a.id)})})]},e)})}),w&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6 my-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:_?"Modifier le témoignage":"Nouveau témoignage"}),(0,t.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produit"}),(0,t.jsx)("select",{value:S.product_id,onChange:e=>$({...S,product_id:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",children:y.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auteur"}),(0,t.jsx)("input",{type:"text",value:S.author,onChange:e=>$({...S,author:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"Nom du client",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Localisation"}),(0,t.jsx)("input",{type:"text",value:S.location,onChange:e=>$({...S,location:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"Ville, Quartier",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(g,{className:"w-4 h-4 inline mr-1"}),"Citation / Témoignage texte"]}),(0,t.jsx)("textarea",{value:S.text_content,onChange:e=>$({...S,text_content:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none resize-none h-24",placeholder:"Ce que le client a dit..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(m.default,{className:"w-4 h-4 inline mr-1"}),"Photo de l'auteur"]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[z?(0,t.jsx)("img",{src:z,alt:"Preview",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200"}):(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center border-2 border-dashed border-gray-300",children:(0,t.jsx)(m.default,{className:"w-6 h-6 text-gray-400"})}),(0,t.jsxs)("label",{className:"flex-1 cursor-pointer",children:[(0,t.jsxs)("div",{className:"px-4 py-2 border border-gray-200 rounded-lg text-center hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(h.Upload,{className:"w-4 h-4 inline mr-2"}),U?"Changer l'image":"Uploader une photo"]}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(t){R(t);let e=new FileReader;e.onload=e=>{E(e.target?.result)},e.readAsDataURL(t)}},className:"hidden"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(l.Mic,{className:"w-4 h-4 inline mr-1"}),"Fichier Audio ",_&&"(optionnel)"]}),(0,t.jsx)("input",{type:"file",accept:"audio/*",onChange:e=>T(e.target.files?.[0]||null),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durée audio"}),(0,t.jsx)("input",{type:"text",value:S.duration,onChange:e=>$({...S,duration:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none",placeholder:"1:23"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>k(!1),className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),(0,t.jsxs)("button",{type:"submit",disabled:F,className:"flex-1 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[F&&(0,t.jsx)(x.Loader2,{className:"w-4 h-4 animate-spin"}),_?"Modifier":"Créer"]})]})]})]})})]})}e.s(["default",()=>y],55930)}]);