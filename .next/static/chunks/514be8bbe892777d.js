(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66027,e=>{"use strict";let t;var r=e.i(75555),s=e.i(40143),a=e.i(86491),i=e.i(15823),n=e.i(93803),l=e.i(19273),o=e.i(80166),c=class extends i.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#s=void 0;#a=void 0;#i=void 0;#n;#l;#r;#t;#o;#c;#u;#d;#h;#p;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#s.addObserver(this),u(this.#s,this.options)?this.#x():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return d(this.#s,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return d(this.#s,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#g(),this.#y(),this.#s.removeObserver(this)}setOptions(e){let t=this.options,r=this.#s;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.resolveEnabled)(this.options.enabled,this.#s))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#s.setOptions(this.options),t._defaulted&&!(0,l.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#s,observer:this});let s=this.hasListeners();s&&h(this.#s,r,this.options,t)&&this.#x(),this.updateResult(),s&&(this.#s!==r||(0,l.resolveEnabled)(this.options.enabled,this.#s)!==(0,l.resolveEnabled)(t.enabled,this.#s)||(0,l.resolveStaleTime)(this.options.staleTime,this.#s)!==(0,l.resolveStaleTime)(t.staleTime,this.#s))&&this.#v();let a=this.#R();s&&(this.#s!==r||(0,l.resolveEnabled)(this.options.enabled,this.#s)!==(0,l.resolveEnabled)(t.enabled,this.#s)||a!==this.#p)&&this.#j(a)}getOptimisticResult(e){var t,r;let s=this.#e.getQueryCache().build(this.#e,e),a=this.createResult(s,e);return t=this,r=a,(0,l.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#i=a,this.#l=this.options,this.#n=this.#s.state),a}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#s}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#x({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#x(e){this.#b();let t=this.#s.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.noop)),t}#v(){this.#g();let e=(0,l.resolveStaleTime)(this.options.staleTime,this.#s);if(l.isServer||this.#i.isStale||!(0,l.isValidTimeout)(e))return;let t=(0,l.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#d=o.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#R(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#s):this.options.refetchInterval)??!1}#j(e){this.#y(),this.#p=e,!l.isServer&&!1!==(0,l.resolveEnabled)(this.options.enabled,this.#s)&&(0,l.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=o.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||r.focusManager.isFocused())&&this.#x()},this.#p))}#f(){this.#v(),this.#j(this.#R())}#g(){this.#d&&(o.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#y(){this.#h&&(o.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,s=this.#s,i=this.options,o=this.#i,c=this.#n,d=this.#l,m=e!==s?e.state:this.#a,{state:x}=e,f={...x},g=!1;if(t._optimisticResults){let r=this.hasListeners(),n=!r&&u(e,t),l=r&&h(e,s,t,i);(n||l)&&(f={...f,...(0,a.fetchState)(x.data,e.options)}),"isRestoring"===t._optimisticResults&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:b,status:v}=f;r=f.data;let R=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===v){let e;o?.isPlaceholderData&&t.placeholderData===d?.placeholderData?(e=o.data,R=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,void 0!==e&&(v="success",r=(0,l.replaceData)(o?.data,e,t),g=!0)}if(t.select&&void 0!==r&&!R)if(o&&r===c?.data&&t.select===this.#o)r=this.#c;else try{this.#o=t.select,r=t.select(r),r=(0,l.replaceData)(o?.data,r,t),this.#c=r,this.#t=null}catch(e){this.#t=e}this.#t&&(y=this.#t,r=this.#c,b=Date.now(),v="error");let j="fetching"===f.fetchStatus,w="pending"===v,N="error"===v,Q=w&&j,S=void 0!==r,T={status:v,fetchStatus:f.fetchStatus,isPending:w,isSuccess:"success"===v,isError:N,isInitialLoading:Q,isLoading:Q,data:r,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:b,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>m.dataUpdateCount||f.errorUpdateCount>m.errorUpdateCount,isFetching:j,isRefetching:j&&!w,isLoadingError:N&&!S,isPaused:"paused"===f.fetchStatus,isPlaceholderData:g,isRefetchError:N&&S,isStale:p(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,l.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===T.status?e.reject(T.error):void 0!==T.data&&e.resolve(T.data)},r=()=>{t(this.#r=T.promise=(0,n.pendingThenable)())},a=this.#r;switch(a.status){case"pending":e.queryHash===s.queryHash&&t(a);break;case"fulfilled":("error"===T.status||T.data!==a.value)&&r();break;case"rejected":("error"!==T.status||T.error!==a.reason)&&r()}}return T}updateResult(){let e=this.#i,t=this.createResult(this.#s,this.options);if(this.#n=this.#s.state,this.#l=this.options,void 0!==this.#n.data&&(this.#u=this.#s),(0,l.shallowEqualObjects)(t,e))return;this.#i=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#m.size)return!0;let s=new Set(r??this.#m);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&s.has(t))};this.#w({listeners:r()})}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#s)return;let t=this.#s;this.#s=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#w(e){s.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#s,type:"observerResultsUpdated"})})}};function u(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&d(e,t,t.refetchOnMount)}function d(e,t,r){if(!1!==(0,l.resolveEnabled)(t.enabled,e)&&"static"!==(0,l.resolveStaleTime)(t.staleTime,e)){let s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&p(e,t)}return!1}function h(e,t,r,s){return(e!==t||!1===(0,l.resolveEnabled)(s.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&p(e,r)}function p(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,l.resolveStaleTime)(t.staleTime,e))}e.i(47167);var m=e.i(71645),x=e.i(12598);e.i(43476);var f=m.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),g=m.createContext(!1);g.Provider;var y=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function b(e,t){return function(e,t,r){let a,i=m.useContext(g),n=m.useContext(f),o=(0,x.useQueryClient)(r),c=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(c);let u=o.getQueryCache().get(c.queryHash);if(c._optimisticResults=i?"isRestoring":"optimistic",c.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=c.staleTime;c.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof c.gcTime&&(c.gcTime=Math.max(c.gcTime,1e3))}a=u?.state.error&&"function"==typeof c.throwOnError?(0,l.shouldThrowError)(c.throwOnError,[u.state.error,u]):c.throwOnError,(c.suspense||c.experimental_prefetchInRender||a)&&!n.isReset()&&(c.retryOnMount=!1),m.useEffect(()=>{n.clearReset()},[n]);let d=!o.getQueryCache().get(c.queryHash),[h]=m.useState(()=>new t(o,c)),p=h.getOptimisticResult(c),b=!i&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback(e=>{let t=b?h.subscribe(s.notifyManager.batchCalls(e)):l.noop;return h.updateResult(),t},[h,b]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),m.useEffect(()=>{h.setOptions(c)},[c,h]),c?.suspense&&p.isPending)throw y(c,h,n);if((({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(a&&void 0===e.data||(0,l.shouldThrowError)(r,[e.error,s])))({result:p,errorResetBoundary:n,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;if(o.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!l.isServer&&p.isLoading&&p.isFetching&&!i){let e=d?y(c,h,n):u?.promise;e?.catch(l.noop).finally(()=>{h.updateResult()})}return c.notifyOnChangeProps?p:h.trackResult(p)}(e,c,t)}e.s(["useQuery",()=>b],66027)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},12426,e=>{"use strict";let t=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],12426)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},23261,e=>{"use strict";var t=e.i(43476),r=e.i(1928),s=e.i(12426),a=e.i(88844),i=e.i(25652),n=e.i(3116),l=e.i(63059),o=e.i(78894),c=e.i(22016),u=e.i(18566),d=e.i(66027),h=e.i(47163);function p(){let e=(0,u.useRouter)(),{data:p,isLoading:m}=(0,d.useQuery)({queryKey:["admin","dashboard"],queryFn:async()=>{let e=localStorage.getItem("admin_token"),t=JSON.parse(localStorage.getItem("admin_data")||"{}"),r=await fetch(`${h.API_URL}/api/admin/dashboard`,{headers:{Authorization:`Bearer ${e}`,"X-Admin-Id":t.id}});if(!r.ok)throw Error("Failed to fetch dashboard");return r.json()}});if(m)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-black"})});let x=[{label:"Commandes Aujourd'hui",value:p?.orders.today||0,icon:r.ShoppingCart,color:"text-blue-600",bg:"bg-blue-50"},{label:"En Attente",value:p?.orders.pending||0,icon:n.Clock,color:"text-orange-600",bg:"bg-orange-50"},{label:"Revenus Aujourd'hui",value:`${(p?.revenue.today||0).toLocaleString()} F`,icon:s.DollarSign,color:"text-emerald-600",bg:"bg-emerald-50"},{label:"Revenus Total",value:`${(p?.revenue.total||0).toLocaleString()} F`,icon:i.TrendingUp,color:"text-purple-600",bg:"bg-purple-50"}];return(0,t.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-700",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Tableau de Bord"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1",children:"Bon retour ! Voici ce qui se passe sur votre boutique aujourd'hui."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 bg-white px-4 py-2 rounded-2xl shadow-sm border border-gray-100",children:[(0,t.jsx)(n.Clock,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:new Date().toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((e,r)=>{let s=e.icon;return(0,t.jsxs)("div",{className:"group bg-white rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-gray-100/50 p-6 hover:shadow-[0_8px_30px_rgb(0,0,0,0.08)] transition-all duration-300 hover:-translate-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:`${e.bg} ${e.color} p-3 rounded-2xl transition-colors duration-300`,children:(0,t.jsx)(s,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"text-[10px] font-bold uppercase tracking-wider text-gray-400 bg-gray-50 px-2 py-1 rounded-full",children:"Direct"})]}),(0,t.jsx)("p",{className:"text-3xl font-black text-gray-900 tracking-tight",children:e.value}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-500 mt-1 lowercase first-letter:uppercase",children:e.label})]},r)})}),(0,t.jsxs)("div",{className:"bg-white rounded-[2rem] shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-gray-100/50 overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-8 py-6 border-b border-gray-50 flex items-center justify-between bg-white/50 backdrop-blur-sm sticky top-0 z-10",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Commandes Récentes"}),(0,t.jsxs)(c.default,{href:"/admin/orders",className:"text-sm font-bold text-blue-600 hover:text-blue-700 flex items-center gap-1 group",children:["Voir tout ",(0,t.jsx)(l.ChevronRight,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50/50",children:[(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Commande"}),(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Client"}),(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Montant"}),(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Confiance"}),(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Statut"}),(0,t.jsx)("th",{className:"px-8 py-4 text-left text-[11px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:"Date"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-50",children:p?.recentOrders?.length?p.recentOrders.map(r=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50/80 transition-colors group cursor-pointer",onClick:()=>e.push(`/admin/orders/${r.id}`),children:[(0,t.jsx)("td",{className:"px-8 py-5",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center",children:(0,t.jsx)(a.Package,{className:"w-4 h-4 text-gray-500"})}),(0,t.jsxs)("span",{className:"text-sm font-mono text-gray-600 bg-gray-50 px-2 py-0.5 rounded border border-gray-100",children:["#",r.id.substring(0,6).toUpperCase()]})]})}),(0,t.jsxs)("td",{className:"px-8 py-5",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-gray-900",children:r.customer_name}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:r.customer_phone})]}),(0,t.jsx)("td",{className:"px-8 py-5",children:(0,t.jsxs)("span",{className:"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-1 rounded-full border border-gray-100",children:[r.total?.toLocaleString()," F"]})}),(0,t.jsx)("td",{className:"px-8 py-5",children:null!==r.trust_score&&void 0!==r.trust_score?(0,t.jsxs)("div",{className:"w-32",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,t.jsxs)("span",{className:`text-[10px] font-black uppercase ${r.trust_score>=80?"text-emerald-600":r.trust_score>=50?"text-orange-600":"text-red-600"}`,children:[r.trust_score,"%"]})}),(0,t.jsx)("div",{className:"h-1.5 w-full bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:`h-full transition-all duration-1000 ${r.trust_score>=80?"bg-emerald-500":r.trust_score>=50?"bg-orange-500":"bg-red-500"}`,style:{width:`${r.trust_score}%`}})})]}):(0,t.jsx)("span",{className:"text-[10px] font-bold text-gray-300 uppercase italic",children:"Non calculé"})}),(0,t.jsx)("td",{className:"px-8 py-5",children:(0,t.jsxs)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold tracking-tight ${"completed"===r.status||"delivered"===r.status?"bg-emerald-50 text-emerald-700 border border-emerald-100":"pending"===r.status||"processing"===r.status?"bg-orange-50 text-orange-700 border border-orange-100":"bg-gray-50 text-gray-600 border border-gray-100"}`,children:[(0,t.jsx)("span",{className:`w-1.5 h-1.5 rounded-full mr-2 ${"completed"===r.status||"delivered"===r.status?"bg-emerald-500":"pending"===r.status||"processing"===r.status?"bg-orange-500 animate-pulse":"bg-gray-400"}`}),"pending"===r.status?"En attente":"processing"===r.status?"Traitement":"shipped"===r.status?"Expédié":"delivered"===r.status?"Livré":"completed"===r.status?"Terminé":r.status]})}),(0,t.jsx)("td",{className:"px-8 py-5",children:(0,t.jsx)("span",{className:"text-xs font-medium text-gray-400",children:new Date(r.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"})})})]},r.id)):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"px-8 py-20 text-center text-gray-400 bg-gray-50/30",children:(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)(r.ShoppingCart,{className:"w-12 h-12 mb-4 opacity-10"}),(0,t.jsx)("p",{className:"font-medium",children:"Aucune commande récente à afficher"})]})})})})]})})]}),(p?.notifications?.dlqCount??0)>0&&p&&(0,t.jsxs)("div",{className:"group bg-red-50/50 border border-red-100 rounded-[2rem] p-6 flex items-center justify-between gap-6 hover:bg-red-50 transition-colors duration-300",children:[(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsx)("div",{className:"bg-red-500 shadow-lg shadow-red-200 p-3 rounded-2xl group-hover:scale-110 transition-transform duration-300",children:(0,t.jsx)(o.AlertTriangle,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-lg font-bold text-red-900",children:["Attention : ",p.notifications.dlqCount," notification(s) en échec"]}),(0,t.jsx)("p",{className:"text-sm text-red-700/70",children:"Certaines actions automatiques n'ont pas pu être délivrées. Veuillez vérifier la file d'attente."})]})]}),(0,t.jsx)(c.default,{href:"/admin/dlq",className:"px-6 py-2.5 bg-red-900 text-white text-sm font-bold rounded-xl hover:bg-red-950 transition-all active:scale-95 shadow-lg shadow-red-900/20",children:"Résoudre les erreurs"})]})]})}e.s(["default",()=>p])}]);