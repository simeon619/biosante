module.exports=[75767,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(14548),f=a.i(210),g=a.i(96221),h=a.i(73320),i=a.i(81560),j=a.i(15618),k=a.i(49625),k=k,l=a.i(97063),m=a.i(90166),n=a.i(83497),o=a.i(67453),p=a.i(70106);let q=(0,p.default)("panels-top-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]),r=(0,p.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),s=(0,p.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var t=a.i(33217),u=a.i(70025),v=a.i(37927),w=a.i(97895);function x({productId:a,isNew:p}){let x=(0,d.useRouter)(),y=(0,v.useQueryClient)(),[z,A]=(0,c.useState)("general"),[B,C]=(0,c.useState)({id:"",name:"",price:0,stock:0,description:"",is_active:!0,image:"",ingredients_image:"",infographic_image:"",gallery:[],tagline:"",category:"",benefits:"",theme_color:"green",display_order:0}),[D,E]=(0,c.useState)(null),{isLoading:F}=(0,t.useQuery)({queryKey:["admin","products",a],queryFn:async()=>{let b=await fetch(`${w.API_URL}/api/admin/products/${a}`,{cache:"no-store"});if(!b.ok)throw Error("Failed to fetch product");let c=await b.json();if(c.product){let a=c.product;C({...a,benefits:Array.isArray(a.benefits)?a.benefits.join(", "):a.benefits||"",gallery:Array.isArray(a.gallery)?a.gallery:[]})}return c.product},enabled:!p&&!!a,refetchOnWindowFocus:!1}),G=!p&&F,H=async(a,b)=>{let c=a.target.files?.[0];if(!c)return void console.log("[ProductEditor] No file selected");console.log(`[ProductEditor] Uploading file to slot: ${b}, file: ${c.name}, size: ${c.size}`),E(b);let d=new FormData;d.append("image",c);try{let a=await fetch(`${w.API_URL}/api/admin/uploads/image`,{method:"POST",body:d});if(console.log(`[ProductEditor] Upload response status: ${a.status}`),a.ok){let c=await a.json();console.log(`[ProductEditor] Upload successful, URL: ${c.url}`),"gallery"===b?C(a=>({...a,gallery:[...a.gallery,c.url]})):C(a=>({...a,[b]:c.url}))}else{let b=await a.json();console.error("[ProductEditor] Upload failed:",b),alert(`Erreur d'upload: ${b.error||"Erreur inconnue"}`)}}catch(a){console.error("[ProductEditor] Upload error:",a),alert("Ã‰chec de la connexion au serveur pour l'upload.")}finally{E(null)}},I=(0,u.useMutation)({mutationFn:async b=>{let c=p?`${w.API_URL}/api/admin/products`:`${w.API_URL}/api/admin/products/${a}`,d=await fetch(c,{method:p?"POST":"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!d.ok)throw Error((await d.json()).error||"Erreur lors de la sauvegarde");return d.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["admin","products"]}),p||y.invalidateQueries({queryKey:["admin","products",a]}),alert("Produit enregistrÃ© avec succÃ¨s !"),x.push("/admin/products"),x.refresh()},onError:a=>{alert(a.message)}}),J=async a=>{a.preventDefault();let b={...B,benefits:B.benefits.split(",").map(a=>a.trim()).filter(a=>""!==a)};I.mutate(b)};if(G)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)(g.Loader2,{className:"w-12 h-12 animate-spin text-black"})});let K=[{id:"general",label:"Infos GÃ©nÃ©rales",icon:l.Info},{id:"media",label:"Photos & MÃ©dias",icon:k.default},{id:"pricing",label:"Prix & Stock",icon:m.DollarSign},{id:"content",label:"Contraires & Bienfaits",icon:q}],L=({slot:a,label:c,sublabel:d,value:e})=>(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold text-gray-900",children:c}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:d})]}),e&&(0,b.jsx)("button",{type:"button",onClick:()=>C(b=>({...b,[a]:""})),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg transition-colors",children:(0,b.jsx)(i.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:`relative aspect-video rounded-xl border-2 border-dashed transition-all flex items-center justify-center overflow-hidden bg-gray-50 ${e?"border-transparent":"border-gray-200"}`,children:e?(0,b.jsx)("img",{src:e,alt:c,className:"w-full h-full object-contain"}):(0,b.jsxs)("label",{className:"w-full h-full flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 transition-colors",children:[D===a?(0,b.jsx)(g.Loader2,{className:"w-8 h-8 animate-spin text-gray-400"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Upload,{className:"w-8 h-8 text-gray-400 mb-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Cliquez pour uploader"})]}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:b=>H(b,a),disabled:!!D})]})})]});return(0,b.jsxs)("form",{onSubmit:J,className:"max-w-5xl mx-auto space-y-8 pb-20",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-30 flex items-center justify-between bg-gray-50/80 backdrop-blur-md py-4 border-b border-gray-100 mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>x.back(),className:"p-2 hover:bg-white rounded-xl transition-all shadow-sm border border-gray-100",children:(0,b.jsx)(f.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:p?"Nouveau Produit":`Modifier ${B.name}`}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Haut du catalogue â€¢ ",B.id||"slug-automatique"]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsxs)("button",{type:"submit",disabled:I.isPending,className:"flex items-center gap-2 bg-black text-white px-6 py-2.5 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg shadow-black/10 disabled:opacity-50",children:[I.isPending?(0,b.jsx)(g.Loader2,{className:"w-5 h-5 animate-spin"}):(0,b.jsx)(e.Save,{className:"w-5 h-5"}),p?"CrÃ©er le produit":"Enregistrer les modifications"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,b.jsx)("div",{className:"md:col-span-1 space-y-2",children:K.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>A(a.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all ${z===a.id?"bg-black text-white shadow-lg shadow-black/10 scale-[1.02]":"text-gray-500 hover:bg-white"}`,children:[(0,b.jsx)(a.icon,{className:"w-5 h-5"}),a.label]},a.id))}),(0,b.jsxs)("div",{className:"md:col-span-3 space-y-8",children:["general"===z&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(l.Info,{className:"w-6 h-6 text-blue-500"}),"Informations de base"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[p&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Identifiant Unique (Slug)"}),(0,b.jsx)("input",{type:"text",value:B.id,onChange:a=>C({...B,id:a.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: bioactif",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Nom du Produit"}),(0,b.jsx)("input",{type:"text",value:B.name,onChange:a=>C({...B,name:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Description Commerciale"}),(0,b.jsx)("textarea",{value:B.description,onChange:a=>C({...B,description:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all min-h-[150px] resize-none",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Slogan"}),(0,b.jsx)("input",{type:"text",value:B.tagline,onChange:a=>C({...B,tagline:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: DIABÃˆTE â€¢ HYPERTENSION"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"CatÃ©gorie"}),(0,b.jsx)("input",{type:"text",value:B.category,onChange:a=>C({...B,category:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: HYPERTENSION"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[(0,b.jsx)(r,{className:"w-4 h-4"}),"Couleur du ThÃ¨me"]}),(0,b.jsxs)("select",{value:B.theme_color,onChange:a=>C({...B,theme_color:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",children:[(0,b.jsx)("option",{value:"red",children:"ðŸ”´ Rouge"}),(0,b.jsx)("option",{value:"green",children:"ðŸŸ¢ Vert"}),(0,b.jsx)("option",{value:"blue",children:"ðŸ”µ Bleu"}),(0,b.jsx)("option",{value:"yellow",children:"ðŸŸ¡ Jaune"}),(0,b.jsx)("option",{value:"orange",children:"ðŸŸ  Orange"}),(0,b.jsx)("option",{value:"purple",children:"ðŸŸ£ Violet"}),(0,b.jsx)("option",{value:"pink",children:"ðŸ’— Rose"}),(0,b.jsx)("option",{value:"teal",children:"ðŸ©µ Turquoise"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Couleur des textes et bordures sur la page d'accueil"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[(0,b.jsx)(s,{className:"w-4 h-4"}),"Ordre d'Affichage"]}),(0,b.jsx)("input",{type:"number",min:"0",value:B.display_order,onChange:a=>C({...B,display_order:parseInt(a.target.value)||0}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Plus petit = affichÃ© en premier sur l'accueil"})]})]})]})]}),"media"===z&&(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(L,{slot:"image",label:"Photo Principale",sublabel:"AffichÃ©e dans les listes et en tÃªte de page (Flacon/Packshot)",value:B.image}),(0,b.jsx)(L,{slot:"ingredients_image",label:"DÃ©tails IngrÃ©dients",sublabel:"Photo expliquant la composition naturelle du produit",value:B.ingredients_image}),(0,b.jsx)(L,{slot:"infographic_image",label:"Infographie",sublabel:"Tableau ou graphique explicatif sur les bienfaits",value:B.infographic_image})]}),(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(k.default,{className:"w-6 h-6 text-purple-500"}),"Galerie Lifestyle"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[B.gallery.map((a,c)=>(0,b.jsxs)("div",{className:"relative aspect-square rounded-2xl border border-gray-100 overflow-hidden group",children:[(0,b.jsx)("img",{src:a,alt:`Gallery ${c}`,className:"w-full h-full object-cover"}),(0,b.jsx)("button",{type:"button",onClick:()=>{C(a=>({...a,gallery:a.gallery.filter((a,b)=>b!==c)}))},className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(i.Trash2,{className:"w-4 h-4"})})]},c)),(0,b.jsxs)("label",{className:"aspect-square rounded-2xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors",children:["gallery"===D?(0,b.jsx)(g.Loader2,{className:"w-6 h-6 animate-spin text-gray-400"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Plus,{className:"w-6 h-6 text-gray-400 mb-1"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Ajouter"})]}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:a=>H(a,"gallery"),disabled:!!D})]})]})]})]}),"pricing"===z&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(m.DollarSign,{className:"w-6 h-6 text-green-500"}),"Inventaire & Prix"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-2xl space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-black text-white rounded-xl",children:(0,b.jsx)(m.DollarSign,{className:"w-5 h-5"})}),(0,b.jsx)("label",{className:"font-bold text-gray-700",children:"Prix de vente (FCFA)"})]}),(0,b.jsx)("input",{type:"number",value:B.price,onChange:a=>C({...B,price:parseInt(a.target.value)}),className:"w-full text-3xl font-bold bg-transparent border-none outline-none focus:ring-0",required:!0}),(0,b.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Prix affichÃ© sur le site public."})]}),(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-2xl space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-black text-white rounded-xl",children:(0,b.jsx)(n.Package,{className:"w-5 h-5"})}),(0,b.jsx)("label",{className:"font-bold text-gray-700",children:"Stock disponible"})]}),(0,b.jsx)("input",{type:"number",value:B.stock,onChange:a=>C({...B,stock:parseInt(a.target.value)}),className:"w-full text-3xl font-bold bg-transparent border-none outline-none focus:ring-0",required:!0}),(0,b.jsx)("p",{className:"text-sm text-gray-500 italic",children:'QuantitÃ© restante avant "Indisponible".'})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-4 pt-4",children:(0,b.jsxs)("div",{className:"flex-1 p-6 bg-gray-50 rounded-2xl flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`p-2 rounded-xl ${B.is_active?"bg-green-100 text-green-600":"bg-gray-200 text-gray-500"}`,children:(0,b.jsx)(o.CheckCircle2,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-gray-700",children:"Statut de VisibilitÃ©"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:B.is_active?"Visible sur le site":"MasquÃ© pour les clients"})]})]}),(0,b.jsx)("button",{type:"button",onClick:()=>C(a=>({...a,is_active:!a.is_active})),className:`w-14 h-8 rounded-full transition-all relative ${B.is_active?"bg-black":"bg-gray-300"}`,children:(0,b.jsx)("div",{className:`absolute top-1 w-6 h-6 bg-white rounded-full transition-all ${B.is_active?"right-1":"left-1"}`})})]})})]}),"content"===z&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(q,{className:"w-6 h-6 text-orange-500"}),"Contenu DÃ©taillÃ©"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Liste des Bienfaits"}),(0,b.jsx)("textarea",{value:B.benefits,onChange:a=>C({...B,benefits:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all min-h-[120px]",placeholder:"SÃ©parez les bienfaits par des virgules (ex: 100% Naturel, Ã‰nergie pure...)"}),(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:B.benefits.split(",").map((a,c)=>a.trim()&&(0,b.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-medium",children:a.trim()},c))})]})]})]})]})]})}a.s(["default",()=>x],75767)}];

//# sourceMappingURL=components_admin_ProductEditor_tsx_90afa819._.js.map