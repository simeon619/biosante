module.exports=[75767,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(14548),f=a.i(210),g=a.i(96221),h=a.i(70106);let i=(0,h.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var j=a.i(81560),k=a.i(15618);let l=(0,h.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var m=a.i(97063),n=a.i(90166),o=a.i(83497),p=a.i(67453);let q=(0,h.default)("panels-top-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);function r({productId:a,isNew:h}){let r=(0,d.useRouter)(),[s,t]=(0,c.useState)(!h),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)("general"),[y,z]=(0,c.useState)({id:"",name:"",price:0,stock:0,description:"",is_active:!0,image:"",ingredients_image:"",infographic_image:"",gallery:[],tagline:"",category:"",benefits:""}),[A,B]=(0,c.useState)(null);(0,c.useEffect)(()=>{!h&&a&&C()},[a,h]);let C=async()=>{try{let b=await fetch(`http://localhost:3333/api/admin/products/${a}`,{cache:"no-store"}),c=await b.json();if(console.log("[ProductEditor] Fetched product data:",c.product),c.product){let a=c.product;z({...a,benefits:Array.isArray(a.benefits)?a.benefits.join(", "):a.benefits||"",gallery:Array.isArray(a.gallery)?a.gallery:[]})}}catch(a){console.error("Failed to fetch product:",a)}finally{t(!1)}},D=async(a,b)=>{let c=a.target.files?.[0];if(!c)return void console.log("[ProductEditor] No file selected");console.log(`[ProductEditor] Uploading file to slot: ${b}, file: ${c.name}, size: ${c.size}`),B(b);let d=new FormData;d.append("image",c);try{let a=await fetch("http://localhost:3333/api/admin/uploads/image",{method:"POST",body:d});if(console.log(`[ProductEditor] Upload response status: ${a.status}`),a.ok){let c=await a.json();console.log(`[ProductEditor] Upload successful, URL: ${c.url}`),"gallery"===b?z(a=>({...a,gallery:[...a.gallery,c.url]})):z(a=>({...a,[b]:c.url}))}else{let b=await a.json();console.error("[ProductEditor] Upload failed:",b),alert(`Erreur d'upload: ${b.error||"Erreur inconnue"}`)}}catch(a){console.error("[ProductEditor] Upload error:",a),alert("Échec de la connexion au serveur pour l'upload.")}finally{B(null)}},E=async b=>{b.preventDefault(),v(!0);try{let b=h?"http://localhost:3333/api/admin/products":`http://localhost:3333/api/admin/products/${a}`,c={...y,benefits:y.benefits.split(",").map(a=>a.trim()).filter(a=>""!==a)};console.log("[ProductEditor] Sending payload:",c);let d=await fetch(b,{method:h?"POST":"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(d.ok)console.log("[ProductEditor] Save successful"),alert("Produit enregistré avec succès !"),r.push("/admin/products"),r.refresh();else{let a=await d.json();alert(a.error||"Erreur lors de la sauvegarde")}}catch(a){console.error("Save error:",a),alert("Erreur réseau lors de la sauvegarde")}finally{v(!1)}};if(s)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)(g.Loader2,{className:"w-12 h-12 animate-spin text-black"})});let F=[{id:"general",label:"Infos Générales",icon:m.Info},{id:"media",label:"Photos & Médias",icon:l},{id:"pricing",label:"Prix & Stock",icon:n.DollarSign},{id:"content",label:"Contraires & Bienfaits",icon:q}],G=({slot:a,label:c,sublabel:d,value:e})=>(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold text-gray-900",children:c}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:d})]}),e&&(0,b.jsx)("button",{type:"button",onClick:()=>z(b=>({...b,[a]:""})),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg transition-colors",children:(0,b.jsx)(j.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:`relative aspect-video rounded-xl border-2 border-dashed transition-all flex items-center justify-center overflow-hidden bg-gray-50 ${e?"border-transparent":"border-gray-200"}`,children:e?(0,b.jsx)("img",{src:e,alt:c,className:"w-full h-full object-contain"}):(0,b.jsxs)("label",{className:"w-full h-full flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 transition-colors",children:[A===a?(0,b.jsx)(g.Loader2,{className:"w-8 h-8 animate-spin text-gray-400"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i,{className:"w-8 h-8 text-gray-400 mb-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Cliquez pour uploader"})]}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:b=>D(b,a),disabled:!!A})]})})]});return(0,b.jsxs)("form",{onSubmit:E,className:"max-w-5xl mx-auto space-y-8 pb-20",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-30 flex items-center justify-between bg-gray-50/80 backdrop-blur-md py-4 border-b border-gray-100 mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>r.back(),className:"p-2 hover:bg-white rounded-xl transition-all shadow-sm border border-gray-100",children:(0,b.jsx)(f.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:h?"Nouveau Produit":`Modifier ${y.name}`}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Haut du catalogue • ",y.id||"slug-automatique"]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsxs)("button",{type:"submit",disabled:u,className:"flex items-center gap-2 bg-black text-white px-6 py-2.5 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg shadow-black/10 disabled:opacity-50",children:[u?(0,b.jsx)(g.Loader2,{className:"w-5 h-5 animate-spin"}):(0,b.jsx)(e.Save,{className:"w-5 h-5"}),h?"Créer le produit":"Enregistrer les modifications"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,b.jsx)("div",{className:"md:col-span-1 space-y-2",children:F.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>x(a.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl font-medium transition-all ${w===a.id?"bg-black text-white shadow-lg shadow-black/10 scale-[1.02]":"text-gray-500 hover:bg-white"}`,children:[(0,b.jsx)(a.icon,{className:"w-5 h-5"}),a.label]},a.id))}),(0,b.jsxs)("div",{className:"md:col-span-3 space-y-8",children:["general"===w&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(m.Info,{className:"w-6 h-6 text-blue-500"}),"Informations de base"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[h&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Identifiant Unique (Slug)"}),(0,b.jsx)("input",{type:"text",value:y.id,onChange:a=>z({...y,id:a.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: bioactif",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Nom du Produit"}),(0,b.jsx)("input",{type:"text",value:y.name,onChange:a=>z({...y,name:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Description Commerciale"}),(0,b.jsx)("textarea",{value:y.description,onChange:a=>z({...y,description:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all min-h-[150px] resize-none",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Slogan"}),(0,b.jsx)("input",{type:"text",value:y.tagline,onChange:a=>z({...y,tagline:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: DIABÈTE • HYPERTENSION"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Catégorie"}),(0,b.jsx)("input",{type:"text",value:y.category,onChange:a=>z({...y,category:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"ex: HYPERTENSION"})]})]})]})]}),"media"===w&&(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(G,{slot:"image",label:"Photo Principale",sublabel:"Affichée dans les listes et en tête de page (Flacon/Packshot)",value:y.image}),(0,b.jsx)(G,{slot:"ingredients_image",label:"Détails Ingrédients",sublabel:"Photo expliquant la composition naturelle du produit",value:y.ingredients_image}),(0,b.jsx)(G,{slot:"infographic_image",label:"Infographie",sublabel:"Tableau ou graphique explicatif sur les bienfaits",value:y.infographic_image})]}),(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(l,{className:"w-6 h-6 text-purple-500"}),"Galerie Lifestyle"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[y.gallery.map((a,c)=>(0,b.jsxs)("div",{className:"relative aspect-square rounded-2xl border border-gray-100 overflow-hidden group",children:[(0,b.jsx)("img",{src:a,alt:`Gallery ${c}`,className:"w-full h-full object-cover"}),(0,b.jsx)("button",{type:"button",onClick:()=>{z(a=>({...a,gallery:a.gallery.filter((a,b)=>b!==c)}))},className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(j.Trash2,{className:"w-4 h-4"})})]},c)),(0,b.jsxs)("label",{className:"aspect-square rounded-2xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors",children:["gallery"===A?(0,b.jsx)(g.Loader2,{className:"w-6 h-6 animate-spin text-gray-400"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Plus,{className:"w-6 h-6 text-gray-400 mb-1"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Ajouter"})]}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:a=>D(a,"gallery"),disabled:!!A})]})]})]})]}),"pricing"===w&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(n.DollarSign,{className:"w-6 h-6 text-green-500"}),"Inventaire & Prix"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-2xl space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-black text-white rounded-xl",children:(0,b.jsx)(n.DollarSign,{className:"w-5 h-5"})}),(0,b.jsx)("label",{className:"font-bold text-gray-700",children:"Prix de vente (FCFA)"})]}),(0,b.jsx)("input",{type:"number",value:y.price,onChange:a=>z({...y,price:parseInt(a.target.value)}),className:"w-full text-3xl font-bold bg-transparent border-none outline-none focus:ring-0",required:!0}),(0,b.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Prix affiché sur le site public."})]}),(0,b.jsxs)("div",{className:"bg-gray-50 p-6 rounded-2xl space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-black text-white rounded-xl",children:(0,b.jsx)(o.Package,{className:"w-5 h-5"})}),(0,b.jsx)("label",{className:"font-bold text-gray-700",children:"Stock disponible"})]}),(0,b.jsx)("input",{type:"number",value:y.stock,onChange:a=>z({...y,stock:parseInt(a.target.value)}),className:"w-full text-3xl font-bold bg-transparent border-none outline-none focus:ring-0",required:!0}),(0,b.jsx)("p",{className:"text-sm text-gray-500 italic",children:'Quantité restante avant "Indisponible".'})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-4 pt-4",children:(0,b.jsxs)("div",{className:"flex-1 p-6 bg-gray-50 rounded-2xl flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`p-2 rounded-xl ${y.is_active?"bg-green-100 text-green-600":"bg-gray-200 text-gray-500"}`,children:(0,b.jsx)(p.CheckCircle2,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-gray-700",children:"Statut de Visibilité"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:y.is_active?"Visible sur le site":"Masqué pour les clients"})]})]}),(0,b.jsx)("button",{type:"button",onClick:()=>z(a=>({...a,is_active:!a.is_active})),className:`w-14 h-8 rounded-full transition-all relative ${y.is_active?"bg-black":"bg-gray-300"}`,children:(0,b.jsx)("div",{className:`absolute top-1 w-6 h-6 bg-white rounded-full transition-all ${y.is_active?"right-1":"left-1"}`})})]})})]}),"content"===w&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-xl shadow-gray-200/50 space-y-6",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(q,{className:"w-6 h-6 text-orange-500"}),"Contenu Détaillé"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Liste des Bienfaits"}),(0,b.jsx)("textarea",{value:y.benefits,onChange:a=>z({...y,benefits:a.target.value}),className:"w-full px-5 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:ring-2 focus:ring-black outline-none transition-all min-h-[120px]",placeholder:"Séparez les bienfaits par des virgules (ex: 100% Naturel, Énergie pure...)"}),(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:y.benefits.split(",").map((a,c)=>a.trim()&&(0,b.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-medium",children:a.trim()},c))})]})]})]})]})]})}a.s(["default",()=>r],75767)}];

//# sourceMappingURL=components_admin_ProductEditor_tsx_90afa819._.js.map