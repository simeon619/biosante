module.exports=[10390,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(24669);let e=(0,a.i(70106).default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var f=a.i(38784),g=a.i(90166),h=a.i(83497),i=a.i(41675),j=a.i(69520),k=a.i(96221),l=a.i(5784),m=a.i(33508),n=a.i(32860),o=a.i(41710),p=a.i(67453),q=a.i(62722),r=a.i(90669);let s=[{label:"Aujourd'hui",days:0},{label:"Hier",days:1},{label:"7 derniers jours",days:7},{label:"30 derniers jours",days:30},{label:"90 derniers jours",days:90},{label:"Cette année",days:365}];function t(){let a,[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(()=>{let a=new Date;return a.setDate(a.getDate()-30),a}),[B,C]=(0,c.useState)(new Date),[D,E]=(0,c.useState)(!1),F=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=a=>{F.current&&!F.current.contains(a.target)&&E(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let G=async()=>{w(!0),y("");try{let a={"X-Admin-Id":JSON.parse(localStorage.getItem("admin_data")||"{}").id},[b,c,d]=await Promise.all([fetch("http://localhost:3333/api/admin/dashboard",{headers:a}),fetch("http://localhost:3333/api/admin/orders?limit=1000",{headers:a}),fetch("http://localhost:3333/api/admin/products",{headers:a})]);await b.json();let e=await c.json(),f=await d.json(),g=e.orders||e.data||[],h=g.filter(a=>{let b=new Date(a.created_at);return b>=z&&b<=B}),i=h.filter(a=>["paid","delivered","completed"].includes(a.status)),j=h.filter(a=>"pending"===a.status),k=h.filter(a=>"cancelled"===a.status),l=h.filter(a=>["processing","shipped"].includes(a.status)),m=i.reduce((a,b)=>a+(parseFloat(b.total)||0),0),n=i.length>0?m/i.length:0,o=Array.isArray(f)?f:Array.isArray(f?.data)?f.data:[],p={};h.forEach(a=>{try{let b="string"==typeof a.items?JSON.parse(a.items):a.items;Array.isArray(b)&&b.forEach(a=>{let b=a.slug||a.name||"unknown";p[b]||(p[b]={name:a.name||"Produit",quantity:0,revenue:0}),p[b].quantity+=a.quantity||1,p[b].revenue+=(parseFloat(a.price)||0)*(parseInt(a.quantity)||1)})}catch(a){}});let q=Object.values(p).sort((a,b)=>b.revenue-a.revenue).slice(0,5),r={};h.forEach(a=>{let b=new Date(a.created_at).toISOString().split("T")[0];r[b]||(r[b]={orders:0,revenue:0}),r[b].orders++,["paid","delivered","completed"].includes(a.status)&&(r[b].revenue+=parseFloat(a.total)||0)});let s=Object.entries(r).map(([a,b])=>({date:a,...b})).sort((a,b)=>a.date.localeCompare(b.date)),t=h.slice(0,8).map(a=>({id:a.id,customer:a.customer_name||"Client",total:a.total||0,status:a.status,date:new Date(a.created_at).toLocaleDateString("fr-FR")})),v=Math.ceil((B.getTime()-z.getTime())/864e5),w=new Date(z);w.setDate(w.getDate()-1);let x=new Date(w);x.setDate(x.getDate()-v);let y=g.filter(a=>{let b=new Date(a.created_at);return b>=x&&b<=w}).filter(a=>["paid","delivered","completed"].includes(a.status)).reduce((a,b)=>a+(parseFloat(b.total)||0),0),A=y>0?Math.round((m-y)/y*100):100*(m>0);u({orders:{total:h.length,pending:j.length,completed:i.length,cancelled:k.length,processing:l.length},revenue:{total:m,average:n,previousTotal:y,trend:A},products:{total:o.length,active:o.filter(a=>a.is_active).length},topProducts:q,recentOrders:t,dailyData:s})}catch(a){y(a.message||"Erreur de chargement")}finally{w(!1)}};(0,c.useEffect)(()=>{G()},[z,B]);let H=a=>new Intl.NumberFormat("fr-FR").format(Math.round(a))+" F",I=t?.dailyData.length?Math.max(...t.dailyData.map(a=>a.revenue)):0;return x&&!t?(0,b.jsx)("div",{className:"min-h-[400px] flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center",children:(0,b.jsx)(q.XCircle,{className:"w-8 h-8 text-red-500"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erreur de chargement"}),(0,b.jsx)("p",{className:"text-gray-500 mb-4",children:x}),(0,b.jsx)("button",{onClick:G,className:"px-6 py-2.5 bg-black text-white rounded-xl hover:bg-gray-800 transition-all",children:"Réessayer"})]})}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Analytics"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1",children:"Tableau de bord des performances"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative",ref:F,children:[(0,b.jsxs)("button",{onClick:()=>E(!D),className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl hover:border-gray-300 transition-all shadow-sm",children:[(0,b.jsx)(i.Calendar,{className:"w-4 h-4 text-gray-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:(a=new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric"}),`${a.format(z)} - ${a.format(B)}`)}),(0,b.jsx)(l.ChevronDown,{className:`w-4 h-4 text-gray-400 transition-transform ${D?"rotate-180":""}`})]}),D&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 z-50 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:"Période"}),(0,b.jsx)("button",{onClick:()=>E(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:(0,b.jsx)(m.X,{className:"w-4 h-4 text-gray-400"})})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:s.map(a=>(0,b.jsx)("button",{onClick:()=>{var b;let c,d;return b=a.days,c=new Date,d=new Date,void(0===b?d.setHours(0,0,0,0):1===b?(d.setDate(d.getDate()-1),d.setHours(0,0,0,0),c.setDate(c.getDate()-1),c.setHours(23,59,59,999)):d.setDate(d.getDate()-b),A(d),C(c),E(!1))},className:"px-3 py-2 text-sm text-left rounded-lg hover:bg-gray-50 text-gray-700 transition-colors",children:a.label},a.label))})]}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,b.jsx)("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Personnalisé"})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"date",value:z.toISOString().split("T")[0],onChange:a=>A(new Date(a.target.value)),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none"}),(0,b.jsx)(n.ArrowRight,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,b.jsx)("input",{type:"date",value:B.toISOString().split("T")[0],onChange:a=>C(new Date(a.target.value)),className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent outline-none"})]}),(0,b.jsx)("button",{onClick:()=>E(!1),className:"w-full mt-3 px-4 py-2 bg-black text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors",children:"Appliquer"})]})]})]}),(0,b.jsx)("button",{onClick:G,disabled:v,className:"p-2.5 bg-black text-white rounded-xl hover:bg-gray-800 transition-all disabled:opacity-50",children:(0,b.jsx)(j.RefreshCw,{className:`w-4 h-4 ${v?"animate-spin":""}`})})]})]}),v&&!t?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(k.Loader2,{className:"w-10 h-10 animate-spin text-gray-300 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Chargement des données..."})]})}):t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"group relative bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center",children:(0,b.jsx)(g.DollarSign,{className:"w-6 h-6"})}),0!==t.revenue.trend&&(0,b.jsxs)("div",{className:`flex items-center gap-1 ${t.revenue.trend>=0?"text-emerald-100":"text-red-200"}`,children:[t.revenue.trend>=0?(0,b.jsx)(d.TrendingUp,{className:"w-4 h-4"}):(0,b.jsx)(e,{className:"w-4 h-4"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[t.revenue.trend>=0?"+":"",t.revenue.trend,"%"]})]})]}),(0,b.jsx)("p",{className:"text-emerald-100 text-sm font-medium",children:"Chiffre d'affaires"}),(0,b.jsx)("p",{className:"text-3xl font-bold mt-1 tracking-tight",children:H(t.revenue.total)}),(0,b.jsxs)("p",{className:"text-emerald-200 text-xs mt-2",children:["Moy. ",H(t.revenue.average)," / commande"]})]})]}),(0,b.jsxs)("div",{className:"group relative bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center",children:(0,b.jsx)(f.ShoppingCart,{className:"w-6 h-6"})}),t.orders.pending>0&&(0,b.jsxs)("span",{className:"px-2 py-1 bg-white/20 backdrop-blur rounded-full text-xs font-medium",children:[t.orders.pending," en attente"]})]}),(0,b.jsx)("p",{className:"text-blue-100 text-sm font-medium",children:"Commandes"}),(0,b.jsx)("p",{className:"text-3xl font-bold mt-1 tracking-tight",children:t.orders.total}),(0,b.jsxs)("p",{className:"text-blue-200 text-xs mt-2",children:[t.orders.completed," terminées"]})]})]}),(0,b.jsxs)("div",{className:"group relative bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-6 text-white overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center",children:(0,b.jsx)(h.Package,{className:"w-6 h-6"})})}),(0,b.jsx)("p",{className:"text-violet-100 text-sm font-medium",children:"Produits actifs"}),(0,b.jsx)("p",{className:"text-3xl font-bold mt-1 tracking-tight",children:t.products.active}),(0,b.jsxs)("p",{className:"text-violet-200 text-xs mt-2",children:["sur ",t.products.total," au total"]})]})]}),(0,b.jsxs)("div",{className:"group relative bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-6 text-white overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("div",{className:"w-12 h-12 bg-white/20 backdrop-blur rounded-xl flex items-center justify-center",children:(0,b.jsx)(r.Activity,{className:"w-6 h-6"})})}),(0,b.jsx)("p",{className:"text-amber-100 text-sm font-medium",children:"Taux de conversion"}),(0,b.jsxs)("p",{className:"text-3xl font-bold mt-1 tracking-tight",children:[t.orders.total>0?Math.round(t.orders.completed/t.orders.total*100):0,"%"]}),(0,b.jsxs)("p",{className:"text-amber-200 text-xs mt-2",children:[t.orders.cancelled," annulées"]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Évolution des revenus"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Performance journalière"})]})}),t.dailyData.length>0?(0,b.jsx)("div",{className:"h-64 flex items-end gap-1",children:t.dailyData.slice(-14).map((a,c)=>{let d=I>0?a.revenue/I*100:0;return(0,b.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-2 group h-full",children:[(0,b.jsx)("div",{className:"w-full flex flex-col items-end justify-end h-48",children:(0,b.jsx)("div",{className:"w-full bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-lg transition-all group-hover:from-emerald-600 group-hover:to-emerald-500 relative",style:{height:`${Math.max(d,4)}%`,minHeight:"4px"},children:(0,b.jsx)("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:H(a.revenue)})})}),(0,b.jsx)("span",{className:"text-[10px] text-gray-400 transform -rotate-45 origin-top-left whitespace-nowrap",children:new Date(a.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"})})]},c)})}):(0,b.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,b.jsx)("p",{className:"text-gray-400",children:"Aucune donnée pour cette période"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Statut des commandes"}),(0,b.jsx)("div",{className:"space-y-4",children:[{label:"Terminées",value:t.orders.completed,color:"bg-emerald-500",icon:p.CheckCircle2},{label:"En cours",value:t.orders.processing,color:"bg-blue-500",icon:o.Clock},{label:"En attente",value:t.orders.pending,color:"bg-amber-500",icon:o.Clock},{label:"Annulées",value:t.orders.cancelled,color:"bg-red-500",icon:q.XCircle}].map((a,c)=>{let d=t.orders.total>0?a.value/t.orders.total*100:0;return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a.icon,{className:`w-4 h-4 ${a.color.replace("bg-","text-")}`}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:a.label})]}),(0,b.jsx)("span",{className:"text-sm font-bold text-gray-900",children:a.value})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:`h-full ${a.color} rounded-full transition-all duration-500`,style:{width:`${d}%`}})})]},c)})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Top Produits"}),t.topProducts.length>0?(0,b.jsx)("div",{className:"space-y-4",children:t.topProducts.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-bold text-white ${0===c?"bg-amber-500":1===c?"bg-gray-400":2===c?"bg-orange-600":"bg-gray-300"}`,children:c+1}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[a.quantity," vendus"]})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)("p",{className:"font-bold text-gray-900",children:H(a.revenue)})})]},c))}):(0,b.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,b.jsx)(h.Package,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),(0,b.jsx)("p",{children:"Aucune vente sur cette période"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Commandes récentes"}),t.recentOrders.length>0?(0,b.jsx)("div",{className:"space-y-3",children:t.recentOrders.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-50 last:border-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-sm font-bold text-gray-600",children:a.customer.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.customer}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.date})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-gray-900",children:H(a.total)}),(0,b.jsx)("span",{className:`inline-block px-2 py-0.5 text-xs font-medium rounded-full ${(a=>{switch(a){case"completed":return"bg-emerald-100 text-emerald-700";case"pending":return"bg-amber-100 text-amber-700";case"cancelled":return"bg-red-100 text-red-700";case"processing":case"shipped":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}})(a.status)}`,children:(a=>{switch(a){case"completed":return"Terminée";case"pending":return"En attente";case"cancelled":return"Annulée";case"processing":return"En cours";case"shipped":return"Expédiée";default:return a}})(a.status)})]})]},c))}):(0,b.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,b.jsx)(f.ShoppingCart,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),(0,b.jsx)("p",{children:"Aucune commande sur cette période"})]})]})]})]})]})}a.s(["default",()=>t],10390)}];

//# sourceMappingURL=app_admin_stats_page_tsx_f6bc1dea._.js.map